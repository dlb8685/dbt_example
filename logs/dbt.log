2020-02-25 22:39:34,730846 (MainThread): Running with dbt=0.15.2
2020-02-25 22:39:34,827764 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
2020-02-25 22:39:34,940231 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-02-25 22:39:34,941330 (MainThread): Tracking: tracking
2020-02-25 22:39:34,953354 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f3d518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f3d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f3d3c8>]}
2020-02-25 22:39:35,184756 (MainThread): Partial parsing not enabled
2020-02-25 22:39:35,186448 (MainThread): Parsing macros/core.sql
2020-02-25 22:39:35,190116 (MainThread): Parsing macros/materializations/helpers.sql
2020-02-25 22:39:35,195362 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-02-25 22:39:35,197395 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-02-25 22:39:35,213164 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-02-25 22:39:35,229749 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-02-25 22:39:35,244233 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-02-25 22:39:35,245962 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-02-25 22:39:35,253473 (MainThread): Parsing macros/materializations/common/merge.sql
2020-02-25 22:39:35,259515 (MainThread): Parsing macros/materializations/table/table.sql
2020-02-25 22:39:35,264489 (MainThread): Parsing macros/materializations/view/view.sql
2020-02-25 22:39:35,269585 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-02-25 22:39:35,273992 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-02-25 22:39:35,274967 (MainThread): Parsing macros/etc/query.sql
2020-02-25 22:39:35,276123 (MainThread): Parsing macros/etc/is_incremental.sql
2020-02-25 22:39:35,277709 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-02-25 22:39:35,279577 (MainThread): Parsing macros/etc/datetime.sql
2020-02-25 22:39:35,286370 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-02-25 22:39:35,288208 (MainThread): Parsing macros/adapters/common.sql
2020-02-25 22:39:35,310636 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-02-25 22:39:35,311806 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-02-25 22:39:35,312751 (MainThread): Parsing macros/schema_tests/unique.sql
2020-02-25 22:39:35,313790 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-02-25 22:39:35,315685 (MainThread): Parsing macros/catalog.sql
2020-02-25 22:39:35,320774 (MainThread): Parsing macros/relations.sql
2020-02-25 22:39:35,321562 (MainThread): Parsing macros/adapters.sql
2020-02-25 22:39:35,331541 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-02-25 22:39:35,332582 (MainThread): Parsing macros/catalog.sql
2020-02-25 22:39:35,333953 (MainThread): Parsing macros/relations.sql
2020-02-25 22:39:35,335164 (MainThread): Parsing macros/adapters.sql
2020-02-25 22:39:35,343320 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-02-25 22:39:35,372121 (MainThread): Partial parsing not enabled
2020-02-25 22:39:35,387242 (MainThread): Acquiring new redshift connection "model.civis_platform.my_first_dbt_model".
2020-02-25 22:39:35,387405 (MainThread): Opening a new connection, currently in state init
2020-02-25 22:39:35,409623 (MainThread): Acquiring new redshift connection "model.civis_platform.my_second_dbt_model".
2020-02-25 22:39:35,409773 (MainThread): Opening a new connection, currently in state init
2020-02-25 22:39:35,437178 (MainThread): Acquiring new redshift connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-02-25 22:39:35,437444 (MainThread): Opening a new connection, currently in state init
2020-02-25 22:39:35,451806 (MainThread): Acquiring new redshift connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-02-25 22:39:35,451970 (MainThread): Opening a new connection, currently in state init
2020-02-25 22:39:35,463323 (MainThread): Acquiring new redshift connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-02-25 22:39:35,463489 (MainThread): Opening a new connection, currently in state init
2020-02-25 22:39:35,471562 (MainThread): Acquiring new redshift connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-02-25 22:39:35,471714 (MainThread): Opening a new connection, currently in state init
2020-02-25 22:39:35,538752 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-02-25 22:39:35,544226 (MainThread): 
2020-02-25 22:39:35,544602 (MainThread): Acquiring new redshift connection "master".
2020-02-25 22:39:35,544690 (MainThread): Opening a new connection, currently in state init
2020-02-25 22:39:35,651986 (MainThread): Using redshift connection "master".
2020-02-25 22:39:35,652248 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-02-25 22:39:35,652370 (MainThread): Connecting to Redshift using 'database' credentials
2020-02-25 22:39:35,652957 (MainThread): Got an error when attempting to open a postgres connection: 'could not connect to server: Connection refused
	Is the server running on host "127.0.0.1" and accepting
	TCP/IP connections on port 5439?
'
2020-02-25 22:39:35,653095 (MainThread): Error running SQL: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-02-25 22:39:35,653236 (MainThread): Rolling back transaction.
2020-02-25 22:39:35,653380 (MainThread): On master: No close available on handle
2020-02-25 22:39:35,653908 (MainThread): Connection 'master' was properly closed.
2020-02-25 22:39:35,654010 (MainThread): ERROR: Database Error
  could not connect to server: Connection refused
  	Is the server running on host "127.0.0.1" and accepting
  	TCP/IP connections on port 5439?
  
2020-02-25 22:39:35,654213 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11389f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11389fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113884978>]}
2020-02-25 22:39:35,781259 (MainThread): Flushing usage events
2020-02-25 23:07:31,75166 (MainThread): Running with dbt=0.15.2
2020-02-25 23:07:31,160187 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
2020-02-25 23:07:31,253480 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-02-25 23:07:31,254587 (MainThread): Tracking: tracking
2020-02-25 23:07:31,261445 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112921908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112921a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112921e80>]}
2020-02-25 23:07:31,484318 (MainThread): Partial parsing not enabled
2020-02-25 23:07:31,486917 (MainThread): Parsing macros/core.sql
2020-02-25 23:07:31,491062 (MainThread): Parsing macros/materializations/helpers.sql
2020-02-25 23:07:31,497735 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-02-25 23:07:31,499547 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-02-25 23:07:31,512257 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-02-25 23:07:31,526619 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-02-25 23:07:31,539927 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-02-25 23:07:31,541815 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-02-25 23:07:31,547222 (MainThread): Parsing macros/materializations/common/merge.sql
2020-02-25 23:07:31,552814 (MainThread): Parsing macros/materializations/table/table.sql
2020-02-25 23:07:31,557776 (MainThread): Parsing macros/materializations/view/view.sql
2020-02-25 23:07:31,562594 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-02-25 23:07:31,566661 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-02-25 23:07:31,567775 (MainThread): Parsing macros/etc/query.sql
2020-02-25 23:07:31,569080 (MainThread): Parsing macros/etc/is_incremental.sql
2020-02-25 23:07:31,570800 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-02-25 23:07:31,572773 (MainThread): Parsing macros/etc/datetime.sql
2020-02-25 23:07:31,579459 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-02-25 23:07:31,581442 (MainThread): Parsing macros/adapters/common.sql
2020-02-25 23:07:31,602717 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-02-25 23:07:31,604014 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-02-25 23:07:31,605167 (MainThread): Parsing macros/schema_tests/unique.sql
2020-02-25 23:07:31,606421 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-02-25 23:07:31,608599 (MainThread): Parsing macros/catalog.sql
2020-02-25 23:07:31,613551 (MainThread): Parsing macros/relations.sql
2020-02-25 23:07:31,614499 (MainThread): Parsing macros/adapters.sql
2020-02-25 23:07:31,623671 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-02-25 23:07:31,624888 (MainThread): Parsing macros/catalog.sql
2020-02-25 23:07:31,626681 (MainThread): Parsing macros/relations.sql
2020-02-25 23:07:31,627998 (MainThread): Parsing macros/adapters.sql
2020-02-25 23:07:31,636231 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-02-25 23:07:31,661171 (MainThread): Partial parsing not enabled
2020-02-25 23:07:31,673459 (MainThread): Acquiring new redshift connection "model.civis_platform.my_first_dbt_model".
2020-02-25 23:07:31,673583 (MainThread): Opening a new connection, currently in state init
2020-02-25 23:07:31,688702 (MainThread): Acquiring new redshift connection "model.civis_platform.my_second_dbt_model".
2020-02-25 23:07:31,688840 (MainThread): Opening a new connection, currently in state init
2020-02-25 23:07:31,712752 (MainThread): Acquiring new redshift connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-02-25 23:07:31,712877 (MainThread): Opening a new connection, currently in state init
2020-02-25 23:07:31,722777 (MainThread): Acquiring new redshift connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-02-25 23:07:31,722896 (MainThread): Opening a new connection, currently in state init
2020-02-25 23:07:31,732146 (MainThread): Acquiring new redshift connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-02-25 23:07:31,732265 (MainThread): Opening a new connection, currently in state init
2020-02-25 23:07:31,738438 (MainThread): Acquiring new redshift connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-02-25 23:07:31,738654 (MainThread): Opening a new connection, currently in state init
2020-02-25 23:07:31,794414 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-02-25 23:07:31,799143 (MainThread): 
2020-02-25 23:07:31,799473 (MainThread): Acquiring new redshift connection "master".
2020-02-25 23:07:31,799561 (MainThread): Opening a new connection, currently in state init
2020-02-25 23:07:31,916754 (MainThread): Using redshift connection "master".
2020-02-25 23:07:31,916893 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-02-25 23:07:31,916977 (MainThread): Connecting to Redshift using 'database' credentials
2020-02-25 23:07:31,917353 (MainThread): Got an error when attempting to open a postgres connection: 'could not connect to server: Connection refused
	Is the server running on host "127.0.0.1" and accepting
	TCP/IP connections on port 5439?
'
2020-02-25 23:07:31,917481 (MainThread): Error running SQL: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-02-25 23:07:31,917555 (MainThread): Rolling back transaction.
2020-02-25 23:07:31,917636 (MainThread): On master: No close available on handle
2020-02-25 23:07:31,918222 (MainThread): Connection 'master' was properly closed.
2020-02-25 23:07:31,918490 (MainThread): ERROR: Database Error
  could not connect to server: Connection refused
  	Is the server running on host "127.0.0.1" and accepting
  	TCP/IP connections on port 5439?
  
2020-02-25 23:07:31,918823 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132ed7b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132eda20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132a5160>]}
2020-02-25 23:07:32,50930 (MainThread): Flushing usage events
2020-02-25 23:15:17,516351 (MainThread): Running with dbt=0.15.2
2020-02-25 23:15:17,589428 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-02-25 23:15:17,589966 (MainThread): Tracking: tracking
2020-02-25 23:15:17,595573 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104623780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046239b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046235f8>]}
2020-02-25 23:15:17,758391 (MainThread): Partial parsing not enabled
2020-02-25 23:15:17,760250 (MainThread): Parsing macros/core.sql
2020-02-25 23:15:17,764515 (MainThread): Parsing macros/materializations/helpers.sql
2020-02-25 23:15:17,771361 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-02-25 23:15:17,772995 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-02-25 23:15:17,787946 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-02-25 23:15:17,802655 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-02-25 23:15:17,818257 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-02-25 23:15:17,821211 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-02-25 23:15:17,829091 (MainThread): Parsing macros/materializations/common/merge.sql
2020-02-25 23:15:17,836133 (MainThread): Parsing macros/materializations/table/table.sql
2020-02-25 23:15:17,842739 (MainThread): Parsing macros/materializations/view/view.sql
2020-02-25 23:15:17,848031 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-02-25 23:15:17,851971 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-02-25 23:15:17,852915 (MainThread): Parsing macros/etc/query.sql
2020-02-25 23:15:17,853965 (MainThread): Parsing macros/etc/is_incremental.sql
2020-02-25 23:15:17,855560 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-02-25 23:15:17,857334 (MainThread): Parsing macros/etc/datetime.sql
2020-02-25 23:15:17,864493 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-02-25 23:15:17,866413 (MainThread): Parsing macros/adapters/common.sql
2020-02-25 23:15:17,887569 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-02-25 23:15:17,888776 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-02-25 23:15:17,889764 (MainThread): Parsing macros/schema_tests/unique.sql
2020-02-25 23:15:17,890804 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-02-25 23:15:17,892703 (MainThread): Parsing macros/catalog.sql
2020-02-25 23:15:17,894064 (MainThread): Parsing macros/relations.sql
2020-02-25 23:15:17,895245 (MainThread): Parsing macros/adapters.sql
2020-02-25 23:15:17,903185 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-02-25 23:15:17,920522 (MainThread): Partial parsing not enabled
2020-02-25 23:15:17,935211 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-02-25 23:15:17,935338 (MainThread): Opening a new connection, currently in state init
2020-02-25 23:15:17,949894 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-02-25 23:15:17,950018 (MainThread): Opening a new connection, currently in state init
2020-02-25 23:15:17,972001 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-02-25 23:15:17,972128 (MainThread): Opening a new connection, currently in state init
2020-02-25 23:15:17,982406 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-02-25 23:15:17,982539 (MainThread): Opening a new connection, currently in state init
2020-02-25 23:15:17,992882 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-02-25 23:15:17,993009 (MainThread): Opening a new connection, currently in state init
2020-02-25 23:15:17,999033 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-02-25 23:15:17,999145 (MainThread): Opening a new connection, currently in state init
2020-02-25 23:15:18,49237 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 0 seed files, 0 sources
2020-02-25 23:15:18,52783 (MainThread): 
2020-02-25 23:15:18,53161 (MainThread): Acquiring new postgres connection "master".
2020-02-25 23:15:18,53252 (MainThread): Opening a new connection, currently in state init
2020-02-25 23:15:18,131042 (MainThread): Using postgres connection "master".
2020-02-25 23:15:18,131180 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-02-25 23:15:18,137803 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-02-25 23:15:18,164387 (MainThread): Using postgres connection "master".
2020-02-25 23:15:18,164513 (MainThread): On master: BEGIN
2020-02-25 23:15:18,164872 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-02-25 23:15:18,164997 (MainThread): Using postgres connection "master".
2020-02-25 23:15:18,165065 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-02-25 23:15:18,170063 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2020-02-25 23:15:18,190491 (MainThread): Using postgres connection "master".
2020-02-25 23:15:18,190611 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-02-25 23:15:18,193844 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2020-02-25 23:15:18,194602 (MainThread): On master: ROLLBACK
2020-02-25 23:15:18,194925 (MainThread): Using postgres connection "master".
2020-02-25 23:15:18,195013 (MainThread): On master: BEGIN
2020-02-25 23:15:18,195410 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-02-25 23:15:18,195533 (MainThread): On master: COMMIT
2020-02-25 23:15:18,195611 (MainThread): Using postgres connection "master".
2020-02-25 23:15:18,195678 (MainThread): On master: COMMIT
2020-02-25 23:15:18,195918 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-02-25 23:15:18,196168 (MainThread): 17:15:18 | Concurrency: 1 threads (target='dev')
2020-02-25 23:15:18,196295 (MainThread): 17:15:18 | 
2020-02-25 23:15:18,199863 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-02-25 23:15:18,200063 (Thread-1): 17:15:18 | 1 of 2 START table model public.my_first_dbt_model................... [RUN]
2020-02-25 23:15:18,200387 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-02-25 23:15:18,200488 (Thread-1): Opening a new connection, currently in state init
2020-02-25 23:15:18,200602 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-02-25 23:15:18,212867 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-02-25 23:15:18,213571 (Thread-1): finished collecting timing info
2020-02-25 23:15:18,230514 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-02-25 23:15:18,230645 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-02-25 23:15:18,236079 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-02-25 23:15:18,238014 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-02-25 23:15:18,238111 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-02-25 23:15:18,238431 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-02-25 23:15:18,253412 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-02-25 23:15:18,254152 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-02-25 23:15:18,254346 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-02-25 23:15:18,255203 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-02-25 23:15:18,255429 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-02-25 23:15:18,255537 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2020-02-25 23:15:18,260174 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-02-25 23:15:18,262214 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-02-25 23:15:18,262310 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-02-25 23:15:18,263044 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-02-25 23:15:18,263865 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-02-25 23:15:18,263955 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-02-25 23:15:18,264024 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-02-25 23:15:18,264766 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-02-25 23:15:18,266265 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-02-25 23:15:18,266370 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-02-25 23:15:18,266674 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-02-25 23:15:18,268797 (Thread-1): finished collecting timing info
2020-02-25 23:15:18,269368 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252169d4-1b9e-4a69-8903-a50d58964ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787d860>]}
2020-02-25 23:15:18,434986 (Thread-1): 17:15:18 | 1 of 2 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.07s]
2020-02-25 23:15:18,435273 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-02-25 23:15:18,435862 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-02-25 23:15:18,436103 (Thread-1): 17:15:18 | 2 of 2 START table model public.my_second_dbt_model.................. [RUN]
2020-02-25 23:15:18,436562 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-02-25 23:15:18,436728 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-02-25 23:15:18,436875 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-02-25 23:15:18,445038 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-02-25 23:15:18,445500 (Thread-1): finished collecting timing info
2020-02-25 23:15:18,452259 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-02-25 23:15:18,452385 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-02-25 23:15:18,452769 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-02-25 23:15:18,454546 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-02-25 23:15:18,454633 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-02-25 23:15:18,454928 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-02-25 23:15:18,456153 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-02-25 23:15:18,456745 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-02-25 23:15:18,456892 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-02-25 23:15:18,457642 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-02-25 23:15:18,457878 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-02-25 23:15:18,458004 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-02-25 23:15:18,459818 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-02-25 23:15:18,462467 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-02-25 23:15:18,462591 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-02-25 23:15:18,463239 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-02-25 23:15:18,464103 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-02-25 23:15:18,464194 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-02-25 23:15:18,464263 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-02-25 23:15:18,464951 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-02-25 23:15:18,466699 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-02-25 23:15:18,466823 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-02-25 23:15:18,467121 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-02-25 23:15:18,469056 (Thread-1): finished collecting timing info
2020-02-25 23:15:18,469568 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252169d4-1b9e-4a69-8903-a50d58964ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048814e0>]}
2020-02-25 23:15:18,659608 (Thread-1): 17:15:18 | 2 of 2 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.03s]
2020-02-25 23:15:18,659924 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-02-25 23:15:18,716399 (MainThread): Using postgres connection "master".
2020-02-25 23:15:18,716723 (MainThread): On master: BEGIN
2020-02-25 23:15:18,717313 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-02-25 23:15:18,717593 (MainThread): On master: COMMIT
2020-02-25 23:15:18,717806 (MainThread): Using postgres connection "master".
2020-02-25 23:15:18,717999 (MainThread): On master: COMMIT
2020-02-25 23:15:18,718582 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-02-25 23:15:18,719212 (MainThread): 17:15:18 | 
2020-02-25 23:15:18,719509 (MainThread): 17:15:18 | Finished running 2 table models in 0.67s.
2020-02-25 23:15:18,719971 (MainThread): Connection 'master' was left open.
2020-02-25 23:15:18,720238 (MainThread): On master: Close
2020-02-25 23:15:18,720539 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-02-25 23:15:18,720910 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-02-25 23:15:18,729698 (MainThread): 
2020-02-25 23:15:18,729944 (MainThread): Completed successfully
2020-02-25 23:15:18,730644 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-02-25 23:15:18,731102 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046fee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f05550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048265f8>]}
2020-02-25 23:15:18,866859 (MainThread): Flushing usage events
2020-02-27 23:00:58,950133 (MainThread): Running with dbt=0.15.2
2020-02-27 23:00:59,70117 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-02-27 23:00:59,71064 (MainThread): Tracking: tracking
2020-02-27 23:00:59,83089 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072017b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f7e940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f7e6d8>]}
2020-02-27 23:00:59,313457 (MainThread): Partial parsing not enabled
2020-02-27 23:00:59,316350 (MainThread): Parsing macros/core.sql
2020-02-27 23:00:59,320719 (MainThread): Parsing macros/materializations/helpers.sql
2020-02-27 23:00:59,326673 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-02-27 23:00:59,328554 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-02-27 23:00:59,341479 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-02-27 23:00:59,356142 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-02-27 23:00:59,370241 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-02-27 23:00:59,372310 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-02-27 23:00:59,377836 (MainThread): Parsing macros/materializations/common/merge.sql
2020-02-27 23:00:59,383728 (MainThread): Parsing macros/materializations/table/table.sql
2020-02-27 23:00:59,389214 (MainThread): Parsing macros/materializations/view/view.sql
2020-02-27 23:00:59,394146 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-02-27 23:00:59,398384 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-02-27 23:00:59,399619 (MainThread): Parsing macros/etc/query.sql
2020-02-27 23:00:59,401015 (MainThread): Parsing macros/etc/is_incremental.sql
2020-02-27 23:00:59,402887 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-02-27 23:00:59,405145 (MainThread): Parsing macros/etc/datetime.sql
2020-02-27 23:00:59,412062 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-02-27 23:00:59,414729 (MainThread): Parsing macros/adapters/common.sql
2020-02-27 23:00:59,438244 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-02-27 23:00:59,439581 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-02-27 23:00:59,440876 (MainThread): Parsing macros/schema_tests/unique.sql
2020-02-27 23:00:59,442309 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-02-27 23:00:59,444719 (MainThread): Parsing macros/catalog.sql
2020-02-27 23:00:59,446599 (MainThread): Parsing macros/relations.sql
2020-02-27 23:00:59,447937 (MainThread): Parsing macros/adapters.sql
2020-02-27 23:00:59,456843 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-02-27 23:00:59,474878 (MainThread): Partial parsing not enabled
2020-02-27 23:00:59,489438 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-02-27 23:00:59,489564 (MainThread): Opening a new connection, currently in state init
2020-02-27 23:00:59,506500 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-02-27 23:00:59,506642 (MainThread): Opening a new connection, currently in state init
2020-02-27 23:00:59,531095 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-02-27 23:00:59,531228 (MainThread): Opening a new connection, currently in state init
2020-02-27 23:00:59,541130 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-02-27 23:00:59,541248 (MainThread): Opening a new connection, currently in state init
2020-02-27 23:00:59,550279 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-02-27 23:00:59,550396 (MainThread): Opening a new connection, currently in state init
2020-02-27 23:00:59,556622 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-02-27 23:00:59,556767 (MainThread): Opening a new connection, currently in state init
2020-02-27 23:00:59,605953 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 0 seed files, 0 sources
2020-02-27 23:00:59,610186 (MainThread): 
2020-02-27 23:00:59,610412 (MainThread): 17:00:59 | Concurrency: 1 threads (target='dev')
2020-02-27 23:00:59,610532 (MainThread): 17:00:59 | 
2020-02-27 23:00:59,612598 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-02-27 23:00:59,612931 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-02-27 23:00:59,613018 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:00:59,613104 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-02-27 23:00:59,626169 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-02-27 23:00:59,627153 (Thread-1): finished collecting timing info
2020-02-27 23:00:59,627881 (Thread-1): finished collecting timing info
2020-02-27 23:00:59,628634 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-02-27 23:00:59,629086 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-02-27 23:00:59,629410 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-02-27 23:00:59,629503 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:00:59,629580 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-02-27 23:00:59,635809 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-02-27 23:00:59,636375 (Thread-1): finished collecting timing info
2020-02-27 23:00:59,636660 (Thread-1): finished collecting timing info
2020-02-27 23:00:59,636995 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-02-27 23:00:59,637124 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-02-27 23:00:59,637478 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-02-27 23:00:59,637900 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:00:59,638024 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-02-27 23:00:59,652811 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-02-27 23:00:59,653356 (Thread-1): finished collecting timing info
2020-02-27 23:00:59,654127 (Thread-1): finished collecting timing info
2020-02-27 23:00:59,654915 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-02-27 23:00:59,655138 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-02-27 23:00:59,655509 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-02-27 23:00:59,655612 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:00:59,655696 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-02-27 23:00:59,662864 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-02-27 23:00:59,663379 (Thread-1): finished collecting timing info
2020-02-27 23:00:59,664216 (Thread-1): finished collecting timing info
2020-02-27 23:00:59,664990 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-02-27 23:00:59,665149 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-02-27 23:00:59,665576 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-02-27 23:00:59,665697 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:00:59,665805 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-02-27 23:00:59,672747 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-02-27 23:00:59,673390 (Thread-1): finished collecting timing info
2020-02-27 23:00:59,674401 (Thread-1): finished collecting timing info
2020-02-27 23:00:59,675062 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-02-27 23:00:59,675225 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-02-27 23:00:59,675600 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-02-27 23:00:59,675760 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:00:59,675860 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-02-27 23:00:59,683403 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-02-27 23:00:59,683876 (Thread-1): finished collecting timing info
2020-02-27 23:00:59,684710 (Thread-1): finished collecting timing info
2020-02-27 23:00:59,685476 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-02-27 23:00:59,717462 (MainThread): Connection 'test.civis_platform.not_null_my_second_dbt_model_id' was properly closed.
2020-02-27 23:00:59,717816 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was properly closed.
2020-02-27 23:00:59,735947 (MainThread): 17:00:59 | Done.
2020-02-27 23:00:59,736202 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040778d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104077c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040b2da0>]}
2020-02-27 23:00:59,862349 (MainThread): Flushing usage events
2020-02-27 23:05:57,475021 (MainThread): Running with dbt=0.15.2
2020-02-27 23:05:57,556490 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=None, port=8580, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2020-02-27 23:05:57,567320 (MainThread): Tracking: tracking
2020-02-27 23:05:57,578947 (Thread-1): Partial parsing not enabled
2020-02-27 23:05:57,583799 (Thread-1): Parsing macros/core.sql
2020-02-27 23:05:57,589671 (Thread-1): Parsing macros/materializations/helpers.sql
2020-02-27 23:05:57,589937 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1aecf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f16b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1db1d0>]}
2020-02-27 23:05:57,597841 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-02-27 23:05:57,601117 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2020-02-27 23:05:57,621517 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2020-02-27 23:05:57,641150 (Thread-1): Parsing macros/materializations/seed/seed.sql
2020-02-27 23:05:57,655569 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2020-02-27 23:05:57,657942 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2020-02-27 23:05:57,663913 (Thread-1): Parsing macros/materializations/common/merge.sql
2020-02-27 23:05:57,669960 (Thread-1): Parsing macros/materializations/table/table.sql
2020-02-27 23:05:57,675292 (Thread-1): Parsing macros/materializations/view/view.sql
2020-02-27 23:05:57,680245 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2020-02-27 23:05:57,684201 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2020-02-27 23:05:57,685252 (Thread-1): Parsing macros/etc/query.sql
2020-02-27 23:05:57,686369 (Thread-1): Parsing macros/etc/is_incremental.sql
2020-02-27 23:05:57,687933 (Thread-1): Parsing macros/etc/get_relation_comment.sql
2020-02-27 23:05:57,689916 (Thread-1): Parsing macros/etc/datetime.sql
2020-02-27 23:05:57,696913 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2020-02-27 23:05:57,699220 (Thread-1): Parsing macros/adapters/common.sql
2020-02-27 23:05:57,721948 (Thread-1): Parsing macros/schema_tests/relationships.sql
2020-02-27 23:05:57,723749 (Thread-1): Parsing macros/schema_tests/not_null.sql
2020-02-27 23:05:57,724808 (Thread-1): Parsing macros/schema_tests/unique.sql
2020-02-27 23:05:57,725932 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2020-02-27 23:05:57,728129 (Thread-1): Parsing macros/catalog.sql
2020-02-27 23:05:57,729593 (Thread-1): Parsing macros/relations.sql
2020-02-27 23:05:57,730844 (Thread-1): Parsing macros/adapters.sql
2020-02-27 23:05:57,739122 (Thread-1): Parsing macros/materializations/snapshot_merge.sql
2020-02-27 23:05:57,757872 (Thread-1): Partial parsing not enabled
2020-02-27 23:05:57,771834 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-02-27 23:05:57,771991 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:05:57,788771 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-02-27 23:05:57,788919 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:05:57,812358 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-02-27 23:05:57,812607 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:05:57,822666 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-02-27 23:05:57,822909 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:05:57,832042 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-02-27 23:05:57,832178 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:05:57,838460 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-02-27 23:05:57,838590 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:05:57,881673 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=29009
2020-02-27 23:05:57,882295 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2020-02-27 23:05:57,882813 (MainThread): Send requests to http://localhost:8580/jsonrpc
2020-02-27 23:07:17,554998 (Thread-6): sending response (<Response 83 bytes [200 OK]>) to 127.0.0.1
2020-02-27 23:09:11,300449 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1aecf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1915f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f191518>]}
2020-02-27 23:09:11,519783 (MainThread): Flushing usage events
2020-02-27 23:09:11,520071 (MainThread): Connection 'test.civis_platform.not_null_my_second_dbt_model_id' was properly closed.
2020-02-27 23:12:09,989321 (MainThread): Running with dbt=0.15.2
2020-02-27 23:12:10,127313 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-02-27 23:12:10,128007 (MainThread): Tracking: tracking
2020-02-27 23:12:10,138116 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2e5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab6e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2e5be0>]}
2020-02-27 23:12:10,390337 (MainThread): Partial parsing not enabled
2020-02-27 23:12:10,393952 (MainThread): Parsing macros/core.sql
2020-02-27 23:12:10,397477 (MainThread): Parsing macros/materializations/helpers.sql
2020-02-27 23:12:10,404386 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-02-27 23:12:10,406241 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-02-27 23:12:10,427781 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-02-27 23:12:10,445961 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-02-27 23:12:10,466176 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-02-27 23:12:10,468697 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-02-27 23:12:10,475087 (MainThread): Parsing macros/materializations/common/merge.sql
2020-02-27 23:12:10,481282 (MainThread): Parsing macros/materializations/table/table.sql
2020-02-27 23:12:10,487511 (MainThread): Parsing macros/materializations/view/view.sql
2020-02-27 23:12:10,494599 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-02-27 23:12:10,501292 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-02-27 23:12:10,502709 (MainThread): Parsing macros/etc/query.sql
2020-02-27 23:12:10,504321 (MainThread): Parsing macros/etc/is_incremental.sql
2020-02-27 23:12:10,506372 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-02-27 23:12:10,509136 (MainThread): Parsing macros/etc/datetime.sql
2020-02-27 23:12:10,516122 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-02-27 23:12:10,518590 (MainThread): Parsing macros/adapters/common.sql
2020-02-27 23:12:10,547630 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-02-27 23:12:10,548927 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-02-27 23:12:10,550015 (MainThread): Parsing macros/schema_tests/unique.sql
2020-02-27 23:12:10,551074 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-02-27 23:12:10,553672 (MainThread): Parsing macros/catalog.sql
2020-02-27 23:12:10,555677 (MainThread): Parsing macros/relations.sql
2020-02-27 23:12:10,556990 (MainThread): Parsing macros/adapters.sql
2020-02-27 23:12:10,568630 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-02-27 23:12:10,589937 (MainThread): Partial parsing not enabled
2020-02-27 23:12:10,608941 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-02-27 23:12:10,609078 (MainThread): Opening a new connection, currently in state init
2020-02-27 23:12:10,626155 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-02-27 23:12:10,626291 (MainThread): Opening a new connection, currently in state init
2020-02-27 23:12:10,657393 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-02-27 23:12:10,657566 (MainThread): Opening a new connection, currently in state init
2020-02-27 23:12:10,670305 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-02-27 23:12:10,670453 (MainThread): Opening a new connection, currently in state init
2020-02-27 23:12:10,683554 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-02-27 23:12:10,683873 (MainThread): Opening a new connection, currently in state init
2020-02-27 23:12:10,691261 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-02-27 23:12:10,691407 (MainThread): Opening a new connection, currently in state init
2020-02-27 23:12:10,761186 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 0 seed files, 0 sources
2020-02-27 23:12:10,766799 (MainThread): 
2020-02-27 23:12:10,767019 (MainThread): 17:12:10 | Concurrency: 1 threads (target='dev')
2020-02-27 23:12:10,767165 (MainThread): 17:12:10 | 
2020-02-27 23:12:10,768928 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-02-27 23:12:10,769440 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-02-27 23:12:10,769583 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:12:10,769706 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-02-27 23:12:10,784030 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-02-27 23:12:10,785522 (Thread-1): finished collecting timing info
2020-02-27 23:12:10,786132 (Thread-1): finished collecting timing info
2020-02-27 23:12:10,786851 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-02-27 23:12:10,787475 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-02-27 23:12:10,787902 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-02-27 23:12:10,788037 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:12:10,788150 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-02-27 23:12:10,799127 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-02-27 23:12:10,799920 (Thread-1): finished collecting timing info
2020-02-27 23:12:10,800538 (Thread-1): finished collecting timing info
2020-02-27 23:12:10,801158 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-02-27 23:12:10,801415 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-02-27 23:12:10,801967 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-02-27 23:12:10,802258 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:12:10,802417 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-02-27 23:12:10,820129 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-02-27 23:12:10,820840 (Thread-1): finished collecting timing info
2020-02-27 23:12:10,821298 (Thread-1): finished collecting timing info
2020-02-27 23:12:10,821859 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-02-27 23:12:10,822117 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-02-27 23:12:10,822519 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-02-27 23:12:10,822632 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:12:10,822717 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-02-27 23:12:10,831733 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-02-27 23:12:10,832394 (Thread-1): finished collecting timing info
2020-02-27 23:12:10,832929 (Thread-1): finished collecting timing info
2020-02-27 23:12:10,833557 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-02-27 23:12:10,833837 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-02-27 23:12:10,834368 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-02-27 23:12:10,834517 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:12:10,834643 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-02-27 23:12:10,844811 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-02-27 23:12:10,845481 (Thread-1): finished collecting timing info
2020-02-27 23:12:10,846014 (Thread-1): finished collecting timing info
2020-02-27 23:12:10,846628 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-02-27 23:12:10,846877 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-02-27 23:12:10,847405 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-02-27 23:12:10,847571 (Thread-1): Opening a new connection, currently in state init
2020-02-27 23:12:10,847699 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-02-27 23:12:10,857339 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-02-27 23:12:10,857991 (Thread-1): finished collecting timing info
2020-02-27 23:12:10,858370 (Thread-1): finished collecting timing info
2020-02-27 23:12:10,859106 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-02-27 23:12:10,870465 (MainThread): Connection 'test.civis_platform.not_null_my_second_dbt_model_id' was properly closed.
2020-02-27 23:12:10,870621 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was properly closed.
2020-02-27 23:12:10,889904 (MainThread): 17:12:10 | Done.
2020-02-27 23:12:10,898323 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-02-27 23:12:10,898587 (MainThread): Opening a new connection, currently in state init
2020-02-27 23:12:10,898782 (MainThread): 17:12:10 | Building catalog
2020-02-27 23:12:11,18215 (MainThread): Using postgres connection "generate_catalog".
2020-02-27 23:12:11,18362 (MainThread): On generate_catalog: BEGIN
2020-02-27 23:12:11,41162 (MainThread): SQL status: BEGIN in 0.02 seconds
2020-02-27 23:12:11,41327 (MainThread): Using postgres connection "generate_catalog".
2020-02-27 23:12:11,41497 (MainThread): On generate_catalog: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "generate_catalog"} */

    
    

    select
        'dbryan' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where sch.nspname != 'information_schema'
      and sch.nspname not like 'pg\_%' -- avoid postgres system schemas, '_' is a wildcard so escape it
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-02-27 23:12:11,95073 (MainThread): SQL status: SELECT 2 in 0.05 seconds
2020-02-27 23:12:11,110021 (MainThread): On generate_catalog: ROLLBACK
2020-02-27 23:12:11,159357 (MainThread): 17:12:11 | Catalog written to /Users/dbryan/civisanalytics/dbt_example/target/catalog.json
2020-02-27 23:12:11,159818 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4ef4a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e490fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4f2518>]}
2020-02-27 23:12:11,326648 (MainThread): Flushing usage events
2020-02-27 23:12:11,326898 (MainThread): Connection 'generate_catalog' was left open.
2020-02-27 23:12:11,327027 (MainThread): On generate_catalog: Close
2020-02-27 23:12:23,882024 (MainThread): Running with dbt=0.15.2
2020-02-27 23:12:23,903720 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8080, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-02-27 23:12:23,904160 (MainThread): Tracking: tracking
2020-02-27 23:12:23,911227 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109981940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10777fac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10998eb38>]}
2020-02-27 23:12:24,102301 (MainThread): Serving docs at 0.0.0.0:8080
2020-02-27 23:12:24,102734 (MainThread): To access from your browser, navigate to http://localhost:8080.
2020-02-27 23:12:24,102928 (MainThread): Press Ctrl+C to exit.


2020-03-02 17:29:53,143680 (MainThread): Flushing usage events
2020-03-02 17:29:53,181492 (MainThread): ctrl-c
2020-03-02 22:41:33,152242 (MainThread): Running with dbt=0.15.2
2020-03-02 22:41:33,632611 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-02 22:41:33,635674 (MainThread): Tracking: tracking
2020-03-02 22:41:33,662727 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b41668>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b41898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b417b8>]}
2020-03-02 22:41:34,222470 (MainThread): Partial parsing not enabled
2020-03-02 22:41:34,225545 (MainThread): Parsing macros/core.sql
2020-03-02 22:41:34,230644 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-02 22:41:34,239944 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-02 22:41:34,241956 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-02 22:41:34,257403 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-02 22:41:34,274324 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-02 22:41:34,291072 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-02 22:41:34,293384 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-02 22:41:34,300157 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-02 22:41:34,307310 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-02 22:41:34,312962 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-02 22:41:34,319379 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-02 22:41:34,324415 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-02 22:41:34,325627 (MainThread): Parsing macros/etc/query.sql
2020-03-02 22:41:34,327072 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-02 22:41:34,328900 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-02 22:41:34,331018 (MainThread): Parsing macros/etc/datetime.sql
2020-03-02 22:41:34,339039 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-02 22:41:34,342249 (MainThread): Parsing macros/adapters/common.sql
2020-03-02 22:41:34,369057 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-02 22:41:34,370504 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-02 22:41:34,371658 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-02 22:41:34,372990 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-02 22:41:34,375411 (MainThread): Parsing macros/catalog.sql
2020-03-02 22:41:34,377052 (MainThread): Parsing macros/relations.sql
2020-03-02 22:41:34,378440 (MainThread): Parsing macros/adapters.sql
2020-03-02 22:41:34,490444 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-02 22:41:34,593175 (MainThread): Partial parsing not enabled
2020-03-02 22:41:34,613666 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-02 22:41:34,613804 (MainThread): Opening a new connection, currently in state init
2020-03-02 22:41:34,629359 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-02 22:41:34,629493 (MainThread): Opening a new connection, currently in state init
2020-03-02 22:41:34,658513 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-02 22:41:34,658643 (MainThread): Opening a new connection, currently in state init
2020-03-02 22:41:34,668345 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-02 22:41:34,668484 (MainThread): Opening a new connection, currently in state init
2020-03-02 22:41:34,677413 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-02 22:41:34,677534 (MainThread): Opening a new connection, currently in state init
2020-03-02 22:41:34,683495 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-02 22:41:34,683607 (MainThread): Opening a new connection, currently in state init
2020-03-02 22:41:34,736831 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 0 seed files, 0 sources
2020-03-02 22:41:34,739581 (MainThread): 
2020-03-02 22:41:34,739936 (MainThread): Acquiring new postgres connection "master".
2020-03-02 22:41:34,740026 (MainThread): Opening a new connection, currently in state init
2020-03-02 22:41:34,823025 (MainThread): Using postgres connection "master".
2020-03-02 22:41:34,823164 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-02 22:41:34,867006 (MainThread): SQL status: SELECT 6 in 0.04 seconds
2020-03-02 22:41:34,897218 (MainThread): Using postgres connection "master".
2020-03-02 22:41:34,897447 (MainThread): On master: BEGIN
2020-03-02 22:41:34,899273 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-02 22:41:34,899387 (MainThread): Using postgres connection "master".
2020-03-02 22:41:34,899475 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-02 22:41:34,914897 (MainThread): SQL status: SELECT 2 in 0.02 seconds
2020-03-02 22:41:34,939678 (MainThread): Using postgres connection "master".
2020-03-02 22:41:34,939800 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-02 22:41:34,961712 (MainThread): SQL status: SELECT 0 in 0.02 seconds
2020-03-02 22:41:34,963942 (MainThread): On master: ROLLBACK
2020-03-02 22:41:34,965379 (MainThread): Using postgres connection "master".
2020-03-02 22:41:34,965507 (MainThread): On master: BEGIN
2020-03-02 22:41:34,965847 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-02 22:41:34,965947 (MainThread): On master: COMMIT
2020-03-02 22:41:34,966075 (MainThread): Using postgres connection "master".
2020-03-02 22:41:34,966151 (MainThread): On master: COMMIT
2020-03-02 22:41:34,966309 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-02 22:41:34,966576 (MainThread): 16:41:34 | Concurrency: 1 threads (target='dev')
2020-03-02 22:41:34,966700 (MainThread): 16:41:34 | 
2020-03-02 22:41:34,968636 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-02 22:41:34,968879 (Thread-1): 16:41:34 | 1 of 2 START table model public.my_first_dbt_model................... [RUN]
2020-03-02 22:41:34,969220 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-02 22:41:34,969310 (Thread-1): Opening a new connection, currently in state init
2020-03-02 22:41:34,969398 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-02 22:41:34,983909 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-02 22:41:34,985552 (Thread-1): finished collecting timing info
2020-03-02 22:41:35,6501 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-02 22:41:35,6644 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-02 22:41:35,17002 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-03-02 22:41:35,19155 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-02 22:41:35,19253 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-02 22:41:35,19628 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-02 22:41:35,33359 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-02 22:41:35,34555 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-02 22:41:35,34731 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-02 22:41:35,35109 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-02 22:41:35,35239 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-02 22:41:35,35363 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2020-03-02 22:41:35,49767 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2020-03-02 22:41:35,53802 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-02 22:41:35,53931 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-02 22:41:35,54995 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-02 22:41:35,57223 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-02 22:41:35,57342 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-02 22:41:35,58311 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-02 22:41:35,59339 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-02 22:41:35,59486 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-02 22:41:35,59590 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-02 22:41:35,60535 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-02 22:41:35,63941 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-02 22:41:35,64107 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-02 22:41:35,74309 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-03-02 22:41:35,76869 (Thread-1): finished collecting timing info
2020-03-02 22:41:35,77509 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '442a7ba9-4483-407b-a9ef-565bafe3f30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3a0358>]}
2020-03-02 22:41:35,203336 (Thread-1): 16:41:35 | 1 of 2 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.11s]
2020-03-02 22:41:35,203540 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-02 22:41:35,203959 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-02 22:41:35,204128 (Thread-1): 16:41:35 | 2 of 2 START table model public.my_second_dbt_model.................. [RUN]
2020-03-02 22:41:35,204508 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-02 22:41:35,204609 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-02 22:41:35,204698 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-02 22:41:35,212132 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-02 22:41:35,212698 (Thread-1): finished collecting timing info
2020-03-02 22:41:35,222182 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-02 22:41:35,222327 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-02 22:41:35,222709 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-02 22:41:35,224967 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-02 22:41:35,225085 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-02 22:41:35,225444 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-02 22:41:35,227235 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-02 22:41:35,228173 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-02 22:41:35,228366 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-02 22:41:35,228675 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-02 22:41:35,228919 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-02 22:41:35,229116 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-02 22:41:35,231992 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-02 22:41:35,235696 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-02 22:41:35,235837 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-02 22:41:35,236300 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-02 22:41:35,239747 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-02 22:41:35,239911 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-02 22:41:35,240598 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-02 22:41:35,241604 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-02 22:41:35,241718 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-02 22:41:35,241792 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-02 22:41:35,242198 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-02 22:41:35,243997 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-02 22:41:35,244107 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-02 22:41:35,245725 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-02 22:41:35,248795 (Thread-1): finished collecting timing info
2020-03-02 22:41:35,249658 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '442a7ba9-4483-407b-a9ef-565bafe3f30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3b38d0>]}
2020-03-02 22:41:35,373261 (Thread-1): 16:41:35 | 2 of 2 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.05s]
2020-03-02 22:41:35,373457 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-02 22:41:35,378536 (MainThread): Using postgres connection "master".
2020-03-02 22:41:35,378672 (MainThread): On master: BEGIN
2020-03-02 22:41:35,378922 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-02 22:41:35,379043 (MainThread): On master: COMMIT
2020-03-02 22:41:35,379123 (MainThread): Using postgres connection "master".
2020-03-02 22:41:35,379191 (MainThread): On master: COMMIT
2020-03-02 22:41:35,379443 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-02 22:41:35,379701 (MainThread): 16:41:35 | 
2020-03-02 22:41:35,379811 (MainThread): 16:41:35 | Finished running 2 table models in 0.64s.
2020-03-02 22:41:35,379937 (MainThread): Connection 'master' was left open.
2020-03-02 22:41:35,380049 (MainThread): On master: Close
2020-03-02 22:41:35,380171 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-02 22:41:35,380270 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-02 22:41:35,386747 (MainThread): 
2020-03-02 22:41:35,386927 (MainThread): Completed successfully
2020-03-02 22:41:35,387478 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-03-02 22:41:35,387739 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d09eb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c77e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c77e48>]}
2020-03-02 22:41:35,506592 (MainThread): Flushing usage events
2020-03-02 22:55:56,406215 (MainThread): Running with dbt=0.15.2
2020-03-02 22:55:56,509223 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', show=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2020-03-02 22:55:56,510174 (MainThread): Tracking: tracking
2020-03-02 22:55:56,519445 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100542400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100542898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100542780>]}
2020-03-02 22:55:56,753923 (MainThread): Partial parsing not enabled
2020-03-02 22:55:56,757022 (MainThread): Parsing macros/core.sql
2020-03-02 22:55:56,761450 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-02 22:55:56,767769 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-02 22:55:56,770346 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-02 22:55:56,787944 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-02 22:55:56,802858 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-02 22:55:56,817042 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-02 22:55:56,820185 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-02 22:55:56,828862 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-02 22:55:56,836155 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-02 22:55:56,842345 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-02 22:55:56,847458 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-02 22:55:56,851729 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-02 22:55:56,852956 (MainThread): Parsing macros/etc/query.sql
2020-03-02 22:55:56,854262 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-02 22:55:56,856065 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-02 22:55:56,858299 (MainThread): Parsing macros/etc/datetime.sql
2020-03-02 22:55:56,867568 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-02 22:55:56,876441 (MainThread): Parsing macros/adapters/common.sql
2020-03-02 22:55:56,905202 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-02 22:55:56,906621 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-02 22:55:56,908145 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-02 22:55:56,909425 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-02 22:55:56,911734 (MainThread): Parsing macros/catalog.sql
2020-03-02 22:55:56,913383 (MainThread): Parsing macros/relations.sql
2020-03-02 22:55:56,914814 (MainThread): Parsing macros/adapters.sql
2020-03-02 22:55:56,927255 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-02 22:55:56,949023 (MainThread): Partial parsing not enabled
2020-03-02 22:55:56,963910 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-02 22:55:56,964058 (MainThread): Opening a new connection, currently in state init
2020-03-02 22:55:56,983119 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-02 22:55:56,983271 (MainThread): Opening a new connection, currently in state init
2020-03-02 22:55:57,30964 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-02 22:55:57,31137 (MainThread): Opening a new connection, currently in state init
2020-03-02 22:55:57,41326 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-02 22:55:57,41458 (MainThread): Opening a new connection, currently in state init
2020-03-02 22:55:57,50518 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-02 22:55:57,50670 (MainThread): Opening a new connection, currently in state init
2020-03-02 22:55:57,57208 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-02 22:55:57,57336 (MainThread): Opening a new connection, currently in state init
2020-03-02 22:55:57,110227 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-02 22:55:57,114451 (MainThread): 
2020-03-02 22:55:57,114816 (MainThread): Acquiring new postgres connection "master".
2020-03-02 22:55:57,114927 (MainThread): Opening a new connection, currently in state init
2020-03-02 22:55:57,197487 (MainThread): Using postgres connection "master".
2020-03-02 22:55:57,197641 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-02 22:55:57,204758 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-02 22:55:57,239992 (MainThread): Using postgres connection "master".
2020-03-02 22:55:57,240130 (MainThread): On master: BEGIN
2020-03-02 22:55:57,241168 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-02 22:55:57,241354 (MainThread): Using postgres connection "master".
2020-03-02 22:55:57,241478 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-02 22:55:57,246209 (MainThread): SQL status: SELECT 2 in 0.00 seconds
2020-03-02 22:55:57,274132 (MainThread): Using postgres connection "master".
2020-03-02 22:55:57,274262 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-02 22:55:57,279636 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-03-02 22:55:57,280786 (MainThread): On master: ROLLBACK
2020-03-02 22:55:57,281035 (MainThread): Using postgres connection "master".
2020-03-02 22:55:57,281127 (MainThread): On master: BEGIN
2020-03-02 22:55:57,281421 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-02 22:55:57,281534 (MainThread): On master: COMMIT
2020-03-02 22:55:57,281623 (MainThread): Using postgres connection "master".
2020-03-02 22:55:57,281698 (MainThread): On master: COMMIT
2020-03-02 22:55:57,281857 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-02 22:55:57,282111 (MainThread): 16:55:57 | Concurrency: 1 threads (target='dev')
2020-03-02 22:55:57,282243 (MainThread): 16:55:57 | 
2020-03-02 22:55:57,284404 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-02 22:55:57,284588 (Thread-1): 16:55:57 | 1 of 2 START seed file public.ad_account_metrics..................... [RUN]
2020-03-02 22:55:57,284886 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-02 22:55:57,284975 (Thread-1): Opening a new connection, currently in state init
2020-03-02 22:55:57,285077 (Thread-1): finished collecting timing info
2020-03-02 22:55:57,337793 (Thread-1): * Deprecation Warning: 
    The quote_columns parameter was not set for seeds, so the default value of
    False was chosen. The default will change to True in a future release.

    For more information, see:
    https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
    

2020-03-02 22:55:57,338432 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-02 22:55:57,338537 (Thread-1): On seed.civis_platform.ad_account_metrics: BEGIN
2020-03-02 22:55:57,344423 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-03-02 22:55:57,344565 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-02 22:55:57,344643 (Thread-1): On seed.civis_platform.ad_account_metrics: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "seed.civis_platform.ad_account_metrics"} */

    create table "dbryan"."public"."ad_account_metrics" (date date,impressions integer,clicks integer,spend float8)
  
2020-03-02 22:55:57,353298 (Thread-1): SQL status: CREATE TABLE in 0.01 seconds
2020-03-02 22:55:57,355010 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-02 22:55:57,355173 (Thread-1): On seed.civis_platform.ad_account_metrics: 
            insert into "dbryan"."public"."ad_account_metrics" (date, impressions, clicks, spend) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
        ...
2020-03-02 22:55:57,365210 (Thread-1): SQL status: INSERT 0 7 in 0.01 seconds
2020-03-02 22:55:57,365613 (Thread-1): Writing runtime SQL for node "seed.civis_platform.ad_account_metrics"
2020-03-02 22:55:57,367913 (Thread-1): On seed.civis_platform.ad_account_metrics: COMMIT
2020-03-02 22:55:57,368093 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-02 22:55:57,368202 (Thread-1): On seed.civis_platform.ad_account_metrics: COMMIT
2020-03-02 22:55:57,368890 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-02 22:55:57,373719 (Thread-1): finished collecting timing info
2020-03-02 22:55:57,374335 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8da72abd-b4a4-4670-8990-1961e2fbae53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10076ccc0>]}
2020-03-02 22:55:57,503010 (Thread-1): 16:55:57 | 1 of 2 OK loaded seed file public.ad_account_metrics................. [INSERT 7 in 0.09s]
2020-03-02 22:55:57,503313 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-02 22:55:57,503643 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-02 22:55:57,503997 (Thread-1): 16:55:57 | 2 of 2 START seed file public.dim_date............................... [RUN]
2020-03-02 22:55:57,504588 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-02 22:55:57,504754 (Thread-1): Re-using an available connection from the pool (formerly seed.civis_platform.ad_account_metrics).
2020-03-02 22:55:57,504918 (Thread-1): finished collecting timing info
2020-03-02 22:55:57,514083 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-02 22:55:57,514246 (Thread-1): On seed.civis_platform.dim_date: BEGIN
2020-03-02 22:55:57,514802 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-02 22:55:57,514969 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-02 22:55:57,515059 (Thread-1): On seed.civis_platform.dim_date: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "seed.civis_platform.dim_date"} */

    create table "dbryan"."public"."dim_date" (date_id integer,date date,dow date,business_day boolean)
  
2020-03-02 22:55:57,518233 (Thread-1): SQL status: CREATE TABLE in 0.00 seconds
2020-03-02 22:55:57,520323 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-02 22:55:57,520444 (Thread-1): On seed.civis_platform.dim_date: 
            insert into "dbryan"."public"."dim_date" (date_id, date, dow, business_day) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
        ...
2020-03-02 22:55:57,521218 (Thread-1): SQL status: INSERT 0 7 in 0.00 seconds
2020-03-02 22:55:57,521481 (Thread-1): Writing runtime SQL for node "seed.civis_platform.dim_date"
2020-03-02 22:55:57,523435 (Thread-1): On seed.civis_platform.dim_date: COMMIT
2020-03-02 22:55:57,523573 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-02 22:55:57,523651 (Thread-1): On seed.civis_platform.dim_date: COMMIT
2020-03-02 22:55:57,524092 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-02 22:55:57,528051 (Thread-1): finished collecting timing info
2020-03-02 22:55:57,529131 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8da72abd-b4a4-4670-8990-1961e2fbae53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e0a3c8>]}
2020-03-02 22:55:57,656857 (Thread-1): 16:55:57 | 2 of 2 OK loaded seed file public.dim_date........................... [INSERT 7 in 0.02s]
2020-03-02 22:55:57,657248 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-02 22:55:57,699856 (MainThread): Using postgres connection "master".
2020-03-02 22:55:57,700030 (MainThread): On master: BEGIN
2020-03-02 22:55:57,700355 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-02 22:55:57,700499 (MainThread): On master: COMMIT
2020-03-02 22:55:57,700604 (MainThread): Using postgres connection "master".
2020-03-02 22:55:57,700697 (MainThread): On master: COMMIT
2020-03-02 22:55:57,700901 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-02 22:55:57,701189 (MainThread): 16:55:57 | 
2020-03-02 22:55:57,701327 (MainThread): 16:55:57 | Finished running 2 seeds in 0.59s.
2020-03-02 22:55:57,701454 (MainThread): Connection 'master' was left open.
2020-03-02 22:55:57,701561 (MainThread): On master: Close
2020-03-02 22:55:57,701716 (MainThread): Connection 'seed.civis_platform.dim_date' was left open.
2020-03-02 22:55:57,701821 (MainThread): On seed.civis_platform.dim_date: Close
2020-03-02 22:55:57,708021 (MainThread): 
2020-03-02 22:55:57,708268 (MainThread): Completed successfully
2020-03-02 22:55:57,708590 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-03-02 22:55:57,708922 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1007f83c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1007f8da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1007f8828>]}
2020-03-02 22:55:57,837390 (MainThread): Flushing usage events
2020-03-03 17:13:46,453925 (MainThread): Running with dbt=0.15.2
2020-03-03 17:13:46,569551 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 17:13:46,570352 (MainThread): Tracking: tracking
2020-03-03 17:13:46,580944 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3f5c0>]}
2020-03-03 17:13:46,792791 (MainThread): Partial parsing not enabled
2020-03-03 17:13:46,795532 (MainThread): Parsing macros/core.sql
2020-03-03 17:13:46,799915 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 17:13:46,805555 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 17:13:46,807341 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 17:13:46,820835 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 17:13:46,835977 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 17:13:46,851765 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 17:13:46,854196 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 17:13:46,865645 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 17:13:46,873429 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 17:13:46,882314 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 17:13:46,890829 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 17:13:46,897178 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 17:13:46,898757 (MainThread): Parsing macros/etc/query.sql
2020-03-03 17:13:46,900787 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 17:13:46,903043 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 17:13:46,905843 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 17:13:46,916555 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 17:13:46,922447 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 17:13:46,953487 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 17:13:46,955294 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 17:13:46,959002 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 17:13:46,961647 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 17:13:46,965017 (MainThread): Parsing macros/catalog.sql
2020-03-03 17:13:46,966815 (MainThread): Parsing macros/relations.sql
2020-03-03 17:13:46,968521 (MainThread): Parsing macros/adapters.sql
2020-03-03 17:13:46,977602 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 17:13:46,996712 (MainThread): Partial parsing not enabled
2020-03-03 17:13:47,10636 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:13:47,10784 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:13:47,27307 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:13:47,27435 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:13:47,32579 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:13:47,32696 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:13:47,67481 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 17:13:47,67685 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:13:47,77588 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 17:13:47,77719 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:13:47,87061 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 17:13:47,87190 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:13:47,93956 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 17:13:47,94084 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:13:47,151290 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 17:13:47,155879 (MainThread): 
2020-03-03 17:13:47,156313 (MainThread): Acquiring new postgres connection "master".
2020-03-03 17:13:47,156417 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:13:47,238465 (MainThread): Using postgres connection "master".
2020-03-03 17:13:47,238622 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 17:13:47,247843 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 17:13:47,282912 (MainThread): Using postgres connection "master".
2020-03-03 17:13:47,283047 (MainThread): On master: BEGIN
2020-03-03 17:13:47,284361 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:13:47,284549 (MainThread): Using postgres connection "master".
2020-03-03 17:13:47,284680 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 17:13:47,288960 (MainThread): SQL status: SELECT 4 in 0.00 seconds
2020-03-03 17:13:47,320623 (MainThread): Using postgres connection "master".
2020-03-03 17:13:47,320754 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 17:13:47,327673 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-03-03 17:13:47,328582 (MainThread): On master: ROLLBACK
2020-03-03 17:13:47,328889 (MainThread): Using postgres connection "master".
2020-03-03 17:13:47,328984 (MainThread): On master: BEGIN
2020-03-03 17:13:47,329381 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:13:47,329485 (MainThread): On master: COMMIT
2020-03-03 17:13:47,329566 (MainThread): Using postgres connection "master".
2020-03-03 17:13:47,329637 (MainThread): On master: COMMIT
2020-03-03 17:13:47,329852 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:13:47,330090 (MainThread): 11:13:47 | Concurrency: 1 threads (target='dev')
2020-03-03 17:13:47,330219 (MainThread): 11:13:47 | 
2020-03-03 17:13:47,333044 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 17:13:47,333253 (Thread-1): 11:13:47 | 1 of 3 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 17:13:47,333539 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:13:47,333636 (Thread-1): Opening a new connection, currently in state init
2020-03-03 17:13:47,333734 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 17:13:47,348617 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 17:13:47,351426 (Thread-1): finished collecting timing info
2020-03-03 17:13:47,372505 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:13:47,372669 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 17:13:47,378483 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-03-03 17:13:47,380549 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:13:47,380661 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 17:13:47,381031 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:13:47,396111 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 17:13:47,397036 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:13:47,397225 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 17:13:47,397571 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:13:47,397733 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:13:47,397860 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2020-03-03 17:13:47,402415 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 17:13:47,405997 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:13:47,406122 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 17:13:47,406625 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:13:47,408768 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:13:47,408875 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 17:13:47,409561 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:13:47,410344 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 17:13:47,410442 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:13:47,410518 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 17:13:47,411058 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:13:47,412872 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:13:47,412988 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 17:13:47,416797 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:13:47,418997 (Thread-1): finished collecting timing info
2020-03-03 17:13:47,419577 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94888cf4-0c38-42f2-aa8a-cd6583bc773a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a55b6a0>]}
2020-03-03 17:13:47,550657 (Thread-1): 11:13:47 | 1 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2020-03-03 17:13:47,550936 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 17:13:47,551248 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 17:13:47,551638 (Thread-1): 11:13:47 | 2 of 3 START view model public.fact_daily_performance................ [RUN]
2020-03-03 17:13:47,552294 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:13:47,552473 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 17:13:47,552630 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 17:13:47,561216 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 17:13:47,561828 (Thread-1): finished collecting timing info
2020-03-03 17:13:47,579767 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:13:47,579910 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-03 17:13:47,580368 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:13:47,582167 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:13:47,582262 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 17:13:47,582672 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:13:47,583824 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 17:13:47,584366 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:13:47,584499 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-03 17:13:47,586059 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:13:47,586251 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:13:47,586373 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    d.date,
    d.business_day,
    ad.impressions,
    ad.clicks,
    ad.spend,
    round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
    round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
    round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
from 
    "dbryan"."public"."dim_date" d
    inner join "dbryan"."public"."ad_account_metrics" ad
        on ad.date = d.date order by d.date
;
  );

2020-03-03 17:13:47,587484 (Thread-1): Postgres error: syntax error at or near ";"
LINE 18: ;
         ^

2020-03-03 17:13:47,587742 (Thread-1): On model.civis_platform.fact_daily_performance: ROLLBACK
2020-03-03 17:13:47,588090 (Thread-1): finished collecting timing info
2020-03-03 17:13:47,588510 (Thread-1): Database Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  syntax error at or near ";"
  LINE 18: ;
           ^
  compiled SQL at target/run/civis_platform/main/fact_daily_performance.sql
Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 44, in exception_handler
    yield
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 18: ;
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 218, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 161, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 260, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 436, in execute
    result = materialization_macro.generator(context)()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 155, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 155, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 276, in execute
    fetch=fetch
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  syntax error at or near ";"
  LINE 18: ;
           ^
  compiled SQL at target/run/civis_platform/main/fact_daily_performance.sql
2020-03-03 17:13:47,625629 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94888cf4-0c38-42f2-aa8a-cd6583bc773a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad6e48>]}
2020-03-03 17:13:47,755752 (Thread-1): 11:13:47 | 2 of 3 ERROR creating view model public.fact_daily_performance....... [ERROR in 0.07s]
2020-03-03 17:13:47,756071 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 17:13:47,756385 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 17:13:47,756784 (Thread-1): 11:13:47 | 3 of 3 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 17:13:47,757285 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:13:47,757454 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-03 17:13:47,757608 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 17:13:47,765117 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 17:13:47,768341 (Thread-1): finished collecting timing info
2020-03-03 17:13:47,776149 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:13:47,776297 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 17:13:47,776704 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:13:47,778926 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:13:47,779055 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 17:13:47,779384 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:13:47,780631 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 17:13:47,782027 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:13:47,782263 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 17:13:47,782633 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:13:47,782791 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:13:47,783009 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 17:13:47,786073 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 17:13:47,789575 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:13:47,789703 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 17:13:47,790124 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:13:47,792311 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:13:47,792444 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 17:13:47,793061 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:13:47,793898 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 17:13:47,794014 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:13:47,794093 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 17:13:47,794558 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:13:47,796121 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:13:47,796232 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 17:13:47,797976 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:13:47,800156 (Thread-1): finished collecting timing info
2020-03-03 17:13:47,800956 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94888cf4-0c38-42f2-aa8a-cd6583bc773a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d5c1d0>]}
2020-03-03 17:13:47,928986 (Thread-1): 11:13:47 | 3 of 3 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.04s]
2020-03-03 17:13:47,929254 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 17:13:47,950309 (MainThread): Using postgres connection "master".
2020-03-03 17:13:47,950659 (MainThread): On master: BEGIN
2020-03-03 17:13:47,951385 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:13:47,951811 (MainThread): On master: COMMIT
2020-03-03 17:13:47,952255 (MainThread): Using postgres connection "master".
2020-03-03 17:13:47,952456 (MainThread): On master: COMMIT
2020-03-03 17:13:47,952892 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:13:47,953358 (MainThread): 11:13:47 | 
2020-03-03 17:13:47,953565 (MainThread): 11:13:47 | Finished running 2 table models, 1 view model in 0.80s.
2020-03-03 17:13:47,953785 (MainThread): Connection 'master' was left open.
2020-03-03 17:13:47,954020 (MainThread): On master: Close
2020-03-03 17:13:47,954286 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 17:13:47,954511 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 17:13:47,964904 (MainThread): 
2020-03-03 17:13:47,965417 (MainThread): Completed with 1 error and 0 warnings:
2020-03-03 17:13:47,965722 (MainThread): 
2020-03-03 17:13:47,965986 (MainThread): Database Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
2020-03-03 17:13:47,966175 (MainThread):   syntax error at or near ";"
2020-03-03 17:13:47,966344 (MainThread):   LINE 18: ;
2020-03-03 17:13:47,966473 (MainThread):            ^
2020-03-03 17:13:47,966592 (MainThread):   compiled SQL at target/run/civis_platform/main/fact_daily_performance.sql
2020-03-03 17:13:47,966796 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2020-03-03 17:13:47,967051 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efc9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efcb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e76b00>]}
2020-03-03 17:13:48,94787 (MainThread): Flushing usage events
2020-03-03 17:14:05,187492 (MainThread): Running with dbt=0.15.2
2020-03-03 17:14:05,281688 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 17:14:05,282322 (MainThread): Tracking: tracking
2020-03-03 17:14:05,288920 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10296ccc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10296c908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10296c470>]}
2020-03-03 17:14:05,448259 (MainThread): Partial parsing not enabled
2020-03-03 17:14:05,450281 (MainThread): Parsing macros/core.sql
2020-03-03 17:14:05,454347 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 17:14:05,459690 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 17:14:05,461112 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 17:14:05,473448 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 17:14:05,487698 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 17:14:05,501806 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 17:14:05,503584 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 17:14:05,509181 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 17:14:05,514815 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 17:14:05,519699 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 17:14:05,524386 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 17:14:05,528294 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 17:14:05,529269 (MainThread): Parsing macros/etc/query.sql
2020-03-03 17:14:05,530354 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 17:14:05,531868 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 17:14:05,533669 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 17:14:05,540572 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 17:14:05,542430 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 17:14:05,563733 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 17:14:05,564922 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 17:14:05,565881 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 17:14:05,566928 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 17:14:05,568833 (MainThread): Parsing macros/catalog.sql
2020-03-03 17:14:05,570212 (MainThread): Parsing macros/relations.sql
2020-03-03 17:14:05,571323 (MainThread): Parsing macros/adapters.sql
2020-03-03 17:14:05,579188 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 17:14:05,596701 (MainThread): Partial parsing not enabled
2020-03-03 17:14:05,608935 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:14:05,609070 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:14:05,625702 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:14:05,625833 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:14:05,630832 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:14:05,630967 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:14:05,666252 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 17:14:05,666386 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:14:05,676188 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 17:14:05,676317 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:14:05,685742 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 17:14:05,685868 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:14:05,693099 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 17:14:05,693235 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:14:05,748111 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 17:14:05,752955 (MainThread): 
2020-03-03 17:14:05,753381 (MainThread): Acquiring new postgres connection "master".
2020-03-03 17:14:05,753477 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:14:05,835934 (MainThread): Using postgres connection "master".
2020-03-03 17:14:05,836090 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 17:14:05,842969 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 17:14:05,889416 (MainThread): Using postgres connection "master".
2020-03-03 17:14:05,889576 (MainThread): On master: BEGIN
2020-03-03 17:14:05,889876 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:14:05,889966 (MainThread): Using postgres connection "master".
2020-03-03 17:14:05,890039 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 17:14:05,897322 (MainThread): SQL status: SELECT 4 in 0.01 seconds
2020-03-03 17:14:05,939995 (MainThread): Using postgres connection "master".
2020-03-03 17:14:05,940133 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 17:14:05,949890 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-03-03 17:14:05,950893 (MainThread): On master: ROLLBACK
2020-03-03 17:14:05,951301 (MainThread): Using postgres connection "master".
2020-03-03 17:14:05,951389 (MainThread): On master: BEGIN
2020-03-03 17:14:05,952012 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:14:05,952220 (MainThread): On master: COMMIT
2020-03-03 17:14:05,952359 (MainThread): Using postgres connection "master".
2020-03-03 17:14:05,952433 (MainThread): On master: COMMIT
2020-03-03 17:14:05,952634 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:14:05,952895 (MainThread): 11:14:05 | Concurrency: 1 threads (target='dev')
2020-03-03 17:14:05,953025 (MainThread): 11:14:05 | 
2020-03-03 17:14:05,955027 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 17:14:05,955341 (Thread-1): 11:14:05 | 1 of 3 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 17:14:05,955898 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:14:05,956083 (Thread-1): Opening a new connection, currently in state init
2020-03-03 17:14:05,956249 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 17:14:05,973459 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 17:14:05,974066 (Thread-1): finished collecting timing info
2020-03-03 17:14:05,992142 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:14:05,992329 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 17:14:05,997854 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-03-03 17:14:05,999993 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:14:06,192 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 17:14:06,569 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:14:06,16338 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 17:14:06,17100 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:14:06,17308 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 17:14:06,17805 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:14:06,17960 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:14:06,18083 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2020-03-03 17:14:06,21602 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 17:14:06,25041 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:14:06,25159 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 17:14:06,25697 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:14:06,28064 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:14:06,28202 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 17:14:06,28884 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:14:06,29661 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 17:14:06,29756 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:14:06,29829 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 17:14:06,30455 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:14:06,31941 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:14:06,32039 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 17:14:06,34500 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:14:06,36672 (Thread-1): finished collecting timing info
2020-03-03 17:14:06,37241 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6cce9ae-1f8e-442c-8f4f-13052f6e909a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072141d0>]}
2020-03-03 17:14:06,213983 (Thread-1): 11:14:06 | 1 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2020-03-03 17:14:06,214278 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 17:14:06,214662 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 17:14:06,215109 (Thread-1): 11:14:06 | 2 of 3 START view model public.fact_daily_performance................ [RUN]
2020-03-03 17:14:06,215893 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:14:06,216072 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 17:14:06,216227 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 17:14:06,224614 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 17:14:06,225183 (Thread-1): finished collecting timing info
2020-03-03 17:14:06,242702 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:14:06,242844 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-03 17:14:06,243267 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:14:06,245145 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:14:06,245245 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 17:14:06,245549 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:14:06,246700 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 17:14:06,247435 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:14:06,247676 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-03 17:14:06,247941 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:14:06,248071 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:14:06,248192 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    d.date,
    d.business_day,
    ad.impressions,
    ad.clicks,
    ad.spend,
    round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
    round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
    round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
from 
    "dbryan"."public"."dim_date" d
    inner join "dbryan"."public"."ad_account_metrics" ad
        on ad.date = d.date order by d.date
  );

2020-03-03 17:14:06,267418 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2020-03-03 17:14:06,270355 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:14:06,270494 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance__dbt_tmp" rename to "fact_daily_performance"
2020-03-03 17:14:06,271495 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:14:06,272860 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 17:14:06,272991 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:14:06,273076 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 17:14:06,273683 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:14:06,276514 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:14:06,276652 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 17:14:06,276920 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:14:06,279044 (Thread-1): finished collecting timing info
2020-03-03 17:14:06,279688 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6cce9ae-1f8e-442c-8f4f-13052f6e909a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c6470>]}
2020-03-03 17:14:06,407763 (Thread-1): 11:14:06 | 2 of 3 OK created view model public.fact_daily_performance........... [CREATE VIEW in 0.06s]
2020-03-03 17:14:06,408050 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 17:14:06,408295 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 17:14:06,408521 (Thread-1): 11:14:06 | 3 of 3 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 17:14:06,408952 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:14:06,409096 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-03 17:14:06,409361 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 17:14:06,416717 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 17:14:06,417390 (Thread-1): finished collecting timing info
2020-03-03 17:14:06,424018 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:14:06,424150 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 17:14:06,424513 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:14:06,426396 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:14:06,426489 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 17:14:06,426782 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:14:06,427923 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 17:14:06,428720 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:14:06,428927 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 17:14:06,429194 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:14:06,429307 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:14:06,429386 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 17:14:06,432172 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 17:14:06,436154 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:14:06,436291 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 17:14:06,436775 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:14:06,438665 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:14:06,438758 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 17:14:06,439450 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:14:06,440220 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 17:14:06,440314 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:14:06,440387 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 17:14:06,441058 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:14:06,442572 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:14:06,442698 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 17:14:06,443983 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:14:06,446164 (Thread-1): finished collecting timing info
2020-03-03 17:14:06,446827 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6cce9ae-1f8e-442c-8f4f-13052f6e909a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067bf630>]}
2020-03-03 17:14:06,577521 (Thread-1): 11:14:06 | 3 of 3 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.04s]
2020-03-03 17:14:06,577829 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 17:14:06,674531 (MainThread): Using postgres connection "master".
2020-03-03 17:14:06,674892 (MainThread): On master: BEGIN
2020-03-03 17:14:06,675571 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:14:06,675936 (MainThread): On master: COMMIT
2020-03-03 17:14:06,676176 (MainThread): Using postgres connection "master".
2020-03-03 17:14:06,676386 (MainThread): On master: COMMIT
2020-03-03 17:14:06,676954 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:14:06,677608 (MainThread): 11:14:06 | 
2020-03-03 17:14:06,677917 (MainThread): 11:14:06 | Finished running 2 table models, 1 view model in 0.92s.
2020-03-03 17:14:06,678396 (MainThread): Connection 'master' was left open.
2020-03-03 17:14:06,678691 (MainThread): On master: Close
2020-03-03 17:14:06,678992 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 17:14:06,679366 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 17:14:06,689689 (MainThread): 
2020-03-03 17:14:06,689966 (MainThread): Completed successfully
2020-03-03 17:14:06,690147 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-03-03 17:14:06,690487 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ac9b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b7aba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b7a748>]}
2020-03-03 17:14:06,819140 (MainThread): Flushing usage events
2020-03-03 17:31:41,849369 (MainThread): Running with dbt=0.15.2
2020-03-03 17:31:41,951628 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 17:31:41,952433 (MainThread): Tracking: tracking
2020-03-03 17:31:41,961620 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0eb3c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0eb9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ebc50>]}
2020-03-03 17:31:42,205045 (MainThread): Partial parsing not enabled
2020-03-03 17:31:42,207957 (MainThread): Parsing macros/core.sql
2020-03-03 17:31:42,212423 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 17:31:42,218025 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 17:31:42,219817 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 17:31:42,234184 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 17:31:42,249151 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 17:31:42,262739 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 17:31:42,264899 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 17:31:42,271342 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 17:31:42,277584 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 17:31:42,282889 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 17:31:42,287869 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 17:31:42,292496 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 17:31:42,294602 (MainThread): Parsing macros/etc/query.sql
2020-03-03 17:31:42,296768 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 17:31:42,299558 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 17:31:42,301556 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 17:31:42,308730 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 17:31:42,310889 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 17:31:42,332835 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 17:31:42,334281 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 17:31:42,335510 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 17:31:42,336874 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 17:31:42,339371 (MainThread): Parsing macros/catalog.sql
2020-03-03 17:31:42,343636 (MainThread): Parsing macros/relations.sql
2020-03-03 17:31:42,345899 (MainThread): Parsing macros/adapters.sql
2020-03-03 17:31:42,357033 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 17:31:42,377685 (MainThread): Partial parsing not enabled
2020-03-03 17:31:42,391396 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:31:42,391547 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:31:42,410444 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:31:42,410583 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:31:42,415431 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:31:42,415550 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:31:42,420960 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:31:42,421093 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:31:42,457140 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 17:31:42,457279 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:31:42,466764 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 17:31:42,466894 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:31:42,476311 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 17:31:42,476482 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:31:42,482334 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 17:31:42,482448 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:31:42,538969 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 17:31:42,544504 (MainThread): 
2020-03-03 17:31:42,544882 (MainThread): Acquiring new postgres connection "master".
2020-03-03 17:31:42,544980 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:31:42,626542 (MainThread): Using postgres connection "master".
2020-03-03 17:31:42,626700 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 17:31:42,636825 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 17:31:42,675364 (MainThread): Using postgres connection "master".
2020-03-03 17:31:42,675503 (MainThread): On master: BEGIN
2020-03-03 17:31:42,676884 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:31:42,677065 (MainThread): Using postgres connection "master".
2020-03-03 17:31:42,677189 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 17:31:42,683197 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-03-03 17:31:42,721912 (MainThread): Using postgres connection "master".
2020-03-03 17:31:42,722040 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 17:31:42,730559 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2020-03-03 17:31:42,733217 (MainThread): On master: ROLLBACK
2020-03-03 17:31:42,733682 (MainThread): Using postgres connection "master".
2020-03-03 17:31:42,733979 (MainThread): On master: BEGIN
2020-03-03 17:31:42,734683 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:31:42,735031 (MainThread): On master: COMMIT
2020-03-03 17:31:42,735292 (MainThread): Using postgres connection "master".
2020-03-03 17:31:42,735565 (MainThread): On master: COMMIT
2020-03-03 17:31:42,736102 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:31:42,736875 (MainThread): 11:31:42 | Concurrency: 1 threads (target='dev')
2020-03-03 17:31:42,737229 (MainThread): 11:31:42 | 
2020-03-03 17:31:42,741848 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 17:31:42,742369 (Thread-1): 11:31:42 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 17:31:42,743200 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:31:42,743483 (Thread-1): Opening a new connection, currently in state init
2020-03-03 17:31:42,743741 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 17:31:42,762220 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 17:31:42,762913 (Thread-1): finished collecting timing info
2020-03-03 17:31:42,795471 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:31:42,795632 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-03 17:31:42,801777 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-03-03 17:31:42,803871 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:31:42,803974 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 17:31:42,804380 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:31:42,805744 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 17:31:42,806514 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:31:42,806749 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-03 17:31:42,807160 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:31:42,807321 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:31:42,807479 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    d.date,
    d.business_day,
    ad.impressions,
    ad.clicks,
    ad.spend,
    round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
    round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
    round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
from 
    "dbryan"."public"."dim_date" d
    inner join "dbryan"."public"."ad_account_metrics" ad
        on ad.date = d.date order by d.date
  );

2020-03-03 17:31:42,814523 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-03-03 17:31:42,818230 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:31:42,818366 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance" rename to "fact_daily_performance__dbt_backup"
2020-03-03 17:31:42,819004 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:31:42,821137 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:31:42,821256 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance__dbt_tmp" rename to "fact_daily_performance"
2020-03-03 17:31:42,821858 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:31:42,822587 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 17:31:42,822677 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:31:42,822748 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 17:31:42,823470 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:31:42,824934 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:31:42,825034 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 17:31:42,828271 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:31:42,830600 (Thread-1): finished collecting timing info
2020-03-03 17:31:42,831210 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a08d8918-da5f-46ea-a2ae-22ebb115a910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10deeb550>]}
2020-03-03 17:31:42,958966 (Thread-1): 11:31:42 | 1 of 4 OK created view model public.fact_daily_performance........... [CREATE VIEW in 0.09s]
2020-03-03 17:31:42,959250 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 17:31:42,959551 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 17:31:42,960085 (Thread-1): 11:31:42 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 17:31:42,960584 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:31:42,960757 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-03 17:31:42,960909 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 17:31:42,969133 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 17:31:42,969711 (Thread-1): finished collecting timing info
2020-03-03 17:31:42,987895 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:31:42,988039 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 17:31:42,988448 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:31:42,990344 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:31:42,990441 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 17:31:42,990791 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:31:42,991888 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 17:31:42,992432 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:31:42,992654 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 17:31:42,992958 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:31:42,993117 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:31:42,993235 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2020-03-03 17:31:42,995314 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 17:31:42,999665 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:31:42,999798 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 17:31:43,272 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:31:43,2927 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:31:43,3085 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 17:31:43,3757 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:31:43,4704 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 17:31:43,4844 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:31:43,4926 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 17:31:43,5671 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:31:43,7786 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:31:43,7948 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 17:31:43,9876 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:31:43,12099 (Thread-1): finished collecting timing info
2020-03-03 17:31:43,12700 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a08d8918-da5f-46ea-a2ae-22ebb115a910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df1e0f0>]}
2020-03-03 17:31:43,143979 (Thread-1): 11:31:43 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.05s]
2020-03-03 17:31:43,144255 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 17:31:43,144557 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 17:31:43,145020 (Thread-1): 11:31:43 | 3 of 4 START view model public.fact_monthly_performance.............. [RUN]
2020-03-03 17:31:43,145473 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:31:43,145621 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 17:31:43,145764 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 17:31:43,152693 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 17:31:43,153175 (Thread-1): finished collecting timing info
2020-03-03 17:31:43,160471 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:31:43,160623 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_tmp" cascade
2020-03-03 17:31:43,161063 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:31:43,162898 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:31:43,162994 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 17:31:43,163281 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:31:43,164491 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 17:31:43,165024 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:31:43,165173 (Thread-1): On model.civis_platform.fact_monthly_performance: BEGIN
2020-03-03 17:31:43,165924 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:31:43,166201 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:31:43,166444 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

  
  create view "dbryan"."public"."fact_monthly_performance__dbt_tmp" as (
    select
    date_trunc('month', f.date)::date as month,
    sum(impressions) as impressions,
    sum(clicks) as clicks,
    sum(spend) as spend,
    round(avg(spend)::numeric, 2) as average_daily_spend
from
    "dbryan"."public"."fact_daily_performance" f
group by 
    date_trunc('month', f.date)::date
order by
    date_trunc('month', f.date)::date
  );

2020-03-03 17:31:43,172523 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-03-03 17:31:43,174750 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:31:43,174866 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
alter table "dbryan"."public"."fact_monthly_performance__dbt_tmp" rename to "fact_monthly_performance"
2020-03-03 17:31:43,175366 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:31:43,176228 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 17:31:43,176333 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:31:43,176414 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 17:31:43,176980 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:31:43,180288 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:31:43,180435 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 17:31:43,180753 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:31:43,182910 (Thread-1): finished collecting timing info
2020-03-03 17:31:43,183567 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a08d8918-da5f-46ea-a2ae-22ebb115a910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a7c50>]}
2020-03-03 17:31:43,306556 (Thread-1): 11:31:43 | 3 of 4 OK created view model public.fact_monthly_performance......... [CREATE VIEW in 0.04s]
2020-03-03 17:31:43,306844 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 17:31:43,307166 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 17:31:43,307650 (Thread-1): 11:31:43 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 17:31:43,308356 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:31:43,308505 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_monthly_performance).
2020-03-03 17:31:43,308653 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 17:31:43,318229 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 17:31:43,318787 (Thread-1): finished collecting timing info
2020-03-03 17:31:43,325732 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:31:43,325868 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 17:31:43,326309 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:31:43,328246 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:31:43,328428 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 17:31:43,328812 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:31:43,330082 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 17:31:43,330861 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:31:43,331090 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 17:31:43,331390 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:31:43,331558 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:31:43,331714 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 17:31:43,333144 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 17:31:43,336752 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:31:43,336895 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 17:31:43,337326 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:31:43,339370 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:31:43,339499 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 17:31:43,340095 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:31:43,340957 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 17:31:43,341070 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:31:43,341145 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 17:31:43,345832 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:31:43,348448 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:31:43,348611 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 17:31:43,350030 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:31:43,352148 (Thread-1): finished collecting timing info
2020-03-03 17:31:43,352737 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a08d8918-da5f-46ea-a2ae-22ebb115a910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a7c50>]}
2020-03-03 17:31:43,484224 (Thread-1): 11:31:43 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.04s]
2020-03-03 17:31:43,484508 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 17:31:43,564596 (MainThread): Using postgres connection "master".
2020-03-03 17:31:43,564954 (MainThread): On master: BEGIN
2020-03-03 17:31:43,565565 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:31:43,565845 (MainThread): On master: COMMIT
2020-03-03 17:31:43,566069 (MainThread): Using postgres connection "master".
2020-03-03 17:31:43,566271 (MainThread): On master: COMMIT
2020-03-03 17:31:43,566905 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:31:43,567656 (MainThread): 11:31:43 | 
2020-03-03 17:31:43,568019 (MainThread): 11:31:43 | Finished running 2 view models, 2 table models in 1.02s.
2020-03-03 17:31:43,568398 (MainThread): Connection 'master' was left open.
2020-03-03 17:31:43,568753 (MainThread): On master: Close
2020-03-03 17:31:43,569113 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 17:31:43,569358 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 17:31:43,583087 (MainThread): 
2020-03-03 17:31:43,583437 (MainThread): Completed successfully
2020-03-03 17:31:43,583678 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-03-03 17:31:43,584052 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e95f978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a7d68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a7898>]}
2020-03-03 17:31:43,707301 (MainThread): Flushing usage events
2020-03-03 17:41:29,182712 (MainThread): Running with dbt=0.15.2
2020-03-03 17:41:29,285845 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 17:41:29,286640 (MainThread): Tracking: tracking
2020-03-03 17:41:29,295712 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d85d68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a74a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a74aa20>]}
2020-03-03 17:41:29,487707 (MainThread): Partial parsing not enabled
2020-03-03 17:41:29,490457 (MainThread): Parsing macros/core.sql
2020-03-03 17:41:29,496698 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 17:41:29,502481 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 17:41:29,504230 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 17:41:29,522032 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 17:41:29,538006 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 17:41:29,554987 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 17:41:29,583577 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 17:41:29,591816 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 17:41:29,598715 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 17:41:29,604438 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 17:41:29,610072 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 17:41:29,614722 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 17:41:29,615980 (MainThread): Parsing macros/etc/query.sql
2020-03-03 17:41:29,617172 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 17:41:29,618840 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 17:41:29,620837 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 17:41:29,628041 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 17:41:29,630068 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 17:41:29,654872 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 17:41:29,656116 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 17:41:29,657177 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 17:41:29,658311 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 17:41:29,660565 (MainThread): Parsing macros/catalog.sql
2020-03-03 17:41:29,662312 (MainThread): Parsing macros/relations.sql
2020-03-03 17:41:29,663604 (MainThread): Parsing macros/adapters.sql
2020-03-03 17:41:29,672046 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 17:41:29,691966 (MainThread): Partial parsing not enabled
2020-03-03 17:41:29,707654 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:41:29,707790 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:29,723813 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:41:29,723947 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:29,729047 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:41:29,729165 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:29,734213 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:41:29,734339 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:29,780369 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 17:41:29,780527 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:29,793415 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 17:41:29,793612 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:29,805245 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 17:41:29,805423 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:29,813809 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 17:41:29,813947 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:29,879518 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 17:41:29,883652 (MainThread): 
2020-03-03 17:41:29,884056 (MainThread): Acquiring new postgres connection "master".
2020-03-03 17:41:29,884204 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:29,974324 (MainThread): Using postgres connection "master".
2020-03-03 17:41:29,974556 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 17:41:29,980753 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 17:41:30,33788 (MainThread): Using postgres connection "master".
2020-03-03 17:41:30,33951 (MainThread): On master: BEGIN
2020-03-03 17:41:30,93650 (MainThread): SQL status: BEGIN in 0.06 seconds
2020-03-03 17:41:30,93849 (MainThread): Using postgres connection "master".
2020-03-03 17:41:30,93941 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 17:41:30,98264 (MainThread): SQL status: SELECT 6 in 0.00 seconds
2020-03-03 17:41:30,141345 (MainThread): Using postgres connection "master".
2020-03-03 17:41:30,141474 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 17:41:30,152671 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 17:41:30,156554 (MainThread): On master: ROLLBACK
2020-03-03 17:41:30,156828 (MainThread): Using postgres connection "master".
2020-03-03 17:41:30,156934 (MainThread): On master: BEGIN
2020-03-03 17:41:30,157311 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:41:30,157422 (MainThread): On master: COMMIT
2020-03-03 17:41:30,157496 (MainThread): Using postgres connection "master".
2020-03-03 17:41:30,157562 (MainThread): On master: COMMIT
2020-03-03 17:41:30,157852 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:41:30,158118 (MainThread): 11:41:30 | Concurrency: 1 threads (target='dev')
2020-03-03 17:41:30,158231 (MainThread): 11:41:30 | 
2020-03-03 17:41:30,160725 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 17:41:30,160945 (Thread-1): 11:41:30 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 17:41:30,161240 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:41:30,161354 (Thread-1): Opening a new connection, currently in state init
2020-03-03 17:41:30,161442 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 17:41:30,175093 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 17:41:30,176031 (Thread-1): finished collecting timing info
2020-03-03 17:41:30,215557 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:41:30,215749 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-03 17:41:30,227252 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-03-03 17:41:30,233573 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:41:30,233823 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 17:41:30,234334 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:41:30,236472 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 17:41:30,237578 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:41:30,237832 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-03 17:41:30,238256 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:41:30,238612 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:41:30,238806 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    d.date,
    d.business_day,
    ad.impressions,
    ad.clicks,
    ad.spend,
    round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
    round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
    round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
from 
    "dbryan"."public"."dim_date" d
    inner join "dbryan"."public"."ad_account_metrics" ad
        on ad.date = d.date order by d.date
  );

2020-03-03 17:41:30,244782 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-03-03 17:41:30,248478 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:41:30,248691 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance" rename to "fact_daily_performance__dbt_backup"
2020-03-03 17:41:30,249425 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:41:30,252408 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:41:30,252544 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance__dbt_tmp" rename to "fact_daily_performance"
2020-03-03 17:41:30,253286 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:41:30,254417 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 17:41:30,254541 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:41:30,254629 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 17:41:30,255182 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:41:30,256909 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:41:30,257046 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 17:41:30,258875 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:41:30,261544 (Thread-1): finished collecting timing info
2020-03-03 17:41:30,262256 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a06a15d6-2cd1-415d-8d26-84e614283851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8cf98>]}
2020-03-03 17:41:30,389951 (Thread-1): 11:41:30 | 1 of 4 OK created view model public.fact_daily_performance........... [CREATE VIEW in 0.10s]
2020-03-03 17:41:30,390199 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 17:41:30,390547 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 17:41:30,391012 (Thread-1): 11:41:30 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 17:41:30,391785 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:41:30,392001 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-03 17:41:30,392396 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 17:41:30,401180 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 17:41:30,401759 (Thread-1): finished collecting timing info
2020-03-03 17:41:30,421958 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:41:30,422096 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 17:41:30,422547 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:41:30,425548 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:41:30,425684 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 17:41:30,426021 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:41:30,427343 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 17:41:30,427991 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:41:30,428335 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 17:41:30,428654 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:41:30,428811 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:41:30,428932 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2020-03-03 17:41:30,430603 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 17:41:30,433995 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:41:30,434112 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 17:41:30,434603 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:41:30,437163 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:41:30,437280 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 17:41:30,437859 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:41:30,439013 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 17:41:30,439214 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:41:30,439320 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 17:41:30,439737 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:41:30,441484 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:41:30,441712 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 17:41:30,443801 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:41:30,446261 (Thread-1): finished collecting timing info
2020-03-03 17:41:30,446976 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a06a15d6-2cd1-415d-8d26-84e614283851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e80908>]}
2020-03-03 17:41:30,578103 (Thread-1): 11:41:30 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.06s]
2020-03-03 17:41:30,578380 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 17:41:30,578617 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 17:41:30,578838 (Thread-1): 11:41:30 | 3 of 4 START view model public.fact_monthly_performance.............. [RUN]
2020-03-03 17:41:30,579450 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:41:30,579615 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 17:41:30,579763 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 17:41:30,587687 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 17:41:30,588328 (Thread-1): finished collecting timing info
2020-03-03 17:41:30,596626 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:41:30,596795 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_tmp" cascade
2020-03-03 17:41:30,597232 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:41:30,599863 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:41:30,600040 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 17:41:30,600385 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:41:30,602456 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 17:41:30,603350 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:41:30,603502 (Thread-1): On model.civis_platform.fact_monthly_performance: BEGIN
2020-03-03 17:41:30,604010 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:41:30,604235 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:41:30,604384 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

  
  create view "dbryan"."public"."fact_monthly_performance__dbt_tmp" as (
    select
    date_trunc('month', f.date)::date as month,
    sum(impressions) as impressions,
    sum(clicks) as clicks,
    sum(spend) as spend,
    round(avg(spend)::numeric, 2) as average_daily_spend
from
    "dbryan"."public"."fact_daily_performance" f
group by 
    date_trunc('month', f.date)::date
order by
    date_trunc('month', f.date)::date
  );

2020-03-03 17:41:30,606790 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 17:41:30,608944 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:41:30,609056 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
alter table "dbryan"."public"."fact_monthly_performance__dbt_tmp" rename to "fact_monthly_performance"
2020-03-03 17:41:30,609523 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:41:30,610255 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 17:41:30,610346 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:41:30,610415 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 17:41:30,610965 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:41:30,614883 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:41:30,615098 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 17:41:30,615459 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:41:30,619422 (Thread-1): finished collecting timing info
2020-03-03 17:41:30,620693 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a06a15d6-2cd1-415d-8d26-84e614283851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abb3cc0>]}
2020-03-03 17:41:30,799699 (Thread-1): 11:41:30 | 3 of 4 OK created view model public.fact_monthly_performance......... [CREATE VIEW in 0.04s]
2020-03-03 17:41:30,799986 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 17:41:30,800225 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 17:41:30,800567 (Thread-1): 11:41:30 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 17:41:30,801121 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:41:30,801246 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_monthly_performance).
2020-03-03 17:41:30,801371 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 17:41:30,809310 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 17:41:30,811246 (Thread-1): finished collecting timing info
2020-03-03 17:41:30,822378 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:41:30,826157 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 17:41:30,827361 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:41:30,831181 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:41:30,831329 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 17:41:30,831706 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:41:30,833106 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 17:41:30,833598 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:41:30,833873 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 17:41:30,834197 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:41:30,834342 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:41:30,834758 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 17:41:30,838074 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 17:41:30,843437 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:41:30,843569 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 17:41:30,844160 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:41:30,846756 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:41:30,846919 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 17:41:30,847652 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:41:30,848488 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 17:41:30,848590 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:41:30,848663 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 17:41:30,849036 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:41:30,850511 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:41:30,850616 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 17:41:30,851587 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:41:30,853715 (Thread-1): finished collecting timing info
2020-03-03 17:41:30,854321 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a06a15d6-2cd1-415d-8d26-84e614283851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff5f60>]}
2020-03-03 17:41:30,985477 (Thread-1): 11:41:30 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.05s]
2020-03-03 17:41:30,985739 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 17:41:31,85432 (MainThread): Using postgres connection "master".
2020-03-03 17:41:31,85675 (MainThread): On master: BEGIN
2020-03-03 17:41:31,86043 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:41:31,86167 (MainThread): On master: COMMIT
2020-03-03 17:41:31,86263 (MainThread): Using postgres connection "master".
2020-03-03 17:41:31,86349 (MainThread): On master: COMMIT
2020-03-03 17:41:31,86609 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:41:31,86933 (MainThread): 11:41:31 | 
2020-03-03 17:41:31,87092 (MainThread): 11:41:31 | Finished running 2 view models, 2 table models in 1.20s.
2020-03-03 17:41:31,87250 (MainThread): Connection 'master' was left open.
2020-03-03 17:41:31,87391 (MainThread): On master: Close
2020-03-03 17:41:31,87568 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 17:41:31,87705 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 17:41:31,101308 (MainThread): 
2020-03-03 17:41:31,101681 (MainThread): Completed successfully
2020-03-03 17:41:31,102024 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-03-03 17:41:31,102437 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecbeb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff5e80>]}
2020-03-03 17:41:31,225430 (MainThread): Flushing usage events
2020-03-03 17:41:45,230599 (MainThread): Running with dbt=0.15.2
2020-03-03 17:41:45,321836 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', show=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2020-03-03 17:41:45,322533 (MainThread): Tracking: tracking
2020-03-03 17:41:45,330458 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac36160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071acf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ac438>]}
2020-03-03 17:41:45,495303 (MainThread): Partial parsing not enabled
2020-03-03 17:41:45,497232 (MainThread): Parsing macros/core.sql
2020-03-03 17:41:45,501967 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 17:41:45,508830 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 17:41:45,510618 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 17:41:45,526682 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 17:41:45,543212 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 17:41:45,557086 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 17:41:45,558822 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 17:41:45,564238 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 17:41:45,570043 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 17:41:45,574937 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 17:41:45,579622 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 17:41:45,583561 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 17:41:45,584641 (MainThread): Parsing macros/etc/query.sql
2020-03-03 17:41:45,585908 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 17:41:45,587647 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 17:41:45,589773 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 17:41:45,598831 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 17:41:45,600719 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 17:41:45,625690 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 17:41:45,626765 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 17:41:45,627577 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 17:41:45,628473 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 17:41:45,630214 (MainThread): Parsing macros/catalog.sql
2020-03-03 17:41:45,631450 (MainThread): Parsing macros/relations.sql
2020-03-03 17:41:45,632395 (MainThread): Parsing macros/adapters.sql
2020-03-03 17:41:45,640453 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 17:41:45,656895 (MainThread): Partial parsing not enabled
2020-03-03 17:41:45,668757 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:41:45,668891 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:45,682850 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:41:45,682974 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:45,687759 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:41:45,687871 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:45,692643 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:41:45,692754 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:45,727586 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 17:41:45,727729 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:45,737738 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 17:41:45,737869 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:45,747262 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 17:41:45,747393 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:45,753375 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 17:41:45,753494 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:45,811136 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 17:41:45,815209 (MainThread): 
2020-03-03 17:41:45,815612 (MainThread): Acquiring new postgres connection "master".
2020-03-03 17:41:45,815726 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:41:45,901637 (MainThread): Using postgres connection "master".
2020-03-03 17:41:45,901796 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 17:41:45,907977 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 17:41:45,948250 (MainThread): Using postgres connection "master".
2020-03-03 17:41:45,948395 (MainThread): On master: BEGIN
2020-03-03 17:41:45,948798 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:41:45,948913 (MainThread): Using postgres connection "master".
2020-03-03 17:41:45,948987 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 17:41:45,952243 (MainThread): SQL status: SELECT 6 in 0.00 seconds
2020-03-03 17:41:45,988161 (MainThread): Using postgres connection "master".
2020-03-03 17:41:45,988336 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 17:41:45,998856 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 17:41:46,4666 (MainThread): On master: ROLLBACK
2020-03-03 17:41:46,5070 (MainThread): Using postgres connection "master".
2020-03-03 17:41:46,5223 (MainThread): On master: BEGIN
2020-03-03 17:41:46,5537 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:41:46,5653 (MainThread): On master: COMMIT
2020-03-03 17:41:46,5740 (MainThread): Using postgres connection "master".
2020-03-03 17:41:46,5811 (MainThread): On master: COMMIT
2020-03-03 17:41:46,5980 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:41:46,6378 (MainThread): 11:41:46 | Concurrency: 1 threads (target='dev')
2020-03-03 17:41:46,6585 (MainThread): 11:41:46 | 
2020-03-03 17:41:46,8735 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-03 17:41:46,8929 (Thread-1): 11:41:46 | 1 of 2 START seed file public.ad_account_metrics..................... [RUN]
2020-03-03 17:41:46,9214 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 17:41:46,9315 (Thread-1): Opening a new connection, currently in state init
2020-03-03 17:41:46,9414 (Thread-1): finished collecting timing info
2020-03-03 17:41:46,78745 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 17:41:46,79102 (Thread-1): On seed.civis_platform.ad_account_metrics: BEGIN
2020-03-03 17:41:46,84091 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:41:46,84238 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 17:41:46,84320 (Thread-1): On seed.civis_platform.ad_account_metrics: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "seed.civis_platform.ad_account_metrics"} */
truncate table "dbryan"."public"."ad_account_metrics"
2020-03-03 17:41:46,86192 (Thread-1): SQL status: TRUNCATE TABLE in 0.00 seconds
2020-03-03 17:41:46,87617 (Thread-1): * Deprecation Warning: 
    The quote_columns parameter was not set for seeds, so the default value of
    False was chosen. The default will change to True in a future release.

    For more information, see:
    https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
    

2020-03-03 17:41:46,88097 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 17:41:46,88195 (Thread-1): On seed.civis_platform.ad_account_metrics: 
            insert into "dbryan"."public"."ad_account_metrics" (date, impressions, clicks, spend) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
        ...
2020-03-03 17:41:46,89924 (Thread-1): SQL status: INSERT 0 7 in 0.00 seconds
2020-03-03 17:41:46,90382 (Thread-1): Writing runtime SQL for node "seed.civis_platform.ad_account_metrics"
2020-03-03 17:41:46,94090 (Thread-1): On seed.civis_platform.ad_account_metrics: COMMIT
2020-03-03 17:41:46,94247 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 17:41:46,94345 (Thread-1): On seed.civis_platform.ad_account_metrics: COMMIT
2020-03-03 17:41:46,96089 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:41:46,99047 (Thread-1): finished collecting timing info
2020-03-03 17:41:46,99718 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b203cb8-d469-4938-9ba0-dbf8619b23ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742f6d8>]}
2020-03-03 17:41:46,224465 (Thread-1): 11:41:46 | 1 of 2 OK loaded seed file public.ad_account_metrics................. [INSERT 7 in 0.09s]
2020-03-03 17:41:46,224687 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-03 17:41:46,224895 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-03 17:41:46,225171 (Thread-1): 11:41:46 | 2 of 2 START seed file public.dim_date............................... [RUN]
2020-03-03 17:41:46,225519 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-03 17:41:46,225615 (Thread-1): Re-using an available connection from the pool (formerly seed.civis_platform.ad_account_metrics).
2020-03-03 17:41:46,225713 (Thread-1): finished collecting timing info
2020-03-03 17:41:46,237376 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-03 17:41:46,237538 (Thread-1): On seed.civis_platform.dim_date: BEGIN
2020-03-03 17:41:46,237922 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:41:46,238030 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-03 17:41:46,238108 (Thread-1): On seed.civis_platform.dim_date: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "seed.civis_platform.dim_date"} */
truncate table "dbryan"."public"."dim_date"
2020-03-03 17:41:46,238689 (Thread-1): SQL status: TRUNCATE TABLE in 0.00 seconds
2020-03-03 17:41:46,240276 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-03 17:41:46,240394 (Thread-1): On seed.civis_platform.dim_date: 
            insert into "dbryan"."public"."dim_date" (date_id, date, dow, business_day) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
        ...
2020-03-03 17:41:46,241166 (Thread-1): SQL status: INSERT 0 7 in 0.00 seconds
2020-03-03 17:41:46,241456 (Thread-1): Writing runtime SQL for node "seed.civis_platform.dim_date"
2020-03-03 17:41:46,243983 (Thread-1): On seed.civis_platform.dim_date: COMMIT
2020-03-03 17:41:46,244152 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-03 17:41:46,244258 (Thread-1): On seed.civis_platform.dim_date: COMMIT
2020-03-03 17:41:46,245138 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:41:46,250705 (Thread-1): finished collecting timing info
2020-03-03 17:41:46,251369 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b203cb8-d469-4938-9ba0-dbf8619b23ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745d470>]}
2020-03-03 17:41:46,373622 (Thread-1): 11:41:46 | 2 of 2 OK loaded seed file public.dim_date........................... [INSERT 7 in 0.03s]
2020-03-03 17:41:46,373822 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-03 17:41:46,412334 (MainThread): Using postgres connection "master".
2020-03-03 17:41:46,412523 (MainThread): On master: BEGIN
2020-03-03 17:41:46,412947 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:41:46,413072 (MainThread): On master: COMMIT
2020-03-03 17:41:46,413161 (MainThread): Using postgres connection "master".
2020-03-03 17:41:46,413237 (MainThread): On master: COMMIT
2020-03-03 17:41:46,413475 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:41:46,413811 (MainThread): 11:41:46 | 
2020-03-03 17:41:46,413946 (MainThread): 11:41:46 | Finished running 2 seeds in 0.60s.
2020-03-03 17:41:46,414094 (MainThread): Connection 'master' was left open.
2020-03-03 17:41:46,414275 (MainThread): On master: Close
2020-03-03 17:41:46,414406 (MainThread): Connection 'seed.civis_platform.dim_date' was left open.
2020-03-03 17:41:46,414523 (MainThread): On seed.civis_platform.dim_date: Close
2020-03-03 17:41:46,420647 (MainThread): 
2020-03-03 17:41:46,421168 (MainThread): Completed successfully
2020-03-03 17:41:46,421344 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-03-03 17:41:46,421803 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744ec88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb00160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb00128>]}
2020-03-03 17:41:46,545303 (MainThread): Flushing usage events
2020-03-03 17:42:41,574140 (MainThread): Running with dbt=0.15.2
2020-03-03 17:42:41,659226 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, full_refresh=True, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', show=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2020-03-03 17:42:41,659837 (MainThread): Tracking: tracking
2020-03-03 17:42:41,666735 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd1b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd1f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd1d68>]}
2020-03-03 17:42:41,879818 (MainThread): Partial parsing not enabled
2020-03-03 17:42:41,881506 (MainThread): Parsing macros/core.sql
2020-03-03 17:42:41,885108 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 17:42:41,890620 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 17:42:41,892119 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 17:42:41,905128 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 17:42:41,919095 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 17:42:41,932312 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 17:42:41,934048 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 17:42:41,939159 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 17:42:41,944643 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 17:42:41,949489 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 17:42:41,954124 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 17:42:41,958088 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 17:42:41,959184 (MainThread): Parsing macros/etc/query.sql
2020-03-03 17:42:41,960265 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 17:42:41,961789 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 17:42:41,963581 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 17:42:41,969921 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 17:42:41,971633 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 17:42:41,993671 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 17:42:41,995568 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 17:42:41,996633 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 17:42:41,997712 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 17:42:41,999748 (MainThread): Parsing macros/catalog.sql
2020-03-03 17:42:42,1135 (MainThread): Parsing macros/relations.sql
2020-03-03 17:42:42,2989 (MainThread): Parsing macros/adapters.sql
2020-03-03 17:42:42,12451 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 17:42:42,32258 (MainThread): Partial parsing not enabled
2020-03-03 17:42:42,47067 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:42:42,47203 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:42:42,61825 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:42:42,61950 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:42:42,66938 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:42:42,67057 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:42:42,71972 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:42:42,72094 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:42:42,107689 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 17:42:42,107821 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:42:42,117866 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 17:42:42,117988 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:42:42,127040 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 17:42:42,127163 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:42:42,133362 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 17:42:42,133481 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:42:42,192029 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 17:42:42,197039 (MainThread): 
2020-03-03 17:42:42,197437 (MainThread): Acquiring new postgres connection "master".
2020-03-03 17:42:42,197535 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:42:42,278030 (MainThread): Using postgres connection "master".
2020-03-03 17:42:42,278292 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 17:42:42,285583 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 17:42:42,324619 (MainThread): Using postgres connection "master".
2020-03-03 17:42:42,324755 (MainThread): On master: BEGIN
2020-03-03 17:42:42,325167 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:42:42,325251 (MainThread): Using postgres connection "master".
2020-03-03 17:42:42,325318 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 17:42:42,329134 (MainThread): SQL status: SELECT 6 in 0.00 seconds
2020-03-03 17:42:42,365319 (MainThread): Using postgres connection "master".
2020-03-03 17:42:42,365454 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 17:42:42,376731 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 17:42:42,380205 (MainThread): On master: ROLLBACK
2020-03-03 17:42:42,380554 (MainThread): Using postgres connection "master".
2020-03-03 17:42:42,380645 (MainThread): On master: BEGIN
2020-03-03 17:42:42,381018 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:42:42,381120 (MainThread): On master: COMMIT
2020-03-03 17:42:42,381199 (MainThread): Using postgres connection "master".
2020-03-03 17:42:42,381265 (MainThread): On master: COMMIT
2020-03-03 17:42:42,381501 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:42:42,381761 (MainThread): 11:42:42 | Concurrency: 1 threads (target='dev')
2020-03-03 17:42:42,381891 (MainThread): 11:42:42 | 
2020-03-03 17:42:42,383941 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-03 17:42:42,384122 (Thread-1): 11:42:42 | 1 of 2 START seed file public.ad_account_metrics..................... [RUN]
2020-03-03 17:42:42,384424 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 17:42:42,384528 (Thread-1): Opening a new connection, currently in state init
2020-03-03 17:42:42,384649 (Thread-1): finished collecting timing info
2020-03-03 17:42:42,437036 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 17:42:42,437197 (Thread-1): On seed.civis_platform.ad_account_metrics: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "seed.civis_platform.ad_account_metrics"} */
drop table if exists "dbryan"."public"."ad_account_metrics" cascade
2020-03-03 17:42:42,444644 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-03-03 17:42:42,445833 (Thread-1): * Deprecation Warning: 
    The quote_columns parameter was not set for seeds, so the default value of
    False was chosen. The default will change to True in a future release.

    For more information, see:
    https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
    

2020-03-03 17:42:42,446502 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 17:42:42,446598 (Thread-1): On seed.civis_platform.ad_account_metrics: BEGIN
2020-03-03 17:42:42,446853 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:42:42,446940 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 17:42:42,447011 (Thread-1): On seed.civis_platform.ad_account_metrics: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "seed.civis_platform.ad_account_metrics"} */

    create table "dbryan"."public"."ad_account_metrics" (date date,impressions integer,clicks integer,spend numeric(12,2))
  
2020-03-03 17:42:42,450765 (Thread-1): SQL status: CREATE TABLE in 0.00 seconds
2020-03-03 17:42:42,452246 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 17:42:42,452355 (Thread-1): On seed.civis_platform.ad_account_metrics: 
            insert into "dbryan"."public"."ad_account_metrics" (date, impressions, clicks, spend) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
        ...
2020-03-03 17:42:42,453441 (Thread-1): SQL status: INSERT 0 7 in 0.00 seconds
2020-03-03 17:42:42,453758 (Thread-1): Writing runtime SQL for node "seed.civis_platform.ad_account_metrics"
2020-03-03 17:42:42,455412 (Thread-1): On seed.civis_platform.ad_account_metrics: COMMIT
2020-03-03 17:42:42,455577 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 17:42:42,455671 (Thread-1): On seed.civis_platform.ad_account_metrics: COMMIT
2020-03-03 17:42:42,457398 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:42:42,460140 (Thread-1): finished collecting timing info
2020-03-03 17:42:42,460783 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd220fe-6f28-4124-b22e-e173d1e7358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5ea20>]}
2020-03-03 17:42:42,587240 (Thread-1): 11:42:42 | 1 of 2 OK loaded seed file public.ad_account_metrics................. [CREATE 7 in 0.08s]
2020-03-03 17:42:42,587554 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-03 17:42:42,587925 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-03 17:42:42,588337 (Thread-1): 11:42:42 | 2 of 2 START seed file public.dim_date............................... [RUN]
2020-03-03 17:42:42,588831 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-03 17:42:42,588983 (Thread-1): Re-using an available connection from the pool (formerly seed.civis_platform.ad_account_metrics).
2020-03-03 17:42:42,589139 (Thread-1): finished collecting timing info
2020-03-03 17:42:42,599108 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-03 17:42:42,599238 (Thread-1): On seed.civis_platform.dim_date: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "seed.civis_platform.dim_date"} */
drop table if exists "dbryan"."public"."dim_date" cascade
2020-03-03 17:42:42,600662 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:42:42,602030 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-03 17:42:42,602134 (Thread-1): On seed.civis_platform.dim_date: BEGIN
2020-03-03 17:42:42,602326 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:42:42,602416 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-03 17:42:42,602489 (Thread-1): On seed.civis_platform.dim_date: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "seed.civis_platform.dim_date"} */

    create table "dbryan"."public"."dim_date" (date_id integer,date date,dow date,business_day boolean)
  
2020-03-03 17:42:42,603422 (Thread-1): SQL status: CREATE TABLE in 0.00 seconds
2020-03-03 17:42:42,604992 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-03 17:42:42,605093 (Thread-1): On seed.civis_platform.dim_date: 
            insert into "dbryan"."public"."dim_date" (date_id, date, dow, business_day) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
        ...
2020-03-03 17:42:42,605738 (Thread-1): SQL status: INSERT 0 7 in 0.00 seconds
2020-03-03 17:42:42,606001 (Thread-1): Writing runtime SQL for node "seed.civis_platform.dim_date"
2020-03-03 17:42:42,607803 (Thread-1): On seed.civis_platform.dim_date: COMMIT
2020-03-03 17:42:42,608033 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-03 17:42:42,608171 (Thread-1): On seed.civis_platform.dim_date: COMMIT
2020-03-03 17:42:42,608668 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:42:42,611450 (Thread-1): finished collecting timing info
2020-03-03 17:42:42,612008 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd220fe-6f28-4124-b22e-e173d1e7358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e65080>]}
2020-03-03 17:42:42,741198 (Thread-1): 11:42:42 | 2 of 2 OK loaded seed file public.dim_date........................... [CREATE 7 in 0.02s]
2020-03-03 17:42:42,741513 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-03 17:42:42,793861 (MainThread): Using postgres connection "master".
2020-03-03 17:42:42,794330 (MainThread): On master: BEGIN
2020-03-03 17:42:42,795142 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:42:42,795689 (MainThread): On master: COMMIT
2020-03-03 17:42:42,796067 (MainThread): Using postgres connection "master".
2020-03-03 17:42:42,796410 (MainThread): On master: COMMIT
2020-03-03 17:42:42,797392 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:42:42,798097 (MainThread): 11:42:42 | 
2020-03-03 17:42:42,798637 (MainThread): 11:42:42 | Finished running 2 seeds in 0.60s.
2020-03-03 17:42:42,798991 (MainThread): Connection 'master' was left open.
2020-03-03 17:42:42,799239 (MainThread): On master: Close
2020-03-03 17:42:42,799492 (MainThread): Connection 'seed.civis_platform.dim_date' was left open.
2020-03-03 17:42:42,799720 (MainThread): On seed.civis_platform.dim_date: Close
2020-03-03 17:42:42,807731 (MainThread): 
2020-03-03 17:42:42,808062 (MainThread): Completed successfully
2020-03-03 17:42:42,808323 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-03-03 17:42:42,808713 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5b198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dc8f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5e860>]}
2020-03-03 17:42:42,933595 (MainThread): Flushing usage events
2020-03-03 17:44:59,243919 (MainThread): Running with dbt=0.15.2
2020-03-03 17:44:59,330112 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 17:44:59,330982 (MainThread): Tracking: tracking
2020-03-03 17:44:59,338775 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ee1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ee1f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ee1ba8>]}
2020-03-03 17:44:59,551927 (MainThread): Partial parsing not enabled
2020-03-03 17:44:59,553840 (MainThread): Parsing macros/core.sql
2020-03-03 17:44:59,557260 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 17:44:59,562820 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 17:44:59,564251 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 17:44:59,576819 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 17:44:59,591008 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 17:44:59,604370 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 17:44:59,606120 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 17:44:59,611489 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 17:44:59,618089 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 17:44:59,623038 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 17:44:59,627727 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 17:44:59,631775 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 17:44:59,632788 (MainThread): Parsing macros/etc/query.sql
2020-03-03 17:44:59,634016 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 17:44:59,635545 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 17:44:59,637340 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 17:44:59,643762 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 17:44:59,645478 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 17:44:59,667931 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 17:44:59,669873 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 17:44:59,671363 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 17:44:59,673082 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 17:44:59,675078 (MainThread): Parsing macros/catalog.sql
2020-03-03 17:44:59,676492 (MainThread): Parsing macros/relations.sql
2020-03-03 17:44:59,677692 (MainThread): Parsing macros/adapters.sql
2020-03-03 17:44:59,685977 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 17:44:59,703442 (MainThread): Partial parsing not enabled
2020-03-03 17:44:59,715817 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:44:59,715981 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:44:59,730442 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:44:59,730567 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:44:59,735772 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:44:59,735897 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:44:59,740915 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:44:59,741031 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:44:59,774694 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 17:44:59,774815 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:44:59,784843 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 17:44:59,784963 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:44:59,793755 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 17:44:59,793870 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:44:59,800253 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 17:44:59,800383 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:44:59,856229 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 17:44:59,861255 (MainThread): 
2020-03-03 17:44:59,861673 (MainThread): Acquiring new postgres connection "master".
2020-03-03 17:44:59,861773 (MainThread): Opening a new connection, currently in state init
2020-03-03 17:44:59,945348 (MainThread): Using postgres connection "master".
2020-03-03 17:44:59,945506 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 17:44:59,954819 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 17:44:59,994540 (MainThread): Using postgres connection "master".
2020-03-03 17:44:59,994697 (MainThread): On master: BEGIN
2020-03-03 17:44:59,996753 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:44:59,996859 (MainThread): Using postgres connection "master".
2020-03-03 17:44:59,996933 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 17:45:00,1670 (MainThread): SQL status: SELECT 4 in 0.00 seconds
2020-03-03 17:45:00,43961 (MainThread): Using postgres connection "master".
2020-03-03 17:45:00,44105 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 17:45:00,50878 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-03-03 17:45:00,51837 (MainThread): On master: ROLLBACK
2020-03-03 17:45:00,52253 (MainThread): Using postgres connection "master".
2020-03-03 17:45:00,52501 (MainThread): On master: BEGIN
2020-03-03 17:45:00,53165 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:45:00,53486 (MainThread): On master: COMMIT
2020-03-03 17:45:00,53730 (MainThread): Using postgres connection "master".
2020-03-03 17:45:00,53934 (MainThread): On master: COMMIT
2020-03-03 17:45:00,54371 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:45:00,55047 (MainThread): 11:45:00 | Concurrency: 1 threads (target='dev')
2020-03-03 17:45:00,55373 (MainThread): 11:45:00 | 
2020-03-03 17:45:00,58777 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 17:45:00,59240 (Thread-1): 11:45:00 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 17:45:00,59980 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:45:00,60226 (Thread-1): Opening a new connection, currently in state init
2020-03-03 17:45:00,60474 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 17:45:00,75830 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 17:45:00,76426 (Thread-1): finished collecting timing info
2020-03-03 17:45:00,114732 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:45:00,114893 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-03 17:45:00,120587 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-03-03 17:45:00,122590 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:45:00,122688 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 17:45:00,123046 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:45:00,124236 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 17:45:00,124921 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:45:00,125171 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-03 17:45:00,125581 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:45:00,125721 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:45:00,125836 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    d.date,
    d.business_day,
    ad.impressions,
    ad.clicks,
    ad.spend,
    round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
    round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
    round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
from 
    "dbryan"."public"."dim_date" d
    inner join "dbryan"."public"."ad_account_metrics" ad
        on ad.date = d.date order by d.date
  );

2020-03-03 17:45:00,130026 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 17:45:00,132151 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:45:00,132281 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance__dbt_tmp" rename to "fact_daily_performance"
2020-03-03 17:45:00,132933 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:45:00,133831 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 17:45:00,133937 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:45:00,134012 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 17:45:00,134667 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:45:00,136178 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 17:45:00,136283 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 17:45:00,136509 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:45:00,138594 (Thread-1): finished collecting timing info
2020-03-03 17:45:00,139154 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4932cba5-8a84-47d0-8aef-998a27543842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103185e80>]}
2020-03-03 17:45:00,268338 (Thread-1): 11:45:00 | 1 of 4 OK created view model public.fact_daily_performance........... [CREATE VIEW in 0.08s]
2020-03-03 17:45:00,268619 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 17:45:00,268859 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 17:45:00,269078 (Thread-1): 11:45:00 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 17:45:00,269505 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:45:00,269652 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-03 17:45:00,269794 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 17:45:00,278338 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 17:45:00,279064 (Thread-1): finished collecting timing info
2020-03-03 17:45:00,298020 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:45:00,298163 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 17:45:00,298658 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:45:00,301487 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:45:00,301625 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 17:45:00,302141 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:45:00,303932 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 17:45:00,304629 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:45:00,304992 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 17:45:00,305319 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:45:00,305470 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:45:00,305600 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2020-03-03 17:45:00,307394 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 17:45:00,311824 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:45:00,311947 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 17:45:00,312429 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:45:00,314416 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:45:00,314513 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 17:45:00,315110 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:45:00,315852 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 17:45:00,315940 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:45:00,316009 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 17:45:00,316642 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:45:00,318378 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 17:45:00,318524 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 17:45:00,321262 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:45:00,323409 (Thread-1): finished collecting timing info
2020-03-03 17:45:00,324177 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4932cba5-8a84-47d0-8aef-998a27543842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d256a0>]}
2020-03-03 17:45:00,455074 (Thread-1): 11:45:00 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.05s]
2020-03-03 17:45:00,455349 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 17:45:00,455644 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 17:45:00,455890 (Thread-1): 11:45:00 | 3 of 4 START view model public.fact_monthly_performance.............. [RUN]
2020-03-03 17:45:00,456470 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:45:00,456787 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 17:45:00,456957 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 17:45:00,463836 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 17:45:00,465495 (Thread-1): finished collecting timing info
2020-03-03 17:45:00,473044 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:45:00,473320 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_tmp" cascade
2020-03-03 17:45:00,473719 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:45:00,476215 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:45:00,476412 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 17:45:00,476821 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:45:00,478507 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 17:45:00,479194 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:45:00,479381 (Thread-1): On model.civis_platform.fact_monthly_performance: BEGIN
2020-03-03 17:45:00,479648 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:45:00,479797 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:45:00,479967 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

  
  create view "dbryan"."public"."fact_monthly_performance__dbt_tmp" as (
    select
    date_trunc('month', f.date)::date as month,
    sum(impressions) as impressions,
    sum(clicks) as clicks,
    sum(spend) as spend,
    round(avg(spend)::numeric, 2) as average_daily_spend
from
    "dbryan"."public"."fact_daily_performance" f
group by 
    date_trunc('month', f.date)::date
order by
    date_trunc('month', f.date)::date
  );

2020-03-03 17:45:00,482051 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 17:45:00,484352 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:45:00,484474 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
alter table "dbryan"."public"."fact_monthly_performance__dbt_tmp" rename to "fact_monthly_performance"
2020-03-03 17:45:00,485024 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:45:00,485801 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 17:45:00,485891 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:45:00,485961 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 17:45:00,486597 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:45:00,488908 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 17:45:00,489015 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 17:45:00,489327 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 17:45:00,491478 (Thread-1): finished collecting timing info
2020-03-03 17:45:00,492199 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4932cba5-8a84-47d0-8aef-998a27543842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ff1cf8>]}
2020-03-03 17:45:00,618283 (Thread-1): 11:45:00 | 3 of 4 OK created view model public.fact_monthly_performance......... [CREATE VIEW in 0.04s]
2020-03-03 17:45:00,618559 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 17:45:00,618799 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 17:45:00,619018 (Thread-1): 11:45:00 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 17:45:00,619590 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:45:00,619733 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_monthly_performance).
2020-03-03 17:45:00,619872 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 17:45:00,627325 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 17:45:00,627860 (Thread-1): finished collecting timing info
2020-03-03 17:45:00,634475 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:45:00,634606 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 17:45:00,635048 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:45:00,636842 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:45:00,637003 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 17:45:00,637317 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:45:00,638555 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 17:45:00,639200 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:45:00,639426 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 17:45:00,639786 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:45:00,639956 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:45:00,640063 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 17:45:00,641699 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 17:45:00,644944 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:45:00,645055 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 17:45:00,645547 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:45:00,647449 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:45:00,647538 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 17:45:00,648135 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 17:45:00,648872 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 17:45:00,648962 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:45:00,649032 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 17:45:00,649502 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:45:00,650996 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 17:45:00,651084 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 17:45:00,652688 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 17:45:00,654902 (Thread-1): finished collecting timing info
2020-03-03 17:45:00,655488 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4932cba5-8a84-47d0-8aef-998a27543842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10317bac8>]}
2020-03-03 17:45:00,784994 (Thread-1): 11:45:00 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.04s]
2020-03-03 17:45:00,785276 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 17:45:00,883997 (MainThread): Using postgres connection "master".
2020-03-03 17:45:00,884343 (MainThread): On master: BEGIN
2020-03-03 17:45:00,885008 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 17:45:00,885319 (MainThread): On master: COMMIT
2020-03-03 17:45:00,885551 (MainThread): Using postgres connection "master".
2020-03-03 17:45:00,885755 (MainThread): On master: COMMIT
2020-03-03 17:45:00,886346 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 17:45:00,887033 (MainThread): 11:45:00 | 
2020-03-03 17:45:00,887389 (MainThread): 11:45:00 | Finished running 2 view models, 2 table models in 1.03s.
2020-03-03 17:45:00,887861 (MainThread): Connection 'master' was left open.
2020-03-03 17:45:00,888182 (MainThread): On master: Close
2020-03-03 17:45:00,888483 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 17:45:00,888854 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 17:45:00,902144 (MainThread): 
2020-03-03 17:45:00,902408 (MainThread): Completed successfully
2020-03-03 17:45:00,902558 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-03-03 17:45:00,902818 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103065c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103143da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103143f28>]}
2020-03-03 17:45:01,27441 (MainThread): Flushing usage events
2020-03-03 18:06:54,800584 (MainThread): Running with dbt=0.15.2
2020-03-03 18:06:54,937422 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-03-03 18:06:54,938239 (MainThread): Tracking: tracking
2020-03-03 18:06:54,947136 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9f0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9f5f8>]}
2020-03-03 18:06:55,139819 (MainThread): Partial parsing not enabled
2020-03-03 18:06:55,143297 (MainThread): Parsing macros/core.sql
2020-03-03 18:06:55,147719 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 18:06:55,153135 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 18:06:55,154920 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 18:06:55,169495 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 18:06:55,185595 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 18:06:55,205471 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 18:06:55,209424 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 18:06:55,216383 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 18:06:55,222679 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 18:06:55,228169 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 18:06:55,233281 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 18:06:55,237758 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 18:06:55,239651 (MainThread): Parsing macros/etc/query.sql
2020-03-03 18:06:55,249980 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 18:06:55,254693 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 18:06:55,258542 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 18:06:55,266272 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 18:06:55,268420 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 18:06:55,293858 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 18:06:55,296199 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 18:06:55,299108 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 18:06:55,302315 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 18:06:55,306327 (MainThread): Parsing macros/catalog.sql
2020-03-03 18:06:55,308542 (MainThread): Parsing macros/relations.sql
2020-03-03 18:06:55,310030 (MainThread): Parsing macros/adapters.sql
2020-03-03 18:06:55,319102 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 18:06:55,350339 (MainThread): Partial parsing not enabled
2020-03-03 18:06:55,365969 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 18:06:55,366107 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:06:55,383872 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 18:06:55,384186 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:06:55,392068 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 18:06:55,392207 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:06:55,397646 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 18:06:55,397773 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:06:55,433537 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 18:06:55,433669 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:06:55,443004 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 18:06:55,443123 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:06:55,453005 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 18:06:55,453133 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:06:55,459696 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 18:06:55,459824 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:06:55,469612 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 18:06:55,469738 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:06:55,475020 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a010c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a021e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a062080>]}
2020-03-03 18:06:55,606259 (MainThread): Flushing usage events
2020-03-03 18:06:55,606543 (MainThread): Connection 'test.civis_platform.not_null_fact_daily_performance_spend' was properly closed.
2020-03-03 18:06:55,606753 (MainThread): Encountered an error:
2020-03-03 18:06:55,606957 (MainThread): Compilation Error
  Invalid test config given in models/main/schema.yml:
  	test definition dictionary must have exactly one key, got [('relationships', None), ('to', "ref('dim_date')"), ('field', 'date')] instead (3 keys)
  	@: UnparsedNodeUpdate(name='fact_daily_performa...)])
2020-03-03 18:06:55,618149 (MainThread): Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/schemas.py", line 298, in parse_test
    self.parse_node(block)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/schemas.py", line 246, in parse_node
    render_ctx=render_ctx,
  File "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/typing.py", line 670, in __call__
    result = self.__origin__(*args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/schema_test_builders.py", line 178, in __init__
    test_name, test_args = self.extract_test_args(test, column_name)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/schema_test_builders.py", line 223, in extract_test_args
    ' {} instead ({} keys)'.format(test, len(test))
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  test definition dictionary must have exactly one key, got [('relationships', None), ('to', "ref('dim_date')"), ('field', 'date')] instead (3 keys)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/main.py", line 80, in main
    results, succeeded = handle_and_check(args)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/main.py", line 158, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/main.py", line 210, in run_from_args
    results = task.run()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/task/runnable.py", line 300, in run
    self._runtime_initialize()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/task/runnable.py", line 54, in _runtime_initialize
    self.load_manifest()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/task/runnable.py", line 46, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/manifest.py", line 444, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/manifest.py", line 332, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/manifest.py", line 203, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/schemas.py", line 428, in parse_file
    self.parse_yaml_models(yaml_block)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/schemas.py", line 408, in parse_yaml_models
    patch = self.parse_target_model(node_block)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/schemas.py", line 394, in parse_target_model
    refs = self.parse_tests(target_block)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/schemas.py", line 327, in parse_tests
    self.parse_column(block, column, refs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/schemas.py", line 233, in parse_column
    self.parse_test(block, test, column_name)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/parser/schemas.py", line 306, in parse_test
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid test config given in models/main/schema.yml:
  	test definition dictionary must have exactly one key, got [('relationships', None), ('to', "ref('dim_date')"), ('field', 'date')] instead (3 keys)
  	@: UnparsedNodeUpdate(name='fact_daily_performa...)])

2020-03-03 18:07:14,290925 (MainThread): Running with dbt=0.15.2
2020-03-03 18:07:14,382878 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-03-03 18:07:14,383545 (MainThread): Tracking: tracking
2020-03-03 18:07:14,390442 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e58710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e94320>]}
2020-03-03 18:07:14,552057 (MainThread): Partial parsing not enabled
2020-03-03 18:07:14,554317 (MainThread): Parsing macros/core.sql
2020-03-03 18:07:14,558567 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 18:07:14,563877 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 18:07:14,565302 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 18:07:14,577975 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 18:07:14,592327 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 18:07:14,605579 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 18:07:14,607283 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 18:07:14,612395 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 18:07:14,618009 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 18:07:14,623026 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 18:07:14,627820 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 18:07:14,631801 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 18:07:14,632780 (MainThread): Parsing macros/etc/query.sql
2020-03-03 18:07:14,633873 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 18:07:14,635460 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 18:07:14,637279 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 18:07:14,643639 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 18:07:14,645407 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 18:07:14,666728 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 18:07:14,667930 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 18:07:14,668873 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 18:07:14,670484 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 18:07:14,672455 (MainThread): Parsing macros/catalog.sql
2020-03-03 18:07:14,673890 (MainThread): Parsing macros/relations.sql
2020-03-03 18:07:14,675029 (MainThread): Parsing macros/adapters.sql
2020-03-03 18:07:14,682995 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 18:07:14,700310 (MainThread): Partial parsing not enabled
2020-03-03 18:07:14,712908 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 18:07:14,713040 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:07:14,727479 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 18:07:14,727603 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:07:14,732752 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 18:07:14,732874 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:07:14,737876 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 18:07:14,737993 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:07:14,772221 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 18:07:14,772393 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:07:14,782398 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 18:07:14,782527 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:07:14,791868 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 18:07:14,792001 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:07:14,798109 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 18:07:14,798232 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:07:14,808554 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 18:07:14,808687 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:07:14,815628 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 18:07:14,815756 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:07:14,887036 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 18:07:14,892746 (MainThread): 
2020-03-03 18:07:14,893305 (MainThread): Acquiring new postgres connection "master".
2020-03-03 18:07:14,893412 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:07:15,12697 (MainThread): Using postgres connection "master".
2020-03-03 18:07:15,12853 (MainThread): On master: BEGIN
2020-03-03 18:07:15,21737 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-03-03 18:07:15,21904 (MainThread): Using postgres connection "master".
2020-03-03 18:07:15,21999 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 18:07:15,27313 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 18:07:15,74678 (MainThread): Using postgres connection "master".
2020-03-03 18:07:15,74833 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 18:07:15,86748 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 18:07:15,90615 (MainThread): On master: ROLLBACK
2020-03-03 18:07:15,91098 (MainThread): 12:07:15 | Concurrency: 1 threads (target='dev')
2020-03-03 18:07:15,91245 (MainThread): 12:07:15 | 
2020-03-03 18:07:15,93663 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 18:07:15,93855 (Thread-1): 12:07:15 | 1 of 6 START test not_null_fact_daily_performance_spend.............. [RUN]
2020-03-03 18:07:15,94153 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 18:07:15,94236 (Thread-1): Opening a new connection, currently in state init
2020-03-03 18:07:15,94323 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 18:07:15,108083 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-03 18:07:15,109513 (Thread-1): finished collecting timing info
2020-03-03 18:07:15,110745 (Thread-1): Using postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 18:07:15,111001 (Thread-1): On test.civis_platform.not_null_fact_daily_performance_spend: BEGIN
2020-03-03 18:07:15,116621 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-03-03 18:07:15,116766 (Thread-1): Using postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 18:07:15,116845 (Thread-1): On test.civis_platform.not_null_fact_daily_performance_spend: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.not_null_fact_daily_performance_spend"} */




select count(*)
from "dbryan"."public"."fact_daily_performance"
where spend is null

2020-03-03 18:07:15,123390 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-03 18:07:15,124206 (Thread-1): finished collecting timing info
2020-03-03 18:07:15,124724 (Thread-1): On test.civis_platform.not_null_fact_daily_performance_spend: ROLLBACK
2020-03-03 18:07:15,125571 (Thread-1): 12:07:15 | 1 of 6 PASS not_null_fact_daily_performance_spend.................... [PASS in 0.03s]
2020-03-03 18:07:15,125997 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 18:07:15,126401 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 18:07:15,126893 (Thread-1): 12:07:15 | 2 of 6 START test not_null_my_first_dbt_model_id..................... [RUN]
2020-03-03 18:07:15,127517 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 18:07:15,127703 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.not_null_fact_daily_performance_spend).
2020-03-03 18:07:15,127873 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 18:07:15,137127 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-03 18:07:15,138918 (Thread-1): finished collecting timing info
2020-03-03 18:07:15,139433 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 18:07:15,139560 (Thread-1): On test.civis_platform.not_null_my_first_dbt_model_id: BEGIN
2020-03-03 18:07:15,140258 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:07:15,140495 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 18:07:15,140699 (Thread-1): On test.civis_platform.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.not_null_my_first_dbt_model_id"} */




select count(*)
from "dbryan"."public"."my_first_dbt_model"
where id is null

2020-03-03 18:07:15,141906 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:07:15,142637 (Thread-1): finished collecting timing info
2020-03-03 18:07:15,143044 (Thread-1): On test.civis_platform.not_null_my_first_dbt_model_id: ROLLBACK
2020-03-03 18:07:15,143630 (Thread-1): 12:07:15 | 2 of 6 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 0.02s]
2020-03-03 18:07:15,143795 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 18:07:15,143982 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 18:07:15,144249 (Thread-1): 12:07:15 | 3 of 6 START test not_null_my_second_dbt_model_id.................... [RUN]
2020-03-03 18:07:15,144551 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 18:07:15,144655 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.not_null_my_first_dbt_model_id).
2020-03-03 18:07:15,144737 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 18:07:15,152198 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-03 18:07:15,153438 (Thread-1): finished collecting timing info
2020-03-03 18:07:15,153865 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 18:07:15,154032 (Thread-1): On test.civis_platform.not_null_my_second_dbt_model_id: BEGIN
2020-03-03 18:07:15,154592 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:07:15,154744 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 18:07:15,154829 (Thread-1): On test.civis_platform.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.not_null_my_second_dbt_model_id"} */




select count(*)
from "dbryan"."public"."my_second_dbt_model"
where id is null

2020-03-03 18:07:15,155388 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:07:15,155656 (Thread-1): finished collecting timing info
2020-03-03 18:07:15,155978 (Thread-1): On test.civis_platform.not_null_my_second_dbt_model_id: ROLLBACK
2020-03-03 18:07:15,156474 (Thread-1): 12:07:15 | 3 of 6 PASS not_null_my_second_dbt_model_id.......................... [PASS in 0.01s]
2020-03-03 18:07:15,156645 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 18:07:15,156824 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 18:07:15,157078 (Thread-1): 12:07:15 | 4 of 6 START test relationships_fact_daily_performance_date__date__ref_dim_date_ [RUN]
2020-03-03 18:07:15,157359 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 18:07:15,157438 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.not_null_my_second_dbt_model_id).
2020-03-03 18:07:15,157514 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 18:07:15,165501 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-03 18:07:15,166200 (Thread-1): finished collecting timing info
2020-03-03 18:07:15,167155 (Thread-1): Using postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 18:07:15,167355 (Thread-1): On test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_: BEGIN
2020-03-03 18:07:15,167735 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:07:15,167883 (Thread-1): Using postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 18:07:15,168045 (Thread-1): On test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"} */





select count(*)
from (
    select date as id from "dbryan"."public"."fact_daily_performance"
) as child
left join (
    select date as id from "dbryan"."public"."dim_date"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null

2020-03-03 18:07:15,169143 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:07:15,169459 (Thread-1): finished collecting timing info
2020-03-03 18:07:15,169701 (Thread-1): On test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_: ROLLBACK
2020-03-03 18:07:15,170079 (Thread-1): 12:07:15 | 4 of 6 PASS relationships_fact_daily_performance_date__date__ref_dim_date_ [PASS in 0.01s]
2020-03-03 18:07:15,170212 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 18:07:15,170347 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 18:07:15,170526 (Thread-1): 12:07:15 | 5 of 6 START test unique_my_first_dbt_model_id....................... [RUN]
2020-03-03 18:07:15,170799 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 18:07:15,170902 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_).
2020-03-03 18:07:15,171008 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 18:07:15,179194 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-03 18:07:15,179786 (Thread-1): finished collecting timing info
2020-03-03 18:07:15,180478 (Thread-1): Using postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 18:07:15,180734 (Thread-1): On test.civis_platform.unique_my_first_dbt_model_id: BEGIN
2020-03-03 18:07:15,181282 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:07:15,181551 (Thread-1): Using postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 18:07:15,181782 (Thread-1): On test.civis_platform.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.unique_my_first_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "dbryan"."public"."my_first_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors

2020-03-03 18:07:15,183144 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:07:15,183936 (Thread-1): finished collecting timing info
2020-03-03 18:07:15,184336 (Thread-1): On test.civis_platform.unique_my_first_dbt_model_id: ROLLBACK
2020-03-03 18:07:15,184894 (Thread-1): 12:07:15 | 5 of 6 PASS unique_my_first_dbt_model_id............................. [PASS in 0.01s]
2020-03-03 18:07:15,185098 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 18:07:15,185299 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 18:07:15,185628 (Thread-1): 12:07:15 | 6 of 6 START test unique_my_second_dbt_model_id...................... [RUN]
2020-03-03 18:07:15,185942 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 18:07:15,186032 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.unique_my_first_dbt_model_id).
2020-03-03 18:07:15,186117 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 18:07:15,193953 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-03 18:07:15,195437 (Thread-1): finished collecting timing info
2020-03-03 18:07:15,196567 (Thread-1): Using postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 18:07:15,196801 (Thread-1): On test.civis_platform.unique_my_second_dbt_model_id: BEGIN
2020-03-03 18:07:15,197529 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:07:15,197858 (Thread-1): Using postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 18:07:15,198096 (Thread-1): On test.civis_platform.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.unique_my_second_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "dbryan"."public"."my_second_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors

2020-03-03 18:07:15,199348 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:07:15,199930 (Thread-1): finished collecting timing info
2020-03-03 18:07:15,200324 (Thread-1): On test.civis_platform.unique_my_second_dbt_model_id: ROLLBACK
2020-03-03 18:07:15,200928 (Thread-1): 12:07:15 | 6 of 6 PASS unique_my_second_dbt_model_id............................ [PASS in 0.02s]
2020-03-03 18:07:15,201103 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 18:07:15,300583 (MainThread): 12:07:15 | 
2020-03-03 18:07:15,300997 (MainThread): 12:07:15 | Finished running 6 tests in 0.41s.
2020-03-03 18:07:15,301314 (MainThread): Connection 'master' was left open.
2020-03-03 18:07:15,301576 (MainThread): On master: Close
2020-03-03 18:07:15,301940 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was left open.
2020-03-03 18:07:15,302248 (MainThread): On test.civis_platform.unique_my_second_dbt_model_id: Close
2020-03-03 18:07:15,323376 (MainThread): 
2020-03-03 18:07:15,323878 (MainThread): Completed with 1 error and 0 warnings:
2020-03-03 18:07:15,324308 (MainThread): 
2020-03-03 18:07:15,324598 (MainThread): Failure in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2020-03-03 18:07:15,324994 (MainThread):   Got 1 result, expected 0.
2020-03-03 18:07:15,325236 (MainThread): 
2020-03-03 18:07:15,325436 (MainThread):   compiled SQL at target/compiled/civis_platform/schema_test/not_null_my_first_dbt_model_id.sql
2020-03-03 18:07:15,325584 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2020-03-03 18:07:15,325821 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107127b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708b828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd6128>]}
2020-03-03 18:07:15,513890 (MainThread): Flushing usage events
2020-03-03 18:11:06,145991 (MainThread): Running with dbt=0.15.2
2020-03-03 18:11:06,231915 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-03-03 18:11:06,232804 (MainThread): Tracking: tracking
2020-03-03 18:11:06,240996 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e878278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e878438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e878080>]}
2020-03-03 18:11:06,459403 (MainThread): Partial parsing not enabled
2020-03-03 18:11:06,463130 (MainThread): Parsing macros/core.sql
2020-03-03 18:11:06,467133 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 18:11:06,472456 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 18:11:06,473894 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 18:11:06,486715 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 18:11:06,500907 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 18:11:06,514860 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 18:11:06,517082 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 18:11:06,522226 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 18:11:06,527892 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 18:11:06,532711 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 18:11:06,537839 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 18:11:06,542059 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 18:11:06,543121 (MainThread): Parsing macros/etc/query.sql
2020-03-03 18:11:06,544235 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 18:11:06,545839 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 18:11:06,547653 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 18:11:06,554469 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 18:11:06,556245 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 18:11:06,577739 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 18:11:06,578901 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 18:11:06,579885 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 18:11:06,581329 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 18:11:06,583475 (MainThread): Parsing macros/catalog.sql
2020-03-03 18:11:06,584918 (MainThread): Parsing macros/relations.sql
2020-03-03 18:11:06,586110 (MainThread): Parsing macros/adapters.sql
2020-03-03 18:11:06,593938 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 18:11:06,611343 (MainThread): Partial parsing not enabled
2020-03-03 18:11:06,623872 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 18:11:06,624014 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:06,639185 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 18:11:06,639313 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:06,644265 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 18:11:06,644417 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:06,649752 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 18:11:06,649874 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:06,684048 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 18:11:06,684176 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:06,694328 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 18:11:06,694463 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:06,703637 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 18:11:06,703759 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:06,709723 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 18:11:06,709841 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:06,719590 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 18:11:06,719722 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:06,726167 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 18:11:06,726287 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:06,792487 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 18:11:06,798526 (MainThread): 
2020-03-03 18:11:06,798881 (MainThread): Acquiring new postgres connection "master".
2020-03-03 18:11:06,798987 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:06,919210 (MainThread): Using postgres connection "master".
2020-03-03 18:11:06,919395 (MainThread): On master: BEGIN
2020-03-03 18:11:06,926682 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-03-03 18:11:06,926874 (MainThread): Using postgres connection "master".
2020-03-03 18:11:06,926999 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 18:11:06,931889 (MainThread): SQL status: SELECT 6 in 0.00 seconds
2020-03-03 18:11:06,979992 (MainThread): Using postgres connection "master".
2020-03-03 18:11:06,980148 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 18:11:06,991481 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 18:11:06,995155 (MainThread): On master: ROLLBACK
2020-03-03 18:11:06,995623 (MainThread): 12:11:06 | Concurrency: 1 threads (target='dev')
2020-03-03 18:11:06,995767 (MainThread): 12:11:06 | 
2020-03-03 18:11:06,998699 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 18:11:06,998885 (Thread-1): 12:11:06 | 1 of 6 START test not_null_fact_daily_performance_spend.............. [RUN]
2020-03-03 18:11:06,999200 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 18:11:06,999295 (Thread-1): Opening a new connection, currently in state init
2020-03-03 18:11:06,999384 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 18:11:07,18082 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-03 18:11:07,18941 (Thread-1): finished collecting timing info
2020-03-03 18:11:07,19509 (Thread-1): Using postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 18:11:07,19649 (Thread-1): On test.civis_platform.not_null_fact_daily_performance_spend: BEGIN
2020-03-03 18:11:07,25532 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-03-03 18:11:07,25722 (Thread-1): Using postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 18:11:07,25833 (Thread-1): On test.civis_platform.not_null_fact_daily_performance_spend: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.not_null_fact_daily_performance_spend"} */




select count(*)
from "dbryan"."public"."fact_daily_performance"
where spend is null

2020-03-03 18:11:07,28448 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:11:07,28939 (Thread-1): finished collecting timing info
2020-03-03 18:11:07,29192 (Thread-1): On test.civis_platform.not_null_fact_daily_performance_spend: ROLLBACK
2020-03-03 18:11:07,29685 (Thread-1): 12:11:07 | 1 of 6 PASS not_null_fact_daily_performance_spend.................... [PASS in 0.03s]
2020-03-03 18:11:07,29886 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 18:11:07,30078 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 18:11:07,30302 (Thread-1): 12:11:07 | 2 of 6 START test not_null_my_first_dbt_model_id..................... [RUN]
2020-03-03 18:11:07,30617 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 18:11:07,30725 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.not_null_fact_daily_performance_spend).
2020-03-03 18:11:07,30829 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 18:11:07,39306 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-03 18:11:07,40038 (Thread-1): finished collecting timing info
2020-03-03 18:11:07,40568 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 18:11:07,40730 (Thread-1): On test.civis_platform.not_null_my_first_dbt_model_id: BEGIN
2020-03-03 18:11:07,41107 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:07,41249 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 18:11:07,41334 (Thread-1): On test.civis_platform.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.not_null_my_first_dbt_model_id"} */




select count(*)
from "dbryan"."public"."my_first_dbt_model"
where id is null

2020-03-03 18:11:07,41876 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:11:07,42162 (Thread-1): finished collecting timing info
2020-03-03 18:11:07,42396 (Thread-1): On test.civis_platform.not_null_my_first_dbt_model_id: ROLLBACK
2020-03-03 18:11:07,42839 (Thread-1): 12:11:07 | 2 of 6 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 0.01s]
2020-03-03 18:11:07,42980 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 18:11:07,43240 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 18:11:07,43498 (Thread-1): 12:11:07 | 3 of 6 START test not_null_my_second_dbt_model_id.................... [RUN]
2020-03-03 18:11:07,43822 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 18:11:07,43909 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.not_null_my_first_dbt_model_id).
2020-03-03 18:11:07,43988 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 18:11:07,53008 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-03 18:11:07,54010 (Thread-1): finished collecting timing info
2020-03-03 18:11:07,54699 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 18:11:07,54901 (Thread-1): On test.civis_platform.not_null_my_second_dbt_model_id: BEGIN
2020-03-03 18:11:07,55607 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:07,55824 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 18:11:07,56023 (Thread-1): On test.civis_platform.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.not_null_my_second_dbt_model_id"} */




select count(*)
from "dbryan"."public"."my_second_dbt_model"
where id is null

2020-03-03 18:11:07,56754 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:11:07,57172 (Thread-1): finished collecting timing info
2020-03-03 18:11:07,57541 (Thread-1): On test.civis_platform.not_null_my_second_dbt_model_id: ROLLBACK
2020-03-03 18:11:07,58078 (Thread-1): 12:11:07 | 3 of 6 PASS not_null_my_second_dbt_model_id.......................... [PASS in 0.01s]
2020-03-03 18:11:07,58265 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 18:11:07,58431 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 18:11:07,58670 (Thread-1): 12:11:07 | 4 of 6 START test relationships_fact_daily_performance_date__date__ref_dim_date_ [RUN]
2020-03-03 18:11:07,59073 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 18:11:07,59195 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.not_null_my_second_dbt_model_id).
2020-03-03 18:11:07,59305 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 18:11:07,70940 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-03 18:11:07,71889 (Thread-1): finished collecting timing info
2020-03-03 18:11:07,72392 (Thread-1): Using postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 18:11:07,72535 (Thread-1): On test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_: BEGIN
2020-03-03 18:11:07,73068 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:07,73300 (Thread-1): Using postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 18:11:07,73459 (Thread-1): On test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"} */





select count(*)
from (
    select date as id from "dbryan"."public"."fact_daily_performance"
) as child
left join (
    select date as id from "dbryan"."public"."dim_date"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null

2020-03-03 18:11:07,74540 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:11:07,74914 (Thread-1): finished collecting timing info
2020-03-03 18:11:07,75278 (Thread-1): On test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_: ROLLBACK
2020-03-03 18:11:07,75799 (Thread-1): 12:11:07 | 4 of 6 PASS relationships_fact_daily_performance_date__date__ref_dim_date_ [PASS in 0.02s]
2020-03-03 18:11:07,75979 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 18:11:07,76155 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 18:11:07,76589 (Thread-1): 12:11:07 | 5 of 6 START test unique_my_first_dbt_model_id....................... [RUN]
2020-03-03 18:11:07,77198 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 18:11:07,77292 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_).
2020-03-03 18:11:07,77369 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 18:11:07,85590 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-03 18:11:07,86472 (Thread-1): finished collecting timing info
2020-03-03 18:11:07,87126 (Thread-1): Using postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 18:11:07,87340 (Thread-1): On test.civis_platform.unique_my_first_dbt_model_id: BEGIN
2020-03-03 18:11:07,87908 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:07,88097 (Thread-1): Using postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 18:11:07,88242 (Thread-1): On test.civis_platform.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.unique_my_first_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "dbryan"."public"."my_first_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors

2020-03-03 18:11:07,89212 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:11:07,89520 (Thread-1): finished collecting timing info
2020-03-03 18:11:07,89811 (Thread-1): On test.civis_platform.unique_my_first_dbt_model_id: ROLLBACK
2020-03-03 18:11:07,90279 (Thread-1): 12:11:07 | 5 of 6 PASS unique_my_first_dbt_model_id............................. [PASS in 0.01s]
2020-03-03 18:11:07,90500 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 18:11:07,90646 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 18:11:07,90923 (Thread-1): 12:11:07 | 6 of 6 START test unique_my_second_dbt_model_id...................... [RUN]
2020-03-03 18:11:07,91226 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 18:11:07,91312 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.unique_my_first_dbt_model_id).
2020-03-03 18:11:07,91392 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 18:11:07,98310 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-03 18:11:07,98861 (Thread-1): finished collecting timing info
2020-03-03 18:11:07,99438 (Thread-1): Using postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 18:11:07,99593 (Thread-1): On test.civis_platform.unique_my_second_dbt_model_id: BEGIN
2020-03-03 18:11:07,100078 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:07,100263 (Thread-1): Using postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 18:11:07,100400 (Thread-1): On test.civis_platform.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.unique_my_second_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "dbryan"."public"."my_second_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors

2020-03-03 18:11:07,100992 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:11:07,101359 (Thread-1): finished collecting timing info
2020-03-03 18:11:07,101687 (Thread-1): On test.civis_platform.unique_my_second_dbt_model_id: ROLLBACK
2020-03-03 18:11:07,102189 (Thread-1): 12:11:07 | 6 of 6 PASS unique_my_second_dbt_model_id............................ [PASS in 0.01s]
2020-03-03 18:11:07,102369 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 18:11:07,206226 (MainThread): 12:11:07 | 
2020-03-03 18:11:07,206641 (MainThread): 12:11:07 | Finished running 6 tests in 0.41s.
2020-03-03 18:11:07,206993 (MainThread): Connection 'master' was left open.
2020-03-03 18:11:07,207329 (MainThread): On master: Close
2020-03-03 18:11:07,207825 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was left open.
2020-03-03 18:11:07,208139 (MainThread): On test.civis_platform.unique_my_second_dbt_model_id: Close
2020-03-03 18:11:07,226454 (MainThread): 
2020-03-03 18:11:07,226629 (MainThread): Completed with 1 error and 0 warnings:
2020-03-03 18:11:07,226808 (MainThread): 
2020-03-03 18:11:07,227004 (MainThread): Failure in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2020-03-03 18:11:07,227177 (MainThread):   Got 1 result, expected 0.
2020-03-03 18:11:07,227367 (MainThread): 
2020-03-03 18:11:07,227547 (MainThread):   compiled SQL at target/compiled/civis_platform/schema_test/not_null_my_first_dbt_model_id.sql
2020-03-03 18:11:07,227685 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2020-03-03 18:11:07,227957 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb0cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121afb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eae4128>]}
2020-03-03 18:11:07,359859 (MainThread): Flushing usage events
2020-03-03 18:11:28,706911 (MainThread): Running with dbt=0.15.2
2020-03-03 18:11:28,786591 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 18:11:28,787165 (MainThread): Tracking: tracking
2020-03-03 18:11:28,793455 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8be278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8be128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8be1d0>]}
2020-03-03 18:11:28,961560 (MainThread): Partial parsing not enabled
2020-03-03 18:11:28,963632 (MainThread): Parsing macros/core.sql
2020-03-03 18:11:28,967186 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 18:11:28,973537 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 18:11:28,975037 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 18:11:28,987747 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 18:11:29,2947 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 18:11:29,18252 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 18:11:29,20026 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 18:11:29,27444 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 18:11:29,33761 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 18:11:29,38959 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 18:11:29,43597 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 18:11:29,47833 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 18:11:29,48875 (MainThread): Parsing macros/etc/query.sql
2020-03-03 18:11:29,50068 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 18:11:29,51684 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 18:11:29,53715 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 18:11:29,60541 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 18:11:29,62369 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 18:11:29,85211 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 18:11:29,86390 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 18:11:29,87316 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 18:11:29,88504 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 18:11:29,90421 (MainThread): Parsing macros/catalog.sql
2020-03-03 18:11:29,92076 (MainThread): Parsing macros/relations.sql
2020-03-03 18:11:29,93192 (MainThread): Parsing macros/adapters.sql
2020-03-03 18:11:29,101504 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 18:11:29,120592 (MainThread): Partial parsing not enabled
2020-03-03 18:11:29,134194 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 18:11:29,134363 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:29,149139 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 18:11:29,149273 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:29,154369 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 18:11:29,154494 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:29,160345 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 18:11:29,160475 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:29,196784 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 18:11:29,196958 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:29,207476 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 18:11:29,207613 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:29,217519 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 18:11:29,217649 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:29,223897 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 18:11:29,224023 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:29,233970 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 18:11:29,234098 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:29,240663 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 18:11:29,240784 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:29,306766 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 18:11:29,311967 (MainThread): 
2020-03-03 18:11:29,312347 (MainThread): Acquiring new postgres connection "master".
2020-03-03 18:11:29,312444 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:29,395117 (MainThread): Using postgres connection "master".
2020-03-03 18:11:29,395272 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 18:11:29,402252 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 18:11:29,444986 (MainThread): Using postgres connection "master".
2020-03-03 18:11:29,445116 (MainThread): On master: BEGIN
2020-03-03 18:11:29,445500 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:29,445596 (MainThread): Using postgres connection "master".
2020-03-03 18:11:29,445668 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 18:11:29,449624 (MainThread): SQL status: SELECT 6 in 0.00 seconds
2020-03-03 18:11:29,491248 (MainThread): Using postgres connection "master".
2020-03-03 18:11:29,491380 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 18:11:29,502434 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 18:11:29,506240 (MainThread): On master: ROLLBACK
2020-03-03 18:11:29,506587 (MainThread): Using postgres connection "master".
2020-03-03 18:11:29,506684 (MainThread): On master: BEGIN
2020-03-03 18:11:29,507164 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:29,507266 (MainThread): On master: COMMIT
2020-03-03 18:11:29,507348 (MainThread): Using postgres connection "master".
2020-03-03 18:11:29,507415 (MainThread): On master: COMMIT
2020-03-03 18:11:29,507626 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 18:11:29,507865 (MainThread): 12:11:29 | Concurrency: 1 threads (target='dev')
2020-03-03 18:11:29,507992 (MainThread): 12:11:29 | 
2020-03-03 18:11:29,509771 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 18:11:29,509954 (Thread-1): 12:11:29 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 18:11:29,510235 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 18:11:29,510332 (Thread-1): Opening a new connection, currently in state init
2020-03-03 18:11:29,510427 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 18:11:29,525250 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 18:11:29,527617 (Thread-1): finished collecting timing info
2020-03-03 18:11:29,559242 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 18:11:29,559431 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-03 18:11:29,569474 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-03-03 18:11:29,571856 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 18:11:29,571976 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 18:11:29,572346 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 18:11:29,573583 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 18:11:29,574214 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 18:11:29,574448 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-03 18:11:29,574865 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:29,575035 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 18:11:29,575149 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    d.date,
    d.business_day,
    ad.impressions,
    ad.clicks,
    ad.spend::numeric(7,0),
    round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
    round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
    round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
from 
    "dbryan"."public"."dim_date" d
    inner join "dbryan"."public"."ad_account_metrics" ad
        on ad.date = d.date order by d.date
  );

2020-03-03 18:11:29,581028 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-03-03 18:11:29,584262 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 18:11:29,584369 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance" rename to "fact_daily_performance__dbt_backup"
2020-03-03 18:11:29,585004 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 18:11:29,587121 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 18:11:29,587255 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance__dbt_tmp" rename to "fact_daily_performance"
2020-03-03 18:11:29,587995 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 18:11:29,588796 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 18:11:29,588892 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 18:11:29,588965 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 18:11:29,589663 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 18:11:29,591159 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 18:11:29,591260 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 18:11:29,593021 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 18:11:29,594997 (Thread-1): finished collecting timing info
2020-03-03 18:11:29,595613 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24741c9a-dc6e-4552-bb54-f937f2634f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb7ec18>]}
2020-03-03 18:11:29,754353 (Thread-1): 12:11:29 | 1 of 4 OK created view model public.fact_daily_performance........... [CREATE VIEW in 0.09s]
2020-03-03 18:11:29,754764 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 18:11:29,755079 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 18:11:29,755609 (Thread-1): 12:11:29 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 18:11:29,756118 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 18:11:29,756291 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-03 18:11:29,756478 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 18:11:29,763898 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 18:11:29,764577 (Thread-1): finished collecting timing info
2020-03-03 18:11:29,782468 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 18:11:29,782608 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 18:11:29,783015 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 18:11:29,784841 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 18:11:29,784936 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 18:11:29,785236 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 18:11:29,786418 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 18:11:29,787385 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 18:11:29,787567 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 18:11:29,787868 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:29,788078 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 18:11:29,788192 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

where id is not null
  );
2020-03-03 18:11:29,790471 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:11:29,793945 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 18:11:29,794079 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 18:11:29,794634 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 18:11:29,796595 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 18:11:29,796732 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 18:11:29,797456 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 18:11:29,798313 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 18:11:29,798411 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 18:11:29,798485 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 18:11:29,799161 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 18:11:29,801010 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 18:11:29,801192 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 18:11:29,804179 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 18:11:29,806875 (Thread-1): finished collecting timing info
2020-03-03 18:11:29,808004 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24741c9a-dc6e-4552-bb54-f937f2634f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11416ce10>]}
2020-03-03 18:11:29,935222 (Thread-1): 12:11:29 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 1 in 0.05s]
2020-03-03 18:11:29,935448 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 18:11:29,935667 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 18:11:29,936019 (Thread-1): 12:11:29 | 3 of 4 START view model public.fact_monthly_performance.............. [RUN]
2020-03-03 18:11:29,936370 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 18:11:29,936475 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 18:11:29,936580 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 18:11:29,943812 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 18:11:29,944439 (Thread-1): finished collecting timing info
2020-03-03 18:11:29,951322 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 18:11:29,951464 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_tmp" cascade
2020-03-03 18:11:29,951792 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 18:11:29,954447 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 18:11:29,954553 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 18:11:29,954973 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 18:11:29,956156 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 18:11:29,956740 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 18:11:29,956923 (Thread-1): On model.civis_platform.fact_monthly_performance: BEGIN
2020-03-03 18:11:29,957337 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:29,957526 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 18:11:29,957648 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

  
  create view "dbryan"."public"."fact_monthly_performance__dbt_tmp" as (
    select
    date_trunc('month', f.date)::date as month,
    sum(impressions) as impressions,
    sum(clicks) as clicks,
    sum(spend) as spend,
    round(avg(spend)::numeric, 2) as average_daily_spend
from
    "dbryan"."public"."fact_daily_performance" f
group by 
    date_trunc('month', f.date)::date
order by
    date_trunc('month', f.date)::date
  );

2020-03-03 18:11:29,959551 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 18:11:29,961800 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 18:11:29,961916 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
alter table "dbryan"."public"."fact_monthly_performance__dbt_tmp" rename to "fact_monthly_performance"
2020-03-03 18:11:29,962432 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 18:11:29,963171 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 18:11:29,963264 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 18:11:29,963335 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 18:11:29,963822 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 18:11:29,965282 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 18:11:29,965372 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 18:11:29,965693 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 18:11:29,967709 (Thread-1): finished collecting timing info
2020-03-03 18:11:29,968236 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24741c9a-dc6e-4552-bb54-f937f2634f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa87940>]}
2020-03-03 18:11:30,97716 (Thread-1): 12:11:30 | 3 of 4 OK created view model public.fact_monthly_performance......... [CREATE VIEW in 0.03s]
2020-03-03 18:11:30,98062 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 18:11:30,98423 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 18:11:30,98931 (Thread-1): 12:11:30 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 18:11:30,99458 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 18:11:30,99602 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_monthly_performance).
2020-03-03 18:11:30,99749 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 18:11:30,107569 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 18:11:30,108138 (Thread-1): finished collecting timing info
2020-03-03 18:11:30,115691 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 18:11:30,115837 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 18:11:30,116301 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 18:11:30,118370 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 18:11:30,118473 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 18:11:30,118868 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 18:11:30,120653 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 18:11:30,121222 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 18:11:30,121474 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 18:11:30,121768 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:30,121920 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 18:11:30,122076 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 18:11:30,123602 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:11:30,127188 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 18:11:30,127319 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 18:11:30,127739 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 18:11:30,129670 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 18:11:30,129764 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 18:11:30,131310 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 18:11:30,132259 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 18:11:30,132383 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 18:11:30,132462 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 18:11:30,133020 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 18:11:30,135490 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 18:11:30,135619 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 18:11:30,137022 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 18:11:30,139116 (Thread-1): finished collecting timing info
2020-03-03 18:11:30,139652 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24741c9a-dc6e-4552-bb54-f937f2634f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136d6128>]}
2020-03-03 18:11:30,265444 (Thread-1): 12:11:30 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.04s]
2020-03-03 18:11:30,265733 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 18:11:30,337618 (MainThread): Using postgres connection "master".
2020-03-03 18:11:30,338010 (MainThread): On master: BEGIN
2020-03-03 18:11:30,338652 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:30,338936 (MainThread): On master: COMMIT
2020-03-03 18:11:30,339159 (MainThread): Using postgres connection "master".
2020-03-03 18:11:30,339362 (MainThread): On master: COMMIT
2020-03-03 18:11:30,339956 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 18:11:30,340663 (MainThread): 12:11:30 | 
2020-03-03 18:11:30,341021 (MainThread): 12:11:30 | Finished running 2 view models, 2 table models in 1.03s.
2020-03-03 18:11:30,341546 (MainThread): Connection 'master' was left open.
2020-03-03 18:11:30,342057 (MainThread): On master: Close
2020-03-03 18:11:30,342421 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 18:11:30,342842 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 18:11:30,357558 (MainThread): 
2020-03-03 18:11:30,357923 (MainThread): Completed successfully
2020-03-03 18:11:30,358237 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-03-03 18:11:30,358750 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa72c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136eadd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136ea0b8>]}
2020-03-03 18:11:30,485300 (MainThread): Flushing usage events
2020-03-03 18:11:35,288096 (MainThread): Running with dbt=0.15.2
2020-03-03 18:11:35,370000 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-03-03 18:11:35,370596 (MainThread): Tracking: tracking
2020-03-03 18:11:35,377322 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f863b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf2b4a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf2b2e8>]}
2020-03-03 18:11:35,533833 (MainThread): Partial parsing not enabled
2020-03-03 18:11:35,535647 (MainThread): Parsing macros/core.sql
2020-03-03 18:11:35,539675 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 18:11:35,545003 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 18:11:35,546604 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 18:11:35,559057 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 18:11:35,573931 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 18:11:35,587591 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 18:11:35,589696 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 18:11:35,595916 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 18:11:35,602503 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 18:11:35,607986 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 18:11:35,613411 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 18:11:35,617460 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 18:11:35,618528 (MainThread): Parsing macros/etc/query.sql
2020-03-03 18:11:35,619677 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 18:11:35,621189 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 18:11:35,622962 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 18:11:35,629716 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 18:11:35,631496 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 18:11:35,653119 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 18:11:35,654471 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 18:11:35,655546 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 18:11:35,656620 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 18:11:35,658512 (MainThread): Parsing macros/catalog.sql
2020-03-03 18:11:35,659896 (MainThread): Parsing macros/relations.sql
2020-03-03 18:11:35,661009 (MainThread): Parsing macros/adapters.sql
2020-03-03 18:11:35,668876 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 18:11:35,686329 (MainThread): Partial parsing not enabled
2020-03-03 18:11:35,698776 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 18:11:35,698905 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:35,713294 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 18:11:35,713424 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:35,718399 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 18:11:35,718561 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:35,723581 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 18:11:35,723711 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:35,757844 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 18:11:35,757971 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:35,767920 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 18:11:35,768043 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:35,777626 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 18:11:35,777862 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:35,784383 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 18:11:35,784507 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:35,794811 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 18:11:35,794936 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:35,801379 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 18:11:35,801495 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:35,866334 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 18:11:35,871731 (MainThread): 
2020-03-03 18:11:35,872101 (MainThread): Acquiring new postgres connection "master".
2020-03-03 18:11:35,872193 (MainThread): Opening a new connection, currently in state init
2020-03-03 18:11:35,986316 (MainThread): Using postgres connection "master".
2020-03-03 18:11:35,986471 (MainThread): On master: BEGIN
2020-03-03 18:11:35,992130 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-03-03 18:11:35,992261 (MainThread): Using postgres connection "master".
2020-03-03 18:11:35,992337 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 18:11:35,997111 (MainThread): SQL status: SELECT 6 in 0.00 seconds
2020-03-03 18:11:36,46798 (MainThread): Using postgres connection "master".
2020-03-03 18:11:36,46937 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 18:11:36,59959 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 18:11:36,63729 (MainThread): On master: ROLLBACK
2020-03-03 18:11:36,64340 (MainThread): 12:11:36 | Concurrency: 1 threads (target='dev')
2020-03-03 18:11:36,64472 (MainThread): 12:11:36 | 
2020-03-03 18:11:36,67658 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 18:11:36,68107 (Thread-1): 12:11:36 | 1 of 6 START test not_null_fact_daily_performance_spend.............. [RUN]
2020-03-03 18:11:36,68784 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 18:11:36,68957 (Thread-1): Opening a new connection, currently in state init
2020-03-03 18:11:36,69125 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 18:11:36,84726 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-03 18:11:36,85354 (Thread-1): finished collecting timing info
2020-03-03 18:11:36,85861 (Thread-1): Using postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 18:11:36,85960 (Thread-1): On test.civis_platform.not_null_fact_daily_performance_spend: BEGIN
2020-03-03 18:11:36,91736 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-03-03 18:11:36,91873 (Thread-1): Using postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 18:11:36,91947 (Thread-1): On test.civis_platform.not_null_fact_daily_performance_spend: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.not_null_fact_daily_performance_spend"} */




select count(*)
from "dbryan"."public"."fact_daily_performance"
where spend is null

2020-03-03 18:11:36,94217 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:11:36,94510 (Thread-1): finished collecting timing info
2020-03-03 18:11:36,94738 (Thread-1): On test.civis_platform.not_null_fact_daily_performance_spend: ROLLBACK
2020-03-03 18:11:36,95207 (Thread-1): 12:11:36 | 1 of 6 PASS not_null_fact_daily_performance_spend.................... [PASS in 0.03s]
2020-03-03 18:11:36,95336 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 18:11:36,95486 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 18:11:36,95786 (Thread-1): 12:11:36 | 2 of 6 START test not_null_my_first_dbt_model_id..................... [RUN]
2020-03-03 18:11:36,96069 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 18:11:36,96155 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.not_null_fact_daily_performance_spend).
2020-03-03 18:11:36,96232 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 18:11:36,107320 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-03 18:11:36,108101 (Thread-1): finished collecting timing info
2020-03-03 18:11:36,108897 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 18:11:36,109407 (Thread-1): On test.civis_platform.not_null_my_first_dbt_model_id: BEGIN
2020-03-03 18:11:36,110167 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:36,110438 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 18:11:36,110618 (Thread-1): On test.civis_platform.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.not_null_my_first_dbt_model_id"} */




select count(*)
from "dbryan"."public"."my_first_dbt_model"
where id is null

2020-03-03 18:11:36,111455 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:11:36,111866 (Thread-1): finished collecting timing info
2020-03-03 18:11:36,112369 (Thread-1): On test.civis_platform.not_null_my_first_dbt_model_id: ROLLBACK
2020-03-03 18:11:36,113197 (Thread-1): 12:11:36 | 2 of 6 PASS not_null_my_first_dbt_model_id........................... [PASS in 0.02s]
2020-03-03 18:11:36,113449 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 18:11:36,113716 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 18:11:36,113875 (Thread-1): 12:11:36 | 3 of 6 START test not_null_my_second_dbt_model_id.................... [RUN]
2020-03-03 18:11:36,114176 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 18:11:36,114357 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.not_null_my_first_dbt_model_id).
2020-03-03 18:11:36,114471 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 18:11:36,123180 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-03 18:11:36,123919 (Thread-1): finished collecting timing info
2020-03-03 18:11:36,124405 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 18:11:36,124545 (Thread-1): On test.civis_platform.not_null_my_second_dbt_model_id: BEGIN
2020-03-03 18:11:36,124963 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:36,125105 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 18:11:36,125215 (Thread-1): On test.civis_platform.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.not_null_my_second_dbt_model_id"} */




select count(*)
from "dbryan"."public"."my_second_dbt_model"
where id is null

2020-03-03 18:11:36,125879 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:11:36,126169 (Thread-1): finished collecting timing info
2020-03-03 18:11:36,126401 (Thread-1): On test.civis_platform.not_null_my_second_dbt_model_id: ROLLBACK
2020-03-03 18:11:36,126858 (Thread-1): 12:11:36 | 3 of 6 PASS not_null_my_second_dbt_model_id.......................... [PASS in 0.01s]
2020-03-03 18:11:36,127039 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 18:11:36,127207 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 18:11:36,127451 (Thread-1): 12:11:36 | 4 of 6 START test relationships_fact_daily_performance_date__date__ref_dim_date_ [RUN]
2020-03-03 18:11:36,127735 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 18:11:36,127820 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.not_null_my_second_dbt_model_id).
2020-03-03 18:11:36,127896 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 18:11:36,135642 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-03 18:11:36,136279 (Thread-1): finished collecting timing info
2020-03-03 18:11:36,136820 (Thread-1): Using postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 18:11:36,136955 (Thread-1): On test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_: BEGIN
2020-03-03 18:11:36,137367 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:36,137504 (Thread-1): Using postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 18:11:36,137590 (Thread-1): On test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"} */





select count(*)
from (
    select date as id from "dbryan"."public"."fact_daily_performance"
) as child
left join (
    select date as id from "dbryan"."public"."dim_date"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null

2020-03-03 18:11:36,138434 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:11:36,138708 (Thread-1): finished collecting timing info
2020-03-03 18:11:36,139039 (Thread-1): On test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_: ROLLBACK
2020-03-03 18:11:36,139495 (Thread-1): 12:11:36 | 4 of 6 PASS relationships_fact_daily_performance_date__date__ref_dim_date_ [PASS in 0.01s]
2020-03-03 18:11:36,139630 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 18:11:36,139757 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 18:11:36,139915 (Thread-1): 12:11:36 | 5 of 6 START test unique_my_first_dbt_model_id....................... [RUN]
2020-03-03 18:11:36,140153 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 18:11:36,140258 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_).
2020-03-03 18:11:36,140367 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 18:11:36,147342 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-03 18:11:36,147946 (Thread-1): finished collecting timing info
2020-03-03 18:11:36,148704 (Thread-1): Using postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 18:11:36,148855 (Thread-1): On test.civis_platform.unique_my_first_dbt_model_id: BEGIN
2020-03-03 18:11:36,149343 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:36,149546 (Thread-1): Using postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 18:11:36,149692 (Thread-1): On test.civis_platform.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.unique_my_first_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "dbryan"."public"."my_first_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors

2020-03-03 18:11:36,150727 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:11:36,151032 (Thread-1): finished collecting timing info
2020-03-03 18:11:36,151264 (Thread-1): On test.civis_platform.unique_my_first_dbt_model_id: ROLLBACK
2020-03-03 18:11:36,151638 (Thread-1): 12:11:36 | 5 of 6 PASS unique_my_first_dbt_model_id............................. [PASS in 0.01s]
2020-03-03 18:11:36,151775 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 18:11:36,151905 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 18:11:36,152076 (Thread-1): 12:11:36 | 6 of 6 START test unique_my_second_dbt_model_id...................... [RUN]
2020-03-03 18:11:36,152346 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 18:11:36,152443 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.unique_my_first_dbt_model_id).
2020-03-03 18:11:36,152543 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 18:11:36,160488 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-03 18:11:36,161199 (Thread-1): finished collecting timing info
2020-03-03 18:11:36,162057 (Thread-1): Using postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 18:11:36,162285 (Thread-1): On test.civis_platform.unique_my_second_dbt_model_id: BEGIN
2020-03-03 18:11:36,162871 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 18:11:36,163053 (Thread-1): Using postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 18:11:36,163169 (Thread-1): On test.civis_platform.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.unique_my_second_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "dbryan"."public"."my_second_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors

2020-03-03 18:11:36,163706 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 18:11:36,164040 (Thread-1): finished collecting timing info
2020-03-03 18:11:36,164508 (Thread-1): On test.civis_platform.unique_my_second_dbt_model_id: ROLLBACK
2020-03-03 18:11:36,165051 (Thread-1): 12:11:36 | 6 of 6 PASS unique_my_second_dbt_model_id............................ [PASS in 0.01s]
2020-03-03 18:11:36,165342 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 18:11:36,171266 (MainThread): 12:11:36 | 
2020-03-03 18:11:36,171637 (MainThread): 12:11:36 | Finished running 6 tests in 0.30s.
2020-03-03 18:11:36,172111 (MainThread): Connection 'master' was left open.
2020-03-03 18:11:36,172409 (MainThread): On master: Close
2020-03-03 18:11:36,172716 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was left open.
2020-03-03 18:11:36,172973 (MainThread): On test.civis_platform.unique_my_second_dbt_model_id: Close
2020-03-03 18:11:36,190995 (MainThread): 
2020-03-03 18:11:36,191257 (MainThread): Completed successfully
2020-03-03 18:11:36,191395 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2020-03-03 18:11:36,191727 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0e88d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0e8ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c19b1d0>]}
2020-03-03 18:11:36,320166 (MainThread): Flushing usage events
2020-03-03 19:28:24,989138 (MainThread): Running with dbt=0.15.2
2020-03-03 19:28:25,166428 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 19:28:25,167298 (MainThread): Tracking: tracking
2020-03-03 19:28:25,182474 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd270b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd27400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd271d0>]}
2020-03-03 19:28:25,381866 (MainThread): Partial parsing not enabled
2020-03-03 19:28:25,384682 (MainThread): Parsing macros/core.sql
2020-03-03 19:28:25,388286 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 19:28:25,394257 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 19:28:25,396132 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 19:28:25,408890 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 19:28:25,423404 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 19:28:25,436975 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 19:28:25,438992 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 19:28:25,445147 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 19:28:25,451595 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 19:28:25,456972 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 19:28:25,462033 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 19:28:25,468698 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 19:28:25,469971 (MainThread): Parsing macros/etc/query.sql
2020-03-03 19:28:25,471244 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 19:28:25,473110 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 19:28:25,475179 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 19:28:25,482395 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 19:28:25,485117 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 19:28:25,508640 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 19:28:25,509964 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 19:28:25,511181 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 19:28:25,512519 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 19:28:25,514799 (MainThread): Parsing macros/catalog.sql
2020-03-03 19:28:25,516460 (MainThread): Parsing macros/relations.sql
2020-03-03 19:28:25,517836 (MainThread): Parsing macros/adapters.sql
2020-03-03 19:28:25,526335 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 19:28:25,545150 (MainThread): Partial parsing not enabled
2020-03-03 19:28:25,560963 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:28:25,561100 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:28:25,577268 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:28:25,577396 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:28:25,583715 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:28:25,583843 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:28:25,590259 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:28:25,590380 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:28:25,626770 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 19:28:25,626904 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:28:25,638102 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 19:28:25,638228 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:28:25,648389 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 19:28:25,648520 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:28:25,655703 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 19:28:25,655826 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:28:25,666962 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 19:28:25,667090 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:28:25,674528 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 19:28:25,674646 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:28:25,743312 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 19:28:25,749435 (MainThread): 
2020-03-03 19:28:25,749914 (MainThread): Acquiring new postgres connection "master".
2020-03-03 19:28:25,750016 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:28:25,832845 (MainThread): Using postgres connection "master".
2020-03-03 19:28:25,833008 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 19:28:25,843973 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 19:28:25,896299 (MainThread): Using postgres connection "master".
2020-03-03 19:28:25,896457 (MainThread): On master: BEGIN
2020-03-03 19:28:25,897318 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:28:25,897423 (MainThread): Using postgres connection "master".
2020-03-03 19:28:25,897496 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 19:28:25,906161 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 19:28:25,953279 (MainThread): Using postgres connection "master".
2020-03-03 19:28:25,953481 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 19:28:25,969740 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2020-03-03 19:28:25,973369 (MainThread): On master: ROLLBACK
2020-03-03 19:28:25,973700 (MainThread): Using postgres connection "master".
2020-03-03 19:28:25,973783 (MainThread): On master: BEGIN
2020-03-03 19:28:25,974245 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:28:25,974346 (MainThread): On master: COMMIT
2020-03-03 19:28:25,974427 (MainThread): Using postgres connection "master".
2020-03-03 19:28:25,974497 (MainThread): On master: COMMIT
2020-03-03 19:28:25,974711 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:28:25,974949 (MainThread): 13:28:25 | Concurrency: 1 threads (target='dev')
2020-03-03 19:28:25,975078 (MainThread): 13:28:25 | 
2020-03-03 19:28:25,977268 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 19:28:25,977490 (Thread-1): 13:28:25 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 19:28:25,977785 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:28:25,977876 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:28:25,977967 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 19:28:26,339 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 19:28:26,4305 (Thread-1): finished collecting timing info
2020-03-03 19:28:26,43215 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:28:26,43383 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-03 19:28:26,48656 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-03-03 19:28:26,52074 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:28:26,52236 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 19:28:26,52790 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:28:26,56311 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:28:26,56591 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-03 19:28:26,57358 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:28:26,57657 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:28:26,57886 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:28:26,96252 (Thread-1): SQL status: SELECT 1 in 0.04 seconds
2020-03-03 19:28:26,98299 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 19:28:26,99813 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:28:26,100744 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    d.date,
    d.business_day,
    ad.impressions,
    ad.clicks,
    ad.spend::numeric(7,0),
    round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
    round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
    round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
from 
    "dbryan"."public"."dim_date" d
    inner join "dbryan"."public"."ad_account_metrics" ad
        on ad.date = d.date order by d.date
  );

2020-03-03 19:28:26,104442 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 19:28:26,108392 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:28:26,108536 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance" rename to "fact_daily_performance__dbt_backup"
2020-03-03 19:28:26,109098 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:28:26,111107 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:28:26,111217 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance__dbt_tmp" rename to "fact_daily_performance"
2020-03-03 19:28:26,111796 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:28:26,113168 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:28:26,113266 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:28:26,117309 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:28:26,118165 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 19:28:26,118320 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:28:26,118458 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 19:28:26,119142 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:28:26,121466 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:28:26,121590 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 19:28:26,124673 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:28:26,126995 (Thread-1): finished collecting timing info
2020-03-03 19:28:26,127605 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b740964-7d73-4c5b-bbe5-fa05d1c0eab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a160630>]}
2020-03-03 19:28:26,267689 (Thread-1): 13:28:26 | 1 of 4 OK created view model public.fact_daily_performance........... [CREATE VIEW in 0.15s]
2020-03-03 19:28:26,268007 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 19:28:26,268242 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 19:28:26,268465 (Thread-1): 13:28:26 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 19:28:26,268853 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:28:26,269009 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-03 19:28:26,269172 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 19:28:26,277844 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 19:28:26,278497 (Thread-1): finished collecting timing info
2020-03-03 19:28:26,296585 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:28:26,296725 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 19:28:26,297101 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:28:26,298927 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:28:26,299020 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 19:28:26,299436 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:28:26,300792 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:28:26,300887 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 19:28:26,301128 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:28:26,301211 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:28:26,301279 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:28:26,306105 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:28:26,307251 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 19:28:26,307724 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:28:26,307885 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
2020-03-03 19:28:26,309655 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 19:28:26,313317 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:28:26,313444 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 19:28:26,314009 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:28:26,316342 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:28:26,316530 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 19:28:26,317589 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:28:26,319178 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:28:26,319324 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:28:26,319886 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:28:26,320664 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 19:28:26,320780 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:28:26,320856 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 19:28:26,322737 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:28:26,324732 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:28:26,324857 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 19:28:26,327624 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:28:26,329927 (Thread-1): finished collecting timing info
2020-03-03 19:28:26,330525 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b740964-7d73-4c5b-bbe5-fa05d1c0eab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8a9f60>]}
2020-03-03 19:28:26,458182 (Thread-1): 13:28:26 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.06s]
2020-03-03 19:28:26,458475 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 19:28:26,458731 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 19:28:26,458963 (Thread-1): 13:28:26 | 3 of 4 START view model public.fact_monthly_performance.............. [RUN]
2020-03-03 19:28:26,459395 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:28:26,459542 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 19:28:26,459689 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 19:28:26,468363 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 19:28:26,472224 (Thread-1): finished collecting timing info
2020-03-03 19:28:26,479806 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:28:26,479955 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_tmp" cascade
2020-03-03 19:28:26,480269 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:28:26,482527 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:28:26,482749 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 19:28:26,483153 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:28:26,484437 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:28:26,484533 (Thread-1): On model.civis_platform.fact_monthly_performance: BEGIN
2020-03-03 19:28:26,484763 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:28:26,484845 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:28:26,484911 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:28:26,488063 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:28:26,489316 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 19:28:26,489840 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:28:26,489992 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

  
  create view "dbryan"."public"."fact_monthly_performance__dbt_tmp" as (
    select
    date_trunc('month', f.date)::date as month,
    sum(impressions) as impressions,
    sum(clicks) as clicks,
    sum(spend) as spend,
    round(avg(spend)::numeric, 2) as average_daily_spend
from
    "dbryan"."public"."fact_daily_performance" f
group by 
    date_trunc('month', f.date)::date
order by
    date_trunc('month', f.date)::date
  );

2020-03-03 19:28:26,492153 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 19:28:26,495805 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:28:26,495962 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
alter table "dbryan"."public"."fact_monthly_performance__dbt_tmp" rename to "fact_monthly_performance"
2020-03-03 19:28:26,496663 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:28:26,499077 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:28:26,499288 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:28:26,499993 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:28:26,501359 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 19:28:26,501528 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:28:26,501620 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 19:28:26,503082 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:28:26,504812 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:28:26,504928 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 19:28:26,505411 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:28:26,507522 (Thread-1): finished collecting timing info
2020-03-03 19:28:26,508198 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b740964-7d73-4c5b-bbe5-fa05d1c0eab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ed390>]}
2020-03-03 19:28:26,636047 (Thread-1): 13:28:26 | 3 of 4 OK created view model public.fact_monthly_performance......... [CREATE VIEW in 0.05s]
2020-03-03 19:28:26,636391 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 19:28:26,636887 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 19:28:26,637268 (Thread-1): 13:28:26 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 19:28:26,637754 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:28:26,637863 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_monthly_performance).
2020-03-03 19:28:26,637971 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 19:28:26,646859 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 19:28:26,649409 (Thread-1): finished collecting timing info
2020-03-03 19:28:26,657125 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:28:26,657278 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 19:28:26,657751 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:28:26,659883 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:28:26,660005 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 19:28:26,660327 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:28:26,663120 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:28:26,663254 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 19:28:26,663480 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:28:26,663571 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:28:26,663642 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:28:26,666820 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:28:26,667948 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 19:28:26,668467 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:28:26,668566 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 19:28:26,670356 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:28:26,674157 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:28:26,674293 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 19:28:26,674703 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:28:26,676878 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:28:26,676998 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 19:28:26,677689 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:28:26,678949 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:28:26,679048 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:28:26,679389 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:28:26,680389 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 19:28:26,680558 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:28:26,680680 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 19:28:26,682377 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:28:26,685795 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:28:26,685944 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 19:28:26,687332 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:28:26,690545 (Thread-1): finished collecting timing info
2020-03-03 19:28:26,691333 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b740964-7d73-4c5b-bbe5-fa05d1c0eab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8af4e0>]}
2020-03-03 19:28:26,819778 (Thread-1): 13:28:26 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.05s]
2020-03-03 19:28:26,820060 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 19:28:26,908968 (MainThread): Using postgres connection "master".
2020-03-03 19:28:26,909478 (MainThread): On master: BEGIN
2020-03-03 19:28:26,910455 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:28:26,910894 (MainThread): On master: COMMIT
2020-03-03 19:28:26,911260 (MainThread): Using postgres connection "master".
2020-03-03 19:28:26,911583 (MainThread): On master: COMMIT
2020-03-03 19:28:26,912171 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:28:26,912812 (MainThread): 13:28:26 | 
2020-03-03 19:28:26,913038 (MainThread): 13:28:26 | Finished running 2 view models, 2 table models in 1.16s.
2020-03-03 19:28:26,913282 (MainThread): Connection 'master' was left open.
2020-03-03 19:28:26,913500 (MainThread): On master: Close
2020-03-03 19:28:26,913677 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 19:28:26,913816 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 19:28:26,926948 (MainThread): 
2020-03-03 19:28:26,927187 (MainThread): Completed successfully
2020-03-03 19:28:26,927437 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-03-03 19:28:26,927728 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e9710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e9c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e9ef0>]}
2020-03-03 19:28:27,51050 (MainThread): Flushing usage events
2020-03-03 19:37:27,464946 (MainThread): Running with dbt=0.15.2
2020-03-03 19:37:27,565800 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 19:37:27,566354 (MainThread): Tracking: tracking
2020-03-03 19:37:27,581324 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0f59b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0f5860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967b1d0>]}
2020-03-03 19:37:27,819968 (MainThread): Partial parsing not enabled
2020-03-03 19:37:27,823553 (MainThread): Parsing macros/core.sql
2020-03-03 19:37:27,827434 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 19:37:27,833281 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 19:37:27,835178 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 19:37:27,848746 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 19:37:27,865844 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 19:37:27,879481 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 19:37:27,881384 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 19:37:27,887138 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 19:37:27,893595 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 19:37:27,898682 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 19:37:27,903871 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 19:37:27,908209 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 19:37:27,909361 (MainThread): Parsing macros/etc/query.sql
2020-03-03 19:37:27,910637 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 19:37:27,912329 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 19:37:27,914288 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 19:37:27,920818 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 19:37:27,922720 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 19:37:27,944139 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 19:37:27,945471 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 19:37:27,946619 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 19:37:27,947912 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 19:37:27,950269 (MainThread): Parsing macros/catalog.sql
2020-03-03 19:37:27,952128 (MainThread): Parsing macros/relations.sql
2020-03-03 19:37:27,953421 (MainThread): Parsing macros/adapters.sql
2020-03-03 19:37:27,962192 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 19:37:27,984247 (MainThread): Partial parsing not enabled
2020-03-03 19:37:28,2440 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:37:28,2639 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:37:28,22339 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:37:28,22484 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:37:28,29526 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:37:28,29656 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:37:28,36250 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:37:28,36385 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:37:28,76995 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 19:37:28,77145 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:37:28,91395 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 19:37:28,91526 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:37:28,102785 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 19:37:28,102924 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:37:28,110304 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 19:37:28,110428 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:37:28,122093 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 19:37:28,122224 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:37:28,131847 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 19:37:28,131991 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:37:28,147359 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.civis_platform.main.events

2020-03-03 19:37:28,205331 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 19:37:28,211668 (MainThread): 
2020-03-03 19:37:28,212084 (MainThread): Acquiring new postgres connection "master".
2020-03-03 19:37:28,212179 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:37:28,294780 (MainThread): Using postgres connection "master".
2020-03-03 19:37:28,294943 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 19:37:28,307563 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 19:37:28,357022 (MainThread): Using postgres connection "master".
2020-03-03 19:37:28,357215 (MainThread): On master: BEGIN
2020-03-03 19:37:28,359575 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:37:28,359900 (MainThread): Using postgres connection "master".
2020-03-03 19:37:28,360131 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 19:37:28,367224 (MainThread): SQL status: SELECT 7 in 0.01 seconds
2020-03-03 19:37:28,426845 (MainThread): Using postgres connection "master".
2020-03-03 19:37:28,427029 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 19:37:28,444420 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2020-03-03 19:37:28,448385 (MainThread): On master: ROLLBACK
2020-03-03 19:37:28,448915 (MainThread): Using postgres connection "master".
2020-03-03 19:37:28,449017 (MainThread): On master: BEGIN
2020-03-03 19:37:28,449267 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:37:28,449382 (MainThread): On master: COMMIT
2020-03-03 19:37:28,449467 (MainThread): Using postgres connection "master".
2020-03-03 19:37:28,449539 (MainThread): On master: COMMIT
2020-03-03 19:37:28,449754 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:37:28,450060 (MainThread): 13:37:28 | Concurrency: 1 threads (target='dev')
2020-03-03 19:37:28,450184 (MainThread): 13:37:28 | 
2020-03-03 19:37:28,452637 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 19:37:28,453101 (Thread-1): 13:37:28 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 19:37:28,453704 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:37:28,453816 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:37:28,453933 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 19:37:28,472393 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 19:37:28,474302 (Thread-1): finished collecting timing info
2020-03-03 19:37:28,507683 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:37:28,507838 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-03 19:37:28,513419 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-03-03 19:37:28,515899 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:37:28,516022 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 19:37:28,516408 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:37:28,517619 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:37:28,517709 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-03 19:37:28,518052 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:37:28,518144 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:37:28,518213 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:37:28,527461 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-03 19:37:28,529058 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 19:37:28,529602 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:37:28,529791 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    d.date,
    d.business_day,
    ad.impressions,
    ad.clicks,
    ad.spend::numeric(7,0),
    round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
    round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
    round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
from 
    "dbryan"."public"."dim_date" d
    inner join "dbryan"."public"."ad_account_metrics" ad
        on ad.date = d.date order by d.date
  );

2020-03-03 19:37:28,533600 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 19:37:28,537281 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:37:28,537406 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance" rename to "fact_daily_performance__dbt_backup"
2020-03-03 19:37:28,537938 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:37:28,539905 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:37:28,539997 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance__dbt_tmp" rename to "fact_daily_performance"
2020-03-03 19:37:28,540475 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:37:28,541754 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:37:28,541844 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:37:28,542507 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:37:28,543543 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 19:37:28,543708 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:37:28,543849 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 19:37:28,546650 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:37:28,548998 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:37:28,549124 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 19:37:28,550901 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:37:28,553132 (Thread-1): finished collecting timing info
2020-03-03 19:37:28,553728 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc29a9df-2835-4755-8041-465f5176ffa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ad3c8>]}
2020-03-03 19:37:28,685556 (Thread-1): 13:37:28 | 1 of 4 OK created view model public.fact_daily_performance........... [CREATE VIEW in 0.10s]
2020-03-03 19:37:28,685833 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 19:37:28,686072 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 19:37:28,686292 (Thread-1): 13:37:28 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 19:37:28,686923 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:37:28,687265 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-03 19:37:28,687448 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 19:37:28,695247 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 19:37:28,695800 (Thread-1): finished collecting timing info
2020-03-03 19:37:28,713709 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:37:28,713841 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 19:37:28,714244 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:37:28,716064 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:37:28,716156 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 19:37:28,716454 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:37:28,717798 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:37:28,717890 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 19:37:28,718139 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:37:28,718232 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:37:28,718301 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:37:28,721773 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:37:28,722900 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 19:37:28,723373 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:37:28,723780 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
2020-03-03 19:37:28,725455 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 19:37:28,729005 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:37:28,729124 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 19:37:28,729663 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:37:28,731775 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:37:28,731871 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 19:37:28,732580 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:37:28,734026 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:37:28,734162 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:37:28,734690 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:37:28,736021 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 19:37:28,736170 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:37:28,736280 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 19:37:28,738116 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:37:28,740565 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:37:28,740836 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 19:37:28,742851 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:37:28,744936 (Thread-1): finished collecting timing info
2020-03-03 19:37:28,745471 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc29a9df-2835-4755-8041-465f5176ffa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfd7048>]}
2020-03-03 19:37:28,875186 (Thread-1): 13:37:28 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.06s]
2020-03-03 19:37:28,875461 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 19:37:28,875755 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 19:37:28,876255 (Thread-1): 13:37:28 | 3 of 4 START view model public.fact_monthly_performance.............. [RUN]
2020-03-03 19:37:28,876781 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:37:28,876936 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 19:37:28,877083 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 19:37:28,885409 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 19:37:28,888146 (Thread-1): finished collecting timing info
2020-03-03 19:37:28,895318 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:37:28,895454 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_tmp" cascade
2020-03-03 19:37:28,895786 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:37:28,897931 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:37:28,898047 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 19:37:28,898328 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:37:28,899678 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:37:28,899815 (Thread-1): On model.civis_platform.fact_monthly_performance: BEGIN
2020-03-03 19:37:28,900043 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:37:28,900160 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:37:28,900238 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:37:28,905251 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:37:28,906532 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 19:37:28,907251 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:37:28,907429 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

  
  create view "dbryan"."public"."fact_monthly_performance__dbt_tmp" as (
    select
    date_trunc('month', f.date)::date as month,
    sum(impressions) as impressions,
    sum(clicks) as clicks,
    sum(spend) as spend,
    round(avg(spend)::numeric, 2) as average_daily_spend
from
    "dbryan"."public"."fact_daily_performance" f
group by 
    date_trunc('month', f.date)::date
order by
    date_trunc('month', f.date)::date
  );

2020-03-03 19:37:28,909325 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 19:37:28,911878 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:37:28,912054 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
alter table "dbryan"."public"."fact_monthly_performance__dbt_tmp" rename to "fact_monthly_performance"
2020-03-03 19:37:28,912750 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:37:28,914782 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:37:28,914956 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:37:28,915567 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:37:28,916546 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 19:37:28,916693 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:37:28,916770 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 19:37:28,918124 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:37:28,919654 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:37:28,919749 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 19:37:28,920239 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:37:28,922346 (Thread-1): finished collecting timing info
2020-03-03 19:37:28,922876 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc29a9df-2835-4755-8041-465f5176ffa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109825780>]}
2020-03-03 19:37:29,50007 (Thread-1): 13:37:29 | 3 of 4 OK created view model public.fact_monthly_performance......... [CREATE VIEW in 0.05s]
2020-03-03 19:37:29,50290 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 19:37:29,50570 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 19:37:29,50969 (Thread-1): 13:37:29 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 19:37:29,51492 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:37:29,51601 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_monthly_performance).
2020-03-03 19:37:29,51707 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 19:37:29,60401 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 19:37:29,60976 (Thread-1): finished collecting timing info
2020-03-03 19:37:29,69317 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:37:29,70897 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 19:37:29,71467 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:37:29,73759 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:37:29,73885 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 19:37:29,74224 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:37:29,76700 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:37:29,76822 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 19:37:29,77089 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:37:29,77183 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:37:29,77252 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:37:29,82052 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:37:29,83188 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 19:37:29,83934 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:37:29,84155 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 19:37:29,86057 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:37:29,91926 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:37:29,92067 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 19:37:29,92626 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:37:29,96440 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:37:29,96584 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 19:37:29,97713 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:37:29,99426 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:37:29,99561 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:37:29,100185 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:37:29,101057 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 19:37:29,101185 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:37:29,101267 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 19:37:29,102873 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:37:29,104550 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:37:29,104644 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 19:37:29,105990 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:37:29,108175 (Thread-1): finished collecting timing info
2020-03-03 19:37:29,108867 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc29a9df-2835-4755-8041-465f5176ffa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d56a080>]}
2020-03-03 19:37:29,238965 (Thread-1): 13:37:29 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.06s]
2020-03-03 19:37:29,239260 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 19:37:29,275166 (MainThread): Using postgres connection "master".
2020-03-03 19:37:29,275515 (MainThread): On master: BEGIN
2020-03-03 19:37:29,276212 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:37:29,276506 (MainThread): On master: COMMIT
2020-03-03 19:37:29,276724 (MainThread): Using postgres connection "master".
2020-03-03 19:37:29,276920 (MainThread): On master: COMMIT
2020-03-03 19:37:29,277602 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:37:29,278279 (MainThread): 13:37:29 | 
2020-03-03 19:37:29,278485 (MainThread): 13:37:29 | Finished running 2 view models, 2 table models in 1.07s.
2020-03-03 19:37:29,278684 (MainThread): Connection 'master' was left open.
2020-03-03 19:37:29,278858 (MainThread): On master: Close
2020-03-03 19:37:29,279135 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 19:37:29,279366 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 19:37:29,294109 (MainThread): 
2020-03-03 19:37:29,294431 (MainThread): Completed successfully
2020-03-03 19:37:29,295237 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-03-03 19:37:29,295952 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d57b518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098bf4a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098bfe48>]}
2020-03-03 19:37:29,427436 (MainThread): Flushing usage events
2020-03-03 19:38:51,986848 (MainThread): Running with dbt=0.15.2
2020-03-03 19:38:52,69625 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 19:38:52,70190 (MainThread): Tracking: tracking
2020-03-03 19:38:52,77618 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8dbf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8dbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8db9b0>]}
2020-03-03 19:38:52,343643 (MainThread): Partial parsing not enabled
2020-03-03 19:38:52,345989 (MainThread): Parsing macros/core.sql
2020-03-03 19:38:52,349314 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 19:38:52,354685 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 19:38:52,356167 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 19:38:52,368571 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 19:38:52,382742 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 19:38:52,396082 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 19:38:52,397801 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 19:38:52,403518 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 19:38:52,409135 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 19:38:52,414190 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 19:38:52,419074 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 19:38:52,423082 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 19:38:52,424158 (MainThread): Parsing macros/etc/query.sql
2020-03-03 19:38:52,425258 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 19:38:52,426795 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 19:38:52,428565 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 19:38:52,435051 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 19:38:52,436879 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 19:38:52,459120 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 19:38:52,460404 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 19:38:52,461562 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 19:38:52,462699 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 19:38:52,464718 (MainThread): Parsing macros/catalog.sql
2020-03-03 19:38:52,466127 (MainThread): Parsing macros/relations.sql
2020-03-03 19:38:52,467605 (MainThread): Parsing macros/adapters.sql
2020-03-03 19:38:52,475898 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 19:38:52,494867 (MainThread): Partial parsing not enabled
2020-03-03 19:38:52,512964 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:38:52,513122 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:38:52,531792 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:38:52,531929 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:38:52,538630 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:38:52,538769 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:38:52,546380 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:38:52,546518 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:38:52,584321 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 19:38:52,584505 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:38:52,600030 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 19:38:52,600186 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:38:52,610518 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 19:38:52,610650 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:38:52,618099 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 19:38:52,618229 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:38:52,629148 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 19:38:52,629271 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:38:52,636941 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 19:38:52,637072 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:38:52,704410 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 19:38:52,710728 (MainThread): 
2020-03-03 19:38:52,711064 (MainThread): Acquiring new postgres connection "master".
2020-03-03 19:38:52,711167 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:38:52,792766 (MainThread): Using postgres connection "master".
2020-03-03 19:38:52,793026 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 19:38:52,805555 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 19:38:52,848003 (MainThread): Using postgres connection "master".
2020-03-03 19:38:52,848135 (MainThread): On master: BEGIN
2020-03-03 19:38:52,848516 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:38:52,848612 (MainThread): Using postgres connection "master".
2020-03-03 19:38:52,848684 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 19:38:52,852372 (MainThread): SQL status: SELECT 7 in 0.00 seconds
2020-03-03 19:38:52,894138 (MainThread): Using postgres connection "master".
2020-03-03 19:38:52,894267 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 19:38:52,908094 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 19:38:52,911564 (MainThread): On master: ROLLBACK
2020-03-03 19:38:52,911876 (MainThread): Using postgres connection "master".
2020-03-03 19:38:52,911970 (MainThread): On master: BEGIN
2020-03-03 19:38:52,912341 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:38:52,912432 (MainThread): On master: COMMIT
2020-03-03 19:38:52,912507 (MainThread): Using postgres connection "master".
2020-03-03 19:38:52,912574 (MainThread): On master: COMMIT
2020-03-03 19:38:52,912768 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:38:52,913020 (MainThread): 13:38:52 | Concurrency: 1 threads (target='dev')
2020-03-03 19:38:52,913150 (MainThread): 13:38:52 | 
2020-03-03 19:38:52,915038 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 19:38:52,915219 (Thread-1): 13:38:52 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 19:38:52,915560 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:38:52,915656 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:38:52,915746 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 19:38:52,930536 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 19:38:52,933157 (Thread-1): finished collecting timing info
2020-03-03 19:38:52,964392 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:38:52,964569 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-03 19:38:52,970822 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-03-03 19:38:52,973161 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:38:52,973281 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 19:38:52,973551 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:38:52,974773 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:38:52,974866 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-03 19:38:52,975093 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:38:52,975177 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:38:52,975247 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:38:52,981043 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-03 19:38:52,982464 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 19:38:52,983120 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:38:52,983356 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    d.date,
    d.business_day,
    ad.impressions,
    ad.clicks,
    ad.spend::numeric(7,0),
    round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
    round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
    round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
from 
    "dbryan"."public"."dim_date" d
    inner join "dbryan"."public"."ad_account_metrics" ad
        on ad.date = d.date order by d.date
  );

2020-03-03 19:38:52,986424 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 19:38:52,989870 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:38:52,989987 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance" rename to "fact_daily_performance__dbt_backup"
2020-03-03 19:38:52,990502 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:38:52,992389 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:38:52,992480 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance__dbt_tmp" rename to "fact_daily_performance"
2020-03-03 19:38:52,993013 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:38:52,994304 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:38:52,994398 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:38:52,995084 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:38:52,996369 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 19:38:52,996486 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:38:52,996565 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 19:38:52,998318 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:38:53,523 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:38:53,640 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 19:38:53,2440 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:38:53,4674 (Thread-1): finished collecting timing info
2020-03-03 19:38:53,5309 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53d36699-9591-48f0-9a63-0d75b3f29901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb08358>]}
2020-03-03 19:38:53,135074 (Thread-1): 13:38:53 | 1 of 4 OK created view model public.fact_daily_performance........... [CREATE VIEW in 0.09s]
2020-03-03 19:38:53,135415 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 19:38:53,135680 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 19:38:53,136053 (Thread-1): 13:38:53 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 19:38:53,136577 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:38:53,136889 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-03 19:38:53,137112 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 19:38:53,144554 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 19:38:53,145108 (Thread-1): finished collecting timing info
2020-03-03 19:38:53,162716 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:38:53,162853 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 19:38:53,163233 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:38:53,165068 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:38:53,165160 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 19:38:53,165488 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:38:53,166985 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:38:53,167107 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 19:38:53,167385 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:38:53,167482 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:38:53,167556 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:38:53,171584 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:38:53,172719 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 19:38:53,173639 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:38:53,173852 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
2020-03-03 19:38:53,175695 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 19:38:53,179394 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:38:53,179519 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 19:38:53,180027 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:38:53,182135 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:38:53,182233 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 19:38:53,182855 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:38:53,184450 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:38:53,184627 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:38:53,185191 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:38:53,186447 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 19:38:53,186601 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:38:53,186724 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 19:38:53,188751 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:38:53,190370 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:38:53,190492 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 19:38:53,192225 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:38:53,194848 (Thread-1): finished collecting timing info
2020-03-03 19:38:53,195591 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53d36699-9591-48f0-9a63-0d75b3f29901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba95908>]}
2020-03-03 19:38:53,334411 (Thread-1): 13:38:53 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.06s]
2020-03-03 19:38:53,334694 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 19:38:53,334940 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 19:38:53,335168 (Thread-1): 13:38:53 | 3 of 4 START view model public.fact_monthly_performance.............. [RUN]
2020-03-03 19:38:53,335599 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:38:53,335743 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 19:38:53,335939 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 19:38:53,345341 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 19:38:53,345951 (Thread-1): finished collecting timing info
2020-03-03 19:38:53,353586 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:38:53,353729 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_tmp" cascade
2020-03-03 19:38:53,354138 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:38:53,356496 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:38:53,356638 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 19:38:53,356931 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:38:53,358336 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:38:53,358463 (Thread-1): On model.civis_platform.fact_monthly_performance: BEGIN
2020-03-03 19:38:53,358791 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:38:53,359013 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:38:53,359099 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:38:53,363238 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:38:53,364637 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 19:38:53,365296 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:38:53,365545 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

  
  create view "dbryan"."public"."fact_monthly_performance__dbt_tmp" as (
    select
    date_trunc('month', f.date)::date as month,
    sum(impressions) as impressions,
    sum(clicks) as clicks,
    sum(spend) as spend,
    round(avg(spend)::numeric, 2) as average_daily_spend
from
    "dbryan"."public"."fact_daily_performance" f
group by 
    date_trunc('month', f.date)::date
order by
    date_trunc('month', f.date)::date
  );

2020-03-03 19:38:53,368115 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 19:38:53,370710 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:38:53,370842 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
alter table "dbryan"."public"."fact_monthly_performance__dbt_tmp" rename to "fact_monthly_performance"
2020-03-03 19:38:53,371427 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:38:53,372729 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:38:53,372844 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:38:53,373354 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:38:53,374014 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 19:38:53,374103 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:38:53,374175 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 19:38:53,375880 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:38:53,377372 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:38:53,377464 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 19:38:53,377946 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:38:53,380032 (Thread-1): finished collecting timing info
2020-03-03 19:38:53,380562 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53d36699-9591-48f0-9a63-0d75b3f29901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb085f8>]}
2020-03-03 19:38:53,523419 (Thread-1): 13:38:53 | 3 of 4 OK created view model public.fact_monthly_performance......... [CREATE VIEW in 0.05s]
2020-03-03 19:38:53,523741 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 19:38:53,524075 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 19:38:53,524313 (Thread-1): 13:38:53 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 19:38:53,524762 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:38:53,524908 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_monthly_performance).
2020-03-03 19:38:53,525055 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 19:38:53,532953 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 19:38:53,535287 (Thread-1): finished collecting timing info
2020-03-03 19:38:53,542768 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:38:53,542904 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 19:38:53,543326 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:38:53,545586 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:38:53,545718 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 19:38:53,546174 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:38:53,548635 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:38:53,548760 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 19:38:53,548982 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:38:53,549123 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:38:53,549229 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:38:53,556091 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-03 19:38:53,557427 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 19:38:53,558044 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:38:53,558383 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 19:38:53,560332 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:38:53,565844 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:38:53,566042 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 19:38:53,566665 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:38:53,569443 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:38:53,569572 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 19:38:53,570236 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:38:53,571627 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:38:53,571751 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:38:53,572176 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:38:53,572782 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 19:38:53,572869 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:38:53,572941 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 19:38:53,574544 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:38:53,576221 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:38:53,576316 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 19:38:53,578084 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:38:53,580133 (Thread-1): finished collecting timing info
2020-03-03 19:38:53,580670 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53d36699-9591-48f0-9a63-0d75b3f29901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f60a860>]}
2020-03-03 19:38:53,764818 (Thread-1): 13:38:53 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.06s]
2020-03-03 19:38:53,765094 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 19:38:53,844022 (MainThread): Using postgres connection "master".
2020-03-03 19:38:53,844373 (MainThread): On master: BEGIN
2020-03-03 19:38:53,845146 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:38:53,845461 (MainThread): On master: COMMIT
2020-03-03 19:38:53,845695 (MainThread): Using postgres connection "master".
2020-03-03 19:38:53,845902 (MainThread): On master: COMMIT
2020-03-03 19:38:53,846495 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:38:53,847186 (MainThread): 13:38:53 | 
2020-03-03 19:38:53,847538 (MainThread): 13:38:53 | Finished running 2 view models, 2 table models in 1.14s.
2020-03-03 19:38:53,847992 (MainThread): Connection 'master' was left open.
2020-03-03 19:38:53,848298 (MainThread): On master: Close
2020-03-03 19:38:53,848613 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 19:38:53,848966 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 19:38:53,862918 (MainThread): 
2020-03-03 19:38:53,863235 (MainThread): Completed successfully
2020-03-03 19:38:53,863445 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-03-03 19:38:53,863810 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb08da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb08278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb087b8>]}
2020-03-03 19:38:54,7929 (MainThread): Flushing usage events
2020-03-03 19:40:20,44907 (MainThread): Running with dbt=0.15.2
2020-03-03 19:40:20,131576 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-03-03 19:40:20,132584 (MainThread): Tracking: tracking
2020-03-03 19:40:20,141527 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136b90f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd03908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd03240>]}
2020-03-03 19:40:20,355742 (MainThread): Partial parsing not enabled
2020-03-03 19:40:20,357891 (MainThread): Parsing macros/core.sql
2020-03-03 19:40:20,362114 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 19:40:20,367425 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 19:40:20,368882 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 19:40:20,381839 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 19:40:20,395998 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 19:40:20,409381 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 19:40:20,411060 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 19:40:20,416168 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 19:40:20,421802 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 19:40:20,426670 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 19:40:20,431374 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 19:40:20,435466 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 19:40:20,436959 (MainThread): Parsing macros/etc/query.sql
2020-03-03 19:40:20,438538 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 19:40:20,442833 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 19:40:20,444899 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 19:40:20,451520 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 19:40:20,453594 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 19:40:20,475860 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 19:40:20,477060 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 19:40:20,478017 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 19:40:20,479083 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 19:40:20,481028 (MainThread): Parsing macros/catalog.sql
2020-03-03 19:40:20,482555 (MainThread): Parsing macros/relations.sql
2020-03-03 19:40:20,483672 (MainThread): Parsing macros/adapters.sql
2020-03-03 19:40:20,491619 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 19:40:20,509710 (MainThread): Partial parsing not enabled
2020-03-03 19:40:20,524427 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:40:20,524556 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:40:20,541050 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:40:20,541204 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:40:20,547666 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:40:20,547794 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:40:20,554741 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:40:20,554882 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:40:20,594314 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 19:40:20,594461 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:40:20,607200 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 19:40:20,607337 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:40:20,617624 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 19:40:20,617753 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:40:20,624979 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 19:40:20,625094 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:40:20,636642 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 19:40:20,636786 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:40:20,644923 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 19:40:20,645126 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:40:20,723995 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 19:40:20,730691 (MainThread): 
2020-03-03 19:40:20,730886 (MainThread): 13:40:20 | Concurrency: 1 threads (target='dev')
2020-03-03 19:40:20,731001 (MainThread): 13:40:20 | 
2020-03-03 19:40:20,732890 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-03 19:40:20,733237 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 19:40:20,733322 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:40:20,733408 (Thread-1): Compiling seed.civis_platform.ad_account_metrics
2020-03-03 19:40:20,743449 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,743705 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,744110 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-03 19:40:20,744227 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-03 19:40:20,744523 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-03 19:40:20,744601 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:40:20,744671 (Thread-1): Compiling seed.civis_platform.dim_date
2020-03-03 19:40:20,748753 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,748971 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,749278 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-03 19:40:20,749406 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 19:40:20,749762 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:40:20,749995 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:40:20,750250 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 19:40:20,762336 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 19:40:20,763095 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,763835 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,764381 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 19:40:20,764557 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 19:40:20,764928 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:40:20,765167 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:40:20,765255 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 19:40:20,773445 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 19:40:20,774086 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,774679 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,775224 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 19:40:20,775422 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 19:40:20,775914 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:40:20,776062 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:40:20,776148 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 19:40:20,784456 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 19:40:20,785211 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,785752 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,786418 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 19:40:20,786608 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 19:40:20,787110 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 19:40:20,787252 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:40:20,787341 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 19:40:20,800581 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-03 19:40:20,802621 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,803164 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,803832 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 19:40:20,804083 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 19:40:20,804634 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 19:40:20,804758 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:40:20,804844 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 19:40:20,813152 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-03 19:40:20,814104 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,814541 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,815209 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 19:40:20,815411 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 19:40:20,815814 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:40:20,815959 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:40:20,816056 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 19:40:20,822867 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 19:40:20,823482 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,824093 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,824667 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 19:40:20,824851 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 19:40:20,825204 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 19:40:20,825321 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:40:20,825403 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 19:40:20,833195 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-03 19:40:20,835130 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,835765 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,836346 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 19:40:20,836536 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 19:40:20,836906 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 19:40:20,837035 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:40:20,837123 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 19:40:20,847378 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-03 19:40:20,847861 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,848494 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,849119 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 19:40:20,849444 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 19:40:20,849832 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 19:40:20,849953 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:40:20,850034 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 19:40:20,857905 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-03 19:40:20,858870 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,859391 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,860024 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 19:40:20,860210 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 19:40:20,860617 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 19:40:20,860740 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:40:20,860826 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 19:40:20,868926 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-03 19:40:20,869510 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,870055 (Thread-1): finished collecting timing info
2020-03-03 19:40:20,870701 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 19:40:20,934700 (MainThread): Connection 'test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_' was properly closed.
2020-03-03 19:40:20,935136 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was properly closed.
2020-03-03 19:40:20,966825 (MainThread): 13:40:20 | Done.
2020-03-03 19:40:20,967228 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136ad4a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffa7588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffa7518>]}
2020-03-03 19:40:21,99885 (MainThread): Flushing usage events
2020-03-03 19:41:07,933889 (MainThread): Running with dbt=0.15.2
2020-03-03 19:41:08,26810 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-03-03 19:41:08,27448 (MainThread): Tracking: tracking
2020-03-03 19:41:08,34399 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b21438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b21940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b21b38>]}
2020-03-03 19:41:08,196139 (MainThread): Partial parsing not enabled
2020-03-03 19:41:08,198099 (MainThread): Parsing macros/core.sql
2020-03-03 19:41:08,202416 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 19:41:08,207753 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 19:41:08,209290 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 19:41:08,222301 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 19:41:08,236487 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 19:41:08,252935 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 19:41:08,254665 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 19:41:08,259867 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 19:41:08,265595 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 19:41:08,270827 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 19:41:08,275574 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 19:41:08,279496 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 19:41:08,280566 (MainThread): Parsing macros/etc/query.sql
2020-03-03 19:41:08,281688 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 19:41:08,285443 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 19:41:08,287422 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 19:41:08,293875 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 19:41:08,295617 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 19:41:08,317347 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 19:41:08,318805 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 19:41:08,319870 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 19:41:08,320972 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 19:41:08,322884 (MainThread): Parsing macros/catalog.sql
2020-03-03 19:41:08,324345 (MainThread): Parsing macros/relations.sql
2020-03-03 19:41:08,325913 (MainThread): Parsing macros/adapters.sql
2020-03-03 19:41:08,335094 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 19:41:08,352820 (MainThread): Partial parsing not enabled
2020-03-03 19:41:08,366791 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:41:08,366921 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:41:08,384103 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:41:08,384232 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:41:08,390912 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:41:08,391040 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:41:08,397049 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:41:08,397169 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:41:08,432806 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 19:41:08,432938 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:41:08,445800 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 19:41:08,445933 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:41:08,455735 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 19:41:08,455855 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:41:08,463068 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 19:41:08,463192 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:41:08,474783 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 19:41:08,474918 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:41:08,482932 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 19:41:08,483065 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:41:08,551497 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 19:41:08,557836 (MainThread): 
2020-03-03 19:41:08,558043 (MainThread): 13:41:08 | Concurrency: 1 threads (target='dev')
2020-03-03 19:41:08,558226 (MainThread): 13:41:08 | 
2020-03-03 19:41:08,560046 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-03 19:41:08,560371 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 19:41:08,560460 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:41:08,560549 (Thread-1): Compiling seed.civis_platform.ad_account_metrics
2020-03-03 19:41:08,570822 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,571103 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,571442 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-03 19:41:08,571573 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-03 19:41:08,571821 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-03 19:41:08,572044 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:41:08,572139 (Thread-1): Compiling seed.civis_platform.dim_date
2020-03-03 19:41:08,576188 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,576407 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,576719 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-03 19:41:08,576846 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 19:41:08,577207 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:41:08,577448 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:41:08,577540 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 19:41:08,589651 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 19:41:08,590226 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,590914 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,591933 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 19:41:08,592141 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 19:41:08,592518 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:41:08,592754 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:41:08,592847 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 19:41:08,601796 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 19:41:08,602763 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,603363 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,604062 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 19:41:08,604292 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 19:41:08,604958 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:41:08,605139 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:41:08,605255 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 19:41:08,612330 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 19:41:08,612903 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,613416 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,613954 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 19:41:08,614194 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 19:41:08,614776 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 19:41:08,615221 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:41:08,615458 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 19:41:08,628490 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-03 19:41:08,629363 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,629842 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,630369 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 19:41:08,630549 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 19:41:08,630890 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 19:41:08,630999 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:41:08,631083 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 19:41:08,638854 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-03 19:41:08,639680 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,640347 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,641051 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 19:41:08,641339 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 19:41:08,641814 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:41:08,641936 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:41:08,642048 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 19:41:08,648632 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 19:41:08,649241 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,649777 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,650397 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 19:41:08,650658 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 19:41:08,651173 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 19:41:08,651347 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:41:08,651480 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 19:41:08,661867 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-03 19:41:08,662628 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,663301 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,664108 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 19:41:08,664364 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 19:41:08,664835 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 19:41:08,664961 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:41:08,665084 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 19:41:08,675651 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-03 19:41:08,676210 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,676763 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,677329 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 19:41:08,677509 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 19:41:08,677876 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 19:41:08,677999 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:41:08,678087 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 19:41:08,686931 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-03 19:41:08,687646 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,688204 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,688845 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 19:41:08,689104 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 19:41:08,689490 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 19:41:08,689595 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:41:08,689677 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 19:41:08,697469 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-03 19:41:08,699365 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,700004 (Thread-1): finished collecting timing info
2020-03-03 19:41:08,700703 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 19:41:08,762854 (MainThread): Connection 'test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_' was properly closed.
2020-03-03 19:41:08,763244 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was properly closed.
2020-03-03 19:41:08,795425 (MainThread): 13:41:08 | Done.
2020-03-03 19:41:08,795747 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f392b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105025d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105025dd8>]}
2020-03-03 19:41:08,927648 (MainThread): Flushing usage events
2020-03-03 19:42:38,532721 (MainThread): Running with dbt=0.15.2
2020-03-03 19:42:38,632417 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 19:42:38,633419 (MainThread): Tracking: tracking
2020-03-03 19:42:38,644549 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c6438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac87940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac879b0>]}
2020-03-03 19:42:38,938649 (MainThread): Partial parsing not enabled
2020-03-03 19:42:38,940563 (MainThread): Parsing macros/core.sql
2020-03-03 19:42:38,943994 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 19:42:38,949551 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 19:42:38,950967 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 19:42:38,969128 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 19:42:38,984521 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 19:42:38,999856 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 19:42:39,1791 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 19:42:39,7861 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 19:42:39,13746 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 19:42:39,19250 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 19:42:39,23982 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 19:42:39,28036 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 19:42:39,28967 (MainThread): Parsing macros/etc/query.sql
2020-03-03 19:42:39,30038 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 19:42:39,31667 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 19:42:39,33682 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 19:42:39,40314 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 19:42:39,42371 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 19:42:39,64144 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 19:42:39,65164 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 19:42:39,65958 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 19:42:39,66842 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 19:42:39,68706 (MainThread): Parsing macros/catalog.sql
2020-03-03 19:42:39,69958 (MainThread): Parsing macros/relations.sql
2020-03-03 19:42:39,70994 (MainThread): Parsing macros/adapters.sql
2020-03-03 19:42:39,79236 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 19:42:39,95975 (MainThread): Partial parsing not enabled
2020-03-03 19:42:39,113485 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:42:39,113617 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:42:39,129609 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:42:39,129733 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:42:39,135465 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:42:39,135581 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:42:39,141471 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:42:39,141593 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:42:39,178515 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 19:42:39,178646 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:42:39,189916 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 19:42:39,190044 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:42:39,200429 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 19:42:39,200560 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:42:39,207817 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 19:42:39,207936 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:42:39,218855 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 19:42:39,218993 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:42:39,226923 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 19:42:39,227048 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:42:39,296218 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 19:42:39,301955 (MainThread): 
2020-03-03 19:42:39,302346 (MainThread): Acquiring new postgres connection "master".
2020-03-03 19:42:39,302444 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:42:39,398329 (MainThread): Using postgres connection "master".
2020-03-03 19:42:39,398482 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 19:42:39,405486 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 19:42:39,466017 (MainThread): Using postgres connection "master".
2020-03-03 19:42:39,481461 (MainThread): On master: BEGIN
2020-03-03 19:42:39,483442 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:42:39,483776 (MainThread): Using postgres connection "master".
2020-03-03 19:42:39,484004 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 19:42:39,492723 (MainThread): SQL status: SELECT 7 in 0.01 seconds
2020-03-03 19:42:39,547956 (MainThread): Using postgres connection "master".
2020-03-03 19:42:39,548091 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 19:42:39,565113 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2020-03-03 19:42:39,569931 (MainThread): On master: ROLLBACK
2020-03-03 19:42:39,570286 (MainThread): Using postgres connection "master".
2020-03-03 19:42:39,570425 (MainThread): On master: BEGIN
2020-03-03 19:42:39,570699 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:42:39,571149 (MainThread): On master: COMMIT
2020-03-03 19:42:39,571282 (MainThread): Using postgres connection "master".
2020-03-03 19:42:39,571360 (MainThread): On master: COMMIT
2020-03-03 19:42:39,571572 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:42:39,571874 (MainThread): 13:42:39 | Concurrency: 1 threads (target='dev')
2020-03-03 19:42:39,572031 (MainThread): 13:42:39 | 
2020-03-03 19:42:39,573745 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 19:42:39,574086 (Thread-1): 13:42:39 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 19:42:39,574484 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:42:39,574594 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:42:39,574725 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 19:42:39,593762 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 19:42:39,594605 (Thread-1): finished collecting timing info
2020-03-03 19:42:39,636070 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:42:39,636224 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-03 19:42:39,641860 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-03-03 19:42:39,644825 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:42:39,644954 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 19:42:39,645223 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:42:39,646647 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:42:39,646759 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-03 19:42:39,647043 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:42:39,647146 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:42:39,647222 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:42:39,653254 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-03 19:42:39,655048 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 19:42:39,655603 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:42:39,655891 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    d.date,
    d.business_day,
    ad.impressions,
    ad.clicks,
    ad.spend::numeric(7,0),
    round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
    round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
    round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
from 
    "dbryan"."public"."dim_date" d
    inner join "dbryan"."public"."ad_account_metrics" ad
        on ad.date = d.date order by d.date
where
    d.date >= 2020-03-03
  );

2020-03-03 19:42:39,657977 (Thread-1): Postgres error: syntax error at or near "where"
LINE 18: where
         ^

2020-03-03 19:42:39,658170 (Thread-1): On model.civis_platform.fact_daily_performance: ROLLBACK
2020-03-03 19:42:39,658459 (Thread-1): finished collecting timing info
2020-03-03 19:42:39,659106 (Thread-1): Database Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  syntax error at or near "where"
  LINE 18: where
           ^
  compiled SQL at target/run/civis_platform/main/fact_daily_performance.sql
Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 44, in exception_handler
    yield
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "where"
LINE 18: where
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 218, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 161, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 260, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 436, in execute
    result = materialization_macro.generator(context)()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 155, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 155, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 276, in execute
    fetch=fetch
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  syntax error at or near "where"
  LINE 18: where
           ^
  compiled SQL at target/run/civis_platform/main/fact_daily_performance.sql
2020-03-03 19:42:39,666401 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795522c5-f6c8-4a2a-bd62-34dfcf088072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107522470>]}
2020-03-03 19:42:39,792179 (Thread-1): 13:42:39 | 1 of 4 ERROR creating view model public.fact_daily_performance....... [ERROR in 0.09s]
2020-03-03 19:42:39,792512 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 19:42:39,792768 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 19:42:39,793512 (Thread-1): 13:42:39 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 19:42:39,794051 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:42:39,794181 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-03 19:42:39,794293 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 19:42:39,803932 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 19:42:39,804877 (Thread-1): finished collecting timing info
2020-03-03 19:42:39,829237 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:42:39,829395 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 19:42:39,829882 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:42:39,832692 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:42:39,832814 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 19:42:39,833143 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:42:39,834574 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:42:39,834695 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 19:42:39,835176 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:42:39,835265 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:42:39,835334 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:42:39,838757 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:42:39,840166 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 19:42:39,840837 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:42:39,841085 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
2020-03-03 19:42:39,842796 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 19:42:39,847075 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:42:39,847250 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 19:42:39,847877 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:42:39,850758 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:42:39,850899 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 19:42:39,851912 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:42:39,854052 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:42:39,854190 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:42:39,855251 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:42:39,856720 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 19:42:39,856890 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:42:39,857026 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 19:42:39,859001 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:42:39,860990 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:42:39,861127 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 19:42:39,862776 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:42:39,865962 (Thread-1): finished collecting timing info
2020-03-03 19:42:39,866578 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795522c5-f6c8-4a2a-bd62-34dfcf088072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075255c0>]}
2020-03-03 19:42:39,993393 (Thread-1): 13:42:39 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.07s]
2020-03-03 19:42:39,993716 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 19:42:39,994021 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 19:42:39,994387 (Thread-1): 13:42:39 | 3 of 4 SKIP relation public.fact_monthly_performance................. [SKIP]
2020-03-03 19:42:39,994800 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 19:42:39,995124 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 19:42:39,995460 (Thread-1): 13:42:39 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 19:42:39,995927 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:42:39,996075 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 19:42:39,996220 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 19:42:40,4644 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 19:42:40,5188 (Thread-1): finished collecting timing info
2020-03-03 19:42:40,13565 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:42:40,13700 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 19:42:40,14120 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:42:40,16514 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:42:40,16682 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 19:42:40,17129 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:42:40,19501 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:42:40,19643 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 19:42:40,19850 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:42:40,19938 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:42:40,20007 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:42:40,23179 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:42:40,24398 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 19:42:40,25208 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:42:40,25407 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 19:42:40,27493 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:42:40,33130 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:42:40,33291 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 19:42:40,33834 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:42:40,37326 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:42:40,37476 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 19:42:40,38182 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:42:40,40006 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:42:40,40135 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:42:40,40625 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:42:40,41830 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 19:42:40,42011 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:42:40,42132 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 19:42:40,44235 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:42:40,46360 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:42:40,46613 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 19:42:40,48050 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:42:40,51752 (Thread-1): finished collecting timing info
2020-03-03 19:42:40,52437 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795522c5-f6c8-4a2a-bd62-34dfcf088072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107358f28>]}
2020-03-03 19:42:40,170462 (Thread-1): 13:42:40 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.06s]
2020-03-03 19:42:40,170655 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 19:42:40,181597 (MainThread): Using postgres connection "master".
2020-03-03 19:42:40,181826 (MainThread): On master: BEGIN
2020-03-03 19:42:40,182201 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:42:40,182372 (MainThread): On master: COMMIT
2020-03-03 19:42:40,182470 (MainThread): Using postgres connection "master".
2020-03-03 19:42:40,182549 (MainThread): On master: COMMIT
2020-03-03 19:42:40,182786 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:42:40,183073 (MainThread): 13:42:40 | 
2020-03-03 19:42:40,183250 (MainThread): 13:42:40 | Finished running 2 view models, 2 table models in 0.88s.
2020-03-03 19:42:40,183400 (MainThread): Connection 'master' was left open.
2020-03-03 19:42:40,183511 (MainThread): On master: Close
2020-03-03 19:42:40,183631 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 19:42:40,183710 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 19:42:40,196515 (MainThread): 
2020-03-03 19:42:40,196899 (MainThread): Completed with 1 error and 0 warnings:
2020-03-03 19:42:40,197101 (MainThread): 
2020-03-03 19:42:40,197298 (MainThread): Database Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
2020-03-03 19:42:40,197460 (MainThread):   syntax error at or near "where"
2020-03-03 19:42:40,197596 (MainThread):   LINE 18: where
2020-03-03 19:42:40,197731 (MainThread):            ^
2020-03-03 19:42:40,197875 (MainThread):   compiled SQL at target/run/civis_platform/main/fact_daily_performance.sql
2020-03-03 19:42:40,198000 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-03-03 19:42:40,198246 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10751f4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a19e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a1160>]}
2020-03-03 19:42:40,321966 (MainThread): Flushing usage events
2020-03-03 19:43:06,760227 (MainThread): Running with dbt=0.15.2
2020-03-03 19:43:07,398925 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 19:43:07,399694 (MainThread): Tracking: tracking
2020-03-03 19:43:07,408946 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4d0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4d00b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4d0048>]}
2020-03-03 19:43:07,575204 (MainThread): Partial parsing not enabled
2020-03-03 19:43:07,578053 (MainThread): Parsing macros/core.sql
2020-03-03 19:43:07,582198 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 19:43:07,588484 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 19:43:07,590148 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 19:43:07,604459 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 19:43:07,622366 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 19:43:07,641298 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 19:43:07,643197 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 19:43:07,649227 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 19:43:07,656603 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 19:43:07,662342 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 19:43:07,668358 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 19:43:07,672887 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 19:43:07,674191 (MainThread): Parsing macros/etc/query.sql
2020-03-03 19:43:07,675459 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 19:43:07,677159 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 19:43:07,679233 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 19:43:07,687572 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 19:43:07,689722 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 19:43:07,714614 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 19:43:07,715944 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 19:43:07,716995 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 19:43:07,718260 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 19:43:07,720640 (MainThread): Parsing macros/catalog.sql
2020-03-03 19:43:07,722447 (MainThread): Parsing macros/relations.sql
2020-03-03 19:43:07,724155 (MainThread): Parsing macros/adapters.sql
2020-03-03 19:43:07,734469 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 19:43:07,759436 (MainThread): Partial parsing not enabled
2020-03-03 19:43:07,781253 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:43:07,781414 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:43:07,805566 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:43:07,805724 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:43:07,815470 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:43:07,815634 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:43:07,824402 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:43:07,824539 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:43:07,873725 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 19:43:07,873872 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:43:07,899605 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 19:43:07,900802 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:43:07,925195 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 19:43:07,925393 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:43:07,934939 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 19:43:07,935112 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:43:07,955416 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 19:43:07,955575 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:43:07,966209 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 19:43:07,966370 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:43:08,54838 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 19:43:08,61942 (MainThread): 
2020-03-03 19:43:08,62663 (MainThread): Acquiring new postgres connection "master".
2020-03-03 19:43:08,62926 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:43:08,153222 (MainThread): Using postgres connection "master".
2020-03-03 19:43:08,153380 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 19:43:08,159514 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 19:43:08,202883 (MainThread): Using postgres connection "master".
2020-03-03 19:43:08,203092 (MainThread): On master: BEGIN
2020-03-03 19:43:08,203488 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:43:08,203586 (MainThread): Using postgres connection "master".
2020-03-03 19:43:08,203659 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 19:43:08,206848 (MainThread): SQL status: SELECT 7 in 0.00 seconds
2020-03-03 19:43:08,249711 (MainThread): Using postgres connection "master".
2020-03-03 19:43:08,249844 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 19:43:08,263722 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 19:43:08,267208 (MainThread): On master: ROLLBACK
2020-03-03 19:43:08,267491 (MainThread): Using postgres connection "master".
2020-03-03 19:43:08,267586 (MainThread): On master: BEGIN
2020-03-03 19:43:08,267975 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:43:08,268068 (MainThread): On master: COMMIT
2020-03-03 19:43:08,268145 (MainThread): Using postgres connection "master".
2020-03-03 19:43:08,268211 (MainThread): On master: COMMIT
2020-03-03 19:43:08,268422 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:43:08,268658 (MainThread): 13:43:08 | Concurrency: 1 threads (target='dev')
2020-03-03 19:43:08,268786 (MainThread): 13:43:08 | 
2020-03-03 19:43:08,274593 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 19:43:08,274801 (Thread-1): 13:43:08 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 19:43:08,275152 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:43:08,275247 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:43:08,275340 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 19:43:08,290929 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 19:43:08,291483 (Thread-1): finished collecting timing info
2020-03-03 19:43:08,322681 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:43:08,322842 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-03 19:43:08,328106 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-03-03 19:43:08,330427 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:43:08,330548 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 19:43:08,330872 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:43:08,332160 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:43:08,332253 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-03 19:43:08,332478 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:43:08,332562 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:43:08,332631 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:43:08,337763 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-03 19:43:08,339261 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 19:43:08,339717 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:43:08,339824 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    d.date,
    d.business_day,
    ad.impressions,
    ad.clicks,
    ad.spend::numeric(7,0),
    round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
    round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
    round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
from 
    "dbryan"."public"."dim_date" d
    inner join "dbryan"."public"."ad_account_metrics" ad
        on ad.date = d.date
where
    d.date >= 2020-03-03
order by 
    d.date
  );

2020-03-03 19:43:08,342954 (Thread-1): Postgres error: operator does not exist: date >= integer
LINE 19:     d.date >= 2020-03-03
                    ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

2020-03-03 19:43:08,343110 (Thread-1): On model.civis_platform.fact_daily_performance: ROLLBACK
2020-03-03 19:43:08,343339 (Thread-1): finished collecting timing info
2020-03-03 19:43:08,343753 (Thread-1): Database Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  operator does not exist: date >= integer
  LINE 19:     d.date >= 2020-03-03
                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/civis_platform/main/fact_daily_performance.sql
Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 44, in exception_handler
    yield
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: operator does not exist: date >= integer
LINE 19:     d.date >= 2020-03-03
                    ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 218, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 161, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 260, in run
    return self.execute(compiled_node, manifest)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 436, in execute
    result = materialization_macro.generator(context)()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 155, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 155, in call_macro
    return macro(*args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 276, in execute
    fetch=fetch
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  operator does not exist: date >= integer
  LINE 19:     d.date >= 2020-03-03
                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/civis_platform/main/fact_daily_performance.sql
2020-03-03 19:43:08,345855 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10717c98-9f9a-4cb1-b2df-a218cc5a4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c714a20>]}
2020-03-03 19:43:08,501889 (Thread-1): 13:43:08 | 1 of 4 ERROR creating view model public.fact_daily_performance....... [ERROR in 0.07s]
2020-03-03 19:43:08,502144 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 19:43:08,502326 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 19:43:08,502601 (Thread-1): 13:43:08 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 19:43:08,503075 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:43:08,503170 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-03 19:43:08,503255 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 19:43:08,510124 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 19:43:08,510787 (Thread-1): finished collecting timing info
2020-03-03 19:43:08,532481 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:43:08,532627 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 19:43:08,533004 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:43:08,536893 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:43:08,537070 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 19:43:08,537439 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:43:08,539889 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:43:08,540060 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 19:43:08,540720 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:43:08,540879 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:43:08,540996 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:43:08,544467 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:43:08,546516 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 19:43:08,547490 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:43:08,547836 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
2020-03-03 19:43:08,550155 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 19:43:08,556415 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:43:08,556597 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 19:43:08,557164 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:43:08,559952 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:43:08,560108 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 19:43:08,560765 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:43:08,562313 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:43:08,562533 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:43:08,563345 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:43:08,564768 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 19:43:08,564897 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:43:08,564976 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 19:43:08,566103 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:43:08,567718 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:43:08,567838 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 19:43:08,568894 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:43:08,571906 (Thread-1): finished collecting timing info
2020-03-03 19:43:08,572626 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10717c98-9f9a-4cb1-b2df-a218cc5a4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d94898>]}
2020-03-03 19:43:08,691984 (Thread-1): 13:43:08 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.07s]
2020-03-03 19:43:08,692215 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 19:43:08,692429 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 19:43:08,692672 (Thread-1): 13:43:08 | 3 of 4 SKIP relation public.fact_monthly_performance................. [SKIP]
2020-03-03 19:43:08,692965 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 19:43:08,693115 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 19:43:08,693308 (Thread-1): 13:43:08 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 19:43:08,693655 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:43:08,693758 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 19:43:08,693850 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 19:43:08,702229 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 19:43:08,702741 (Thread-1): finished collecting timing info
2020-03-03 19:43:08,710464 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:43:08,710603 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 19:43:08,711030 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:43:08,714397 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:43:08,714592 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 19:43:08,714954 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:43:08,716713 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:43:08,716831 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 19:43:08,717061 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:43:08,717149 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:43:08,717221 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:43:08,720834 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:43:08,722427 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 19:43:08,722918 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:43:08,723281 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 19:43:08,725186 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:43:08,731549 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:43:08,731700 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 19:43:08,732208 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:43:08,734640 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:43:08,734807 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 19:43:08,735594 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:43:08,737752 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:43:08,737924 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:43:08,738500 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:43:08,739636 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 19:43:08,739807 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:43:08,739934 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 19:43:08,741215 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:43:08,743437 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:43:08,743605 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 19:43:08,744935 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:43:08,750107 (Thread-1): finished collecting timing info
2020-03-03 19:43:08,751302 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10717c98-9f9a-4cb1-b2df-a218cc5a4736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c715400>]}
2020-03-03 19:43:08,884422 (Thread-1): 13:43:08 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.06s]
2020-03-03 19:43:08,884827 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 19:43:08,887594 (MainThread): Using postgres connection "master".
2020-03-03 19:43:08,887791 (MainThread): On master: BEGIN
2020-03-03 19:43:08,888185 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:43:08,888390 (MainThread): On master: COMMIT
2020-03-03 19:43:08,888541 (MainThread): Using postgres connection "master".
2020-03-03 19:43:08,888673 (MainThread): On master: COMMIT
2020-03-03 19:43:08,889140 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:43:08,889565 (MainThread): 13:43:08 | 
2020-03-03 19:43:08,889758 (MainThread): 13:43:08 | Finished running 2 view models, 2 table models in 0.83s.
2020-03-03 19:43:08,889994 (MainThread): Connection 'master' was left open.
2020-03-03 19:43:08,890195 (MainThread): On master: Close
2020-03-03 19:43:08,890391 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 19:43:08,890576 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 19:43:08,903971 (MainThread): 
2020-03-03 19:43:08,904309 (MainThread): Completed with 1 error and 0 warnings:
2020-03-03 19:43:08,904666 (MainThread): 
2020-03-03 19:43:08,904871 (MainThread): Database Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
2020-03-03 19:43:08,905040 (MainThread):   operator does not exist: date >= integer
2020-03-03 19:43:08,905328 (MainThread):   LINE 19:     d.date >= 2020-03-03
2020-03-03 19:43:08,905507 (MainThread):                       ^
2020-03-03 19:43:08,905696 (MainThread):   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2020-03-03 19:43:08,906040 (MainThread):   compiled SQL at target/run/civis_platform/main/fact_daily_performance.sql
2020-03-03 19:43:08,906204 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-03-03 19:43:08,906443 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c697a58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c634da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6d16d8>]}
2020-03-03 19:43:09,28655 (MainThread): Flushing usage events
2020-03-03 19:46:28,127777 (MainThread): Running with dbt=0.15.2
2020-03-03 19:46:28,236281 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 19:46:28,237278 (MainThread): Tracking: tracking
2020-03-03 19:46:28,256862 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de4898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de4d68>]}
2020-03-03 19:46:28,466030 (MainThread): Partial parsing not enabled
2020-03-03 19:46:28,468583 (MainThread): Parsing macros/core.sql
2020-03-03 19:46:28,472202 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 19:46:28,477949 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 19:46:28,479448 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 19:46:28,493396 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 19:46:28,508306 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 19:46:28,523002 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 19:46:28,524795 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 19:46:28,530055 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 19:46:28,536001 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 19:46:28,541110 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 19:46:28,545930 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 19:46:28,550077 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 19:46:28,551490 (MainThread): Parsing macros/etc/query.sql
2020-03-03 19:46:28,553134 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 19:46:28,554776 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 19:46:28,556625 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 19:46:28,563291 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 19:46:28,565195 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 19:46:28,594730 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 19:46:28,596215 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 19:46:28,597253 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 19:46:28,598466 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 19:46:28,600587 (MainThread): Parsing macros/catalog.sql
2020-03-03 19:46:28,601993 (MainThread): Parsing macros/relations.sql
2020-03-03 19:46:28,603210 (MainThread): Parsing macros/adapters.sql
2020-03-03 19:46:28,615230 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 19:46:28,640101 (MainThread): Partial parsing not enabled
2020-03-03 19:46:28,660571 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:46:28,660818 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:46:28,678391 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:46:28,678731 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:46:28,685296 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:46:28,685424 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:46:28,694603 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:46:28,694731 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:46:28,735765 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 19:46:28,735936 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:46:28,748376 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 19:46:28,748513 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:46:28,760091 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 19:46:28,760227 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:46:28,767648 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 19:46:28,767769 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:46:28,779307 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 19:46:28,779444 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:46:28,788141 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 19:46:28,788312 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:46:28,869129 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 125 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 19:46:28,875254 (MainThread): 
2020-03-03 19:46:28,875628 (MainThread): Acquiring new postgres connection "master".
2020-03-03 19:46:28,875720 (MainThread): Opening a new connection, currently in state init
2020-03-03 19:46:28,956327 (MainThread): Using postgres connection "master".
2020-03-03 19:46:28,956485 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 19:46:28,963661 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 19:46:29,9259 (MainThread): Using postgres connection "master".
2020-03-03 19:46:29,9403 (MainThread): On master: BEGIN
2020-03-03 19:46:29,11858 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:46:29,12044 (MainThread): Using postgres connection "master".
2020-03-03 19:46:29,12172 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 19:46:29,16142 (MainThread): SQL status: SELECT 7 in 0.00 seconds
2020-03-03 19:46:29,59779 (MainThread): Using postgres connection "master".
2020-03-03 19:46:29,59961 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 19:46:29,74539 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 19:46:29,78729 (MainThread): On master: ROLLBACK
2020-03-03 19:46:29,79158 (MainThread): Using postgres connection "master".
2020-03-03 19:46:29,79289 (MainThread): On master: BEGIN
2020-03-03 19:46:29,79925 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:46:29,80082 (MainThread): On master: COMMIT
2020-03-03 19:46:29,80186 (MainThread): Using postgres connection "master".
2020-03-03 19:46:29,80280 (MainThread): On master: COMMIT
2020-03-03 19:46:29,80442 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:46:29,80697 (MainThread): 13:46:29 | Concurrency: 1 threads (target='dev')
2020-03-03 19:46:29,80825 (MainThread): 13:46:29 | 
2020-03-03 19:46:29,83714 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 19:46:29,84003 (Thread-1): 13:46:29 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 19:46:29,84443 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:46:29,84575 (Thread-1): Opening a new connection, currently in state init
2020-03-03 19:46:29,84703 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 19:46:29,105617 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 19:46:29,106947 (Thread-1): finished collecting timing info
2020-03-03 19:46:29,138078 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:46:29,138237 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-03 19:46:29,143980 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-03-03 19:46:29,146044 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:46:29,146149 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 19:46:29,146458 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:46:29,147652 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:46:29,147744 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-03 19:46:29,148065 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:46:29,148149 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:46:29,148217 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:46:29,156242 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-03 19:46:29,157989 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 19:46:29,158870 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:46:29,159036 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    d.date,
    d.business_day,
    ad.impressions,
    ad.clicks,
    ad.spend::numeric(7,0),
    round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
    round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
    round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
from 
    "dbryan"."public"."dim_date" d
    inner join "dbryan"."public"."ad_account_metrics" ad
        on ad.date = d.date
where
    d.date >= '2020-03-03'
order by 
    d.date
  );

2020-03-03 19:46:29,162496 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 19:46:29,166000 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:46:29,166142 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance" rename to "fact_daily_performance__dbt_backup"
2020-03-03 19:46:29,166749 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:46:29,168667 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:46:29,168771 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance__dbt_tmp" rename to "fact_daily_performance"
2020-03-03 19:46:29,169592 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:46:29,171053 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:46:29,171161 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:46:29,171907 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:46:29,172582 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 19:46:29,172675 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:46:29,172748 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 19:46:29,175326 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:46:29,177522 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 19:46:29,177643 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 19:46:29,179396 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:46:29,181656 (Thread-1): finished collecting timing info
2020-03-03 19:46:29,182267 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d88709-65fe-454e-86f5-d629b9406c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097b8438>]}
2020-03-03 19:46:29,304608 (Thread-1): 13:46:29 | 1 of 4 OK created view model public.fact_daily_performance........... [CREATE VIEW in 0.10s]
2020-03-03 19:46:29,304836 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 19:46:29,304998 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 19:46:29,305440 (Thread-1): 13:46:29 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 19:46:29,306583 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:46:29,307283 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-03 19:46:29,307422 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 19:46:29,314548 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 19:46:29,316360 (Thread-1): finished collecting timing info
2020-03-03 19:46:29,343153 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:46:29,343387 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 19:46:29,345320 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:46:29,348844 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:46:29,349028 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 19:46:29,349426 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:46:29,352410 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:46:29,352593 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 19:46:29,352882 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:46:29,353024 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:46:29,353145 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:46:29,359736 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-03 19:46:29,362539 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 19:46:29,364175 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:46:29,364398 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
2020-03-03 19:46:29,366152 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 19:46:29,369986 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:46:29,370145 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 19:46:29,370622 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:46:29,372820 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:46:29,372931 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 19:46:29,373633 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:46:29,375059 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:46:29,375170 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:46:29,375688 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:46:29,376349 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 19:46:29,376440 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:46:29,376514 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 19:46:29,377797 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:46:29,379262 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 19:46:29,379358 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 19:46:29,380736 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:46:29,382923 (Thread-1): finished collecting timing info
2020-03-03 19:46:29,383475 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d88709-65fe-454e-86f5-d629b9406c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f75f98>]}
2020-03-03 19:46:29,509892 (Thread-1): 13:46:29 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2020-03-03 19:46:29,510207 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 19:46:29,510566 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 19:46:29,510813 (Thread-1): 13:46:29 | 3 of 4 START view model public.fact_monthly_performance.............. [RUN]
2020-03-03 19:46:29,511274 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:46:29,511572 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 19:46:29,511904 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 19:46:29,521705 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 19:46:29,524512 (Thread-1): finished collecting timing info
2020-03-03 19:46:29,530757 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:46:29,530888 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_tmp" cascade
2020-03-03 19:46:29,531366 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:46:29,533251 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:46:29,533350 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 19:46:29,533717 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:46:29,534994 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:46:29,535091 (Thread-1): On model.civis_platform.fact_monthly_performance: BEGIN
2020-03-03 19:46:29,535350 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:46:29,535561 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:46:29,535667 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:46:29,539771 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:46:29,541521 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 19:46:29,542476 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:46:29,542872 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

  
  create view "dbryan"."public"."fact_monthly_performance__dbt_tmp" as (
    select
    date_trunc('month', f.date)::date as month,
    sum(impressions) as impressions,
    sum(clicks) as clicks,
    sum(spend) as spend,
    round(avg(spend)::numeric, 2) as average_daily_spend
from
    "dbryan"."public"."fact_daily_performance" f
group by 
    date_trunc('month', f.date)::date
order by
    date_trunc('month', f.date)::date
  );

2020-03-03 19:46:29,545734 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 19:46:29,549469 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:46:29,549663 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
alter table "dbryan"."public"."fact_monthly_performance__dbt_tmp" rename to "fact_monthly_performance"
2020-03-03 19:46:29,550358 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:46:29,552736 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:46:29,552905 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:46:29,553432 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:46:29,554475 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 19:46:29,554624 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:46:29,554733 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 19:46:29,556136 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:46:29,559833 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 19:46:29,560031 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 19:46:29,561238 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 19:46:29,565395 (Thread-1): finished collecting timing info
2020-03-03 19:46:29,566363 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d88709-65fe-454e-86f5-d629b9406c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050517b8>]}
2020-03-03 19:46:29,690729 (Thread-1): 13:46:29 | 3 of 4 OK created view model public.fact_monthly_performance......... [CREATE VIEW in 0.06s]
2020-03-03 19:46:29,691003 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 19:46:29,691215 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 19:46:29,691444 (Thread-1): 13:46:29 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 19:46:29,691786 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:46:29,691873 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_monthly_performance).
2020-03-03 19:46:29,691958 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 19:46:29,699735 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 19:46:29,701049 (Thread-1): finished collecting timing info
2020-03-03 19:46:29,707228 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:46:29,707412 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 19:46:29,707869 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:46:29,709907 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:46:29,710001 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 19:46:29,710307 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:46:29,713028 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:46:29,713167 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 19:46:29,713375 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:46:29,713553 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:46:29,713668 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 19:46:29,718601 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:46:29,719833 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 19:46:29,720629 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:46:29,720812 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 19:46:29,722250 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 19:46:29,726223 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:46:29,726370 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 19:46:29,726827 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:46:29,728905 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:46:29,729022 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 19:46:29,729849 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 19:46:29,731252 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:46:29,731364 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 19:46:29,731800 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 19:46:29,732420 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 19:46:29,732506 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:46:29,732575 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 19:46:29,734247 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:46:29,735874 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 19:46:29,735965 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 19:46:29,737365 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 19:46:29,739727 (Thread-1): finished collecting timing info
2020-03-03 19:46:29,740600 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d88709-65fe-454e-86f5-d629b9406c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc6208>]}
2020-03-03 19:46:29,872511 (Thread-1): 13:46:29 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.05s]
2020-03-03 19:46:29,872835 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 19:46:29,910572 (MainThread): Using postgres connection "master".
2020-03-03 19:46:29,910746 (MainThread): On master: BEGIN
2020-03-03 19:46:29,911107 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 19:46:29,911234 (MainThread): On master: COMMIT
2020-03-03 19:46:29,911331 (MainThread): Using postgres connection "master".
2020-03-03 19:46:29,911419 (MainThread): On master: COMMIT
2020-03-03 19:46:29,911698 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 19:46:29,912009 (MainThread): 13:46:29 | 
2020-03-03 19:46:29,912162 (MainThread): 13:46:29 | Finished running 2 view models, 2 table models in 1.04s.
2020-03-03 19:46:29,912308 (MainThread): Connection 'master' was left open.
2020-03-03 19:46:29,912435 (MainThread): On master: Close
2020-03-03 19:46:29,912631 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 19:46:29,912803 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 19:46:29,925537 (MainThread): 
2020-03-03 19:46:29,925803 (MainThread): Completed successfully
2020-03-03 19:46:29,926131 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-03-03 19:46:29,926504 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f53e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f534e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f5c6a0>]}
2020-03-03 19:46:30,49125 (MainThread): Flushing usage events
2020-03-03 20:51:08,757246 (MainThread): Running with dbt=0.15.2
2020-03-03 20:51:08,869802 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 20:51:08,870760 (MainThread): Tracking: tracking
2020-03-03 20:51:08,880198 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930f748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930f9b0>]}
2020-03-03 20:51:09,102684 (MainThread): Partial parsing not enabled
2020-03-03 20:51:09,105411 (MainThread): Parsing macros/core.sql
2020-03-03 20:51:09,109192 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 20:51:09,115626 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 20:51:09,117543 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 20:51:09,131066 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 20:51:09,145853 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 20:51:09,159807 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 20:51:09,161682 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 20:51:09,167280 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 20:51:09,173354 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 20:51:09,178463 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 20:51:09,183419 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 20:51:09,187536 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 20:51:09,188706 (MainThread): Parsing macros/etc/query.sql
2020-03-03 20:51:09,190152 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 20:51:09,192099 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 20:51:09,194138 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 20:51:09,201091 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 20:51:09,203088 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 20:51:09,225574 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 20:51:09,226839 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 20:51:09,227961 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 20:51:09,229261 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 20:51:09,231391 (MainThread): Parsing macros/catalog.sql
2020-03-03 20:51:09,233260 (MainThread): Parsing macros/relations.sql
2020-03-03 20:51:09,234597 (MainThread): Parsing macros/adapters.sql
2020-03-03 20:51:09,243053 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 20:51:09,261108 (MainThread): Partial parsing not enabled
2020-03-03 20:51:09,261710 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-03 20:51:09,276594 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:51:09,276728 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:51:09,292757 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:51:09,292891 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:51:09,300044 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 20:51:09,300181 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:51:09,306681 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 20:51:09,306806 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:51:09,347934 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 20:51:09,348074 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:51:09,359248 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 20:51:09,359379 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:51:09,369267 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 20:51:09,369393 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:51:09,377025 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 20:51:09,377155 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:51:09,388351 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 20:51:09,388479 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:51:09,397421 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 20:51:09,397622 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:51:09,478098 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 20:51:09,484329 (MainThread): 
2020-03-03 20:51:09,484698 (MainThread): Acquiring new postgres connection "master".
2020-03-03 20:51:09,484788 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:51:09,568740 (MainThread): Using postgres connection "master".
2020-03-03 20:51:09,568897 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 20:51:09,577070 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 20:51:09,620009 (MainThread): Using postgres connection "master".
2020-03-03 20:51:09,620143 (MainThread): On master: BEGIN
2020-03-03 20:51:09,622570 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:51:09,622752 (MainThread): Using postgres connection "master".
2020-03-03 20:51:09,622888 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 20:51:09,628742 (MainThread): SQL status: SELECT 7 in 0.01 seconds
2020-03-03 20:51:09,671173 (MainThread): Using postgres connection "master".
2020-03-03 20:51:09,671339 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 20:51:09,685439 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 20:51:09,688942 (MainThread): On master: ROLLBACK
2020-03-03 20:51:09,689221 (MainThread): Using postgres connection "master".
2020-03-03 20:51:09,689334 (MainThread): On master: BEGIN
2020-03-03 20:51:09,689787 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:51:09,689890 (MainThread): On master: COMMIT
2020-03-03 20:51:09,689972 (MainThread): Using postgres connection "master".
2020-03-03 20:51:09,690042 (MainThread): On master: COMMIT
2020-03-03 20:51:09,690250 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 20:51:09,690492 (MainThread): 14:51:09 | Concurrency: 1 threads (target='dev')
2020-03-03 20:51:09,690624 (MainThread): 14:51:09 | 
2020-03-03 20:51:09,692981 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 20:51:09,693173 (Thread-1): 14:51:09 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 20:51:09,693472 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 20:51:09,693557 (Thread-1): Opening a new connection, currently in state init
2020-03-03 20:51:09,693645 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 20:51:09,707654 (Thread-1): finished collecting timing info
2020-03-03 20:51:09,708066 (Thread-1): Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  'ad' is undefined
Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 358, in render_template
    return template.render(ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 10, in top-level template code
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/sandbox.py", line 407, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'ad' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 218, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 155, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 322, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/compilation.py", line 234, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/compilation.py", line 136, in compile_node
    node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 371, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 363, in render_template
    dbt.exceptions.raise_compiler_error(str(e), node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  'ad' is undefined
2020-03-03 20:51:09,717237 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb6165a-073d-48b4-8bd3-47ccc2762210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a65780>]}
2020-03-03 20:51:09,840217 (Thread-1): 14:51:09 | 1 of 4 ERROR creating view model public.fact_daily_performance....... [ERROR in 0.02s]
2020-03-03 20:51:09,840585 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 20:51:09,840853 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 20:51:09,841289 (Thread-1): 14:51:09 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 20:51:09,841977 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:51:09,842151 (Thread-1): Opening a new connection, currently in state init
2020-03-03 20:51:09,842309 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 20:51:09,850681 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 20:51:09,851252 (Thread-1): finished collecting timing info
2020-03-03 20:51:09,870218 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:51:09,870383 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 20:51:09,876011 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-03-03 20:51:09,878315 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:51:09,878447 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 20:51:09,878731 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:51:09,893023 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:51:09,893185 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 20:51:09,893668 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:51:09,893799 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:51:09,894017 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 20:51:09,903987 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-03 20:51:09,905567 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 20:51:09,906163 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:51:09,906427 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
2020-03-03 20:51:09,908463 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 20:51:09,913097 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:51:09,913249 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 20:51:09,913736 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 20:51:09,916589 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:51:09,916716 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 20:51:09,917345 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 20:51:09,918624 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:51:09,918723 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 20:51:09,919601 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 20:51:09,920288 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 20:51:09,920384 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:51:09,920457 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 20:51:09,922990 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 20:51:09,924596 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:51:09,924703 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 20:51:09,926132 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:51:09,928207 (Thread-1): finished collecting timing info
2020-03-03 20:51:09,929086 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb6165a-073d-48b4-8bd3-47ccc2762210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059fd1d0>]}
2020-03-03 20:51:10,50673 (Thread-1): 14:51:10 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2020-03-03 20:51:10,50914 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 20:51:10,51160 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 20:51:10,51340 (Thread-1): 14:51:10 | 3 of 4 SKIP relation public.fact_monthly_performance................. [SKIP]
2020-03-03 20:51:10,51604 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 20:51:10,51894 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 20:51:10,52066 (Thread-1): 14:51:10 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 20:51:10,52483 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:51:10,52593 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 20:51:10,52691 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 20:51:10,60374 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 20:51:10,62110 (Thread-1): finished collecting timing info
2020-03-03 20:51:10,68603 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:51:10,68739 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 20:51:10,69141 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:51:10,71227 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:51:10,71345 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 20:51:10,71674 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:51:10,72990 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:51:10,73085 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 20:51:10,73341 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:51:10,73439 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:51:10,73513 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 20:51:10,77005 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 20:51:10,78274 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 20:51:10,78919 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:51:10,79109 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 20:51:10,80753 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 20:51:10,84356 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:51:10,84488 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 20:51:10,85039 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 20:51:10,87218 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:51:10,87346 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 20:51:10,87886 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 20:51:10,89226 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:51:10,89476 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 20:51:10,89849 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 20:51:10,90521 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 20:51:10,90616 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:51:10,90691 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 20:51:10,91994 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 20:51:10,93439 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:51:10,93535 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 20:51:10,94939 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:51:10,98814 (Thread-1): finished collecting timing info
2020-03-03 20:51:10,99970 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb6165a-073d-48b4-8bd3-47ccc2762210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109651668>]}
2020-03-03 20:51:10,227040 (Thread-1): 14:51:10 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.05s]
2020-03-03 20:51:10,227395 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 20:51:10,312581 (MainThread): Using postgres connection "master".
2020-03-03 20:51:10,312949 (MainThread): On master: BEGIN
2020-03-03 20:51:10,313670 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:51:10,313990 (MainThread): On master: COMMIT
2020-03-03 20:51:10,314226 (MainThread): Using postgres connection "master".
2020-03-03 20:51:10,314436 (MainThread): On master: COMMIT
2020-03-03 20:51:10,315034 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 20:51:10,315747 (MainThread): 14:51:10 | 
2020-03-03 20:51:10,316091 (MainThread): 14:51:10 | Finished running 2 view models, 2 table models in 0.83s.
2020-03-03 20:51:10,316463 (MainThread): Connection 'master' was left open.
2020-03-03 20:51:10,316941 (MainThread): On master: Close
2020-03-03 20:51:10,317355 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 20:51:10,317601 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 20:51:10,332147 (MainThread): 
2020-03-03 20:51:10,332337 (MainThread): Completed with 1 error and 0 warnings:
2020-03-03 20:51:10,332508 (MainThread): 
2020-03-03 20:51:10,332669 (MainThread): Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
2020-03-03 20:51:10,333149 (MainThread):   'ad' is undefined
2020-03-03 20:51:10,333274 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-03-03 20:51:10,333471 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad8f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5ef98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059fd550>]}
2020-03-03 20:51:10,459486 (MainThread): Flushing usage events
2020-03-03 20:56:17,554431 (MainThread): Running with dbt=0.15.2
2020-03-03 20:56:17,659346 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 20:56:17,660246 (MainThread): Tracking: tracking
2020-03-03 20:56:17,669057 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107818ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fbb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107818390>]}
2020-03-03 20:56:17,872835 (MainThread): Partial parsing not enabled
2020-03-03 20:56:17,876147 (MainThread): Parsing macros/core.sql
2020-03-03 20:56:17,879989 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 20:56:17,885600 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 20:56:17,887480 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 20:56:17,901051 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 20:56:17,915475 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 20:56:17,929235 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 20:56:17,931135 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 20:56:17,936539 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 20:56:17,942580 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 20:56:17,947690 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 20:56:17,952623 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 20:56:17,956781 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 20:56:17,957974 (MainThread): Parsing macros/etc/query.sql
2020-03-03 20:56:17,959385 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 20:56:17,961230 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 20:56:17,963433 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 20:56:17,970260 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 20:56:17,972386 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 20:56:17,994495 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 20:56:17,995919 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 20:56:17,997023 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 20:56:17,998368 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 20:56:18,732 (MainThread): Parsing macros/catalog.sql
2020-03-03 20:56:18,2867 (MainThread): Parsing macros/relations.sql
2020-03-03 20:56:18,4242 (MainThread): Parsing macros/adapters.sql
2020-03-03 20:56:18,13425 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 20:56:18,33940 (MainThread): Partial parsing not enabled
2020-03-03 20:56:18,34458 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-03 20:56:18,50309 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:56:18,50447 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:56:18,66479 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:56:18,66607 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:56:18,72760 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 20:56:18,72884 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:56:18,79204 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 20:56:18,79334 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:56:18,118603 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 20:56:18,118737 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:56:18,130127 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 20:56:18,130256 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:56:18,140370 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 20:56:18,140500 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:56:18,148266 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 20:56:18,148397 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:56:18,159823 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 20:56:18,159954 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:56:18,167782 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 20:56:18,167908 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:56:18,239343 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 20:56:18,245664 (MainThread): 
2020-03-03 20:56:18,246042 (MainThread): Acquiring new postgres connection "master".
2020-03-03 20:56:18,246139 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:56:18,333851 (MainThread): Using postgres connection "master".
2020-03-03 20:56:18,334008 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 20:56:18,340966 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 20:56:18,383398 (MainThread): Using postgres connection "master".
2020-03-03 20:56:18,383529 (MainThread): On master: BEGIN
2020-03-03 20:56:18,385892 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:56:18,386076 (MainThread): Using postgres connection "master".
2020-03-03 20:56:18,386205 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 20:56:18,390411 (MainThread): SQL status: SELECT 7 in 0.00 seconds
2020-03-03 20:56:18,433403 (MainThread): Using postgres connection "master".
2020-03-03 20:56:18,433537 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 20:56:18,447797 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 20:56:18,451500 (MainThread): On master: ROLLBACK
2020-03-03 20:56:18,451895 (MainThread): Using postgres connection "master".
2020-03-03 20:56:18,452017 (MainThread): On master: BEGIN
2020-03-03 20:56:18,452414 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:56:18,452517 (MainThread): On master: COMMIT
2020-03-03 20:56:18,452599 (MainThread): Using postgres connection "master".
2020-03-03 20:56:18,452667 (MainThread): On master: COMMIT
2020-03-03 20:56:18,452921 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 20:56:18,453212 (MainThread): 14:56:18 | Concurrency: 1 threads (target='dev')
2020-03-03 20:56:18,453346 (MainThread): 14:56:18 | 
2020-03-03 20:56:18,455319 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 20:56:18,455506 (Thread-1): 14:56:18 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 20:56:18,455842 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 20:56:18,455939 (Thread-1): Opening a new connection, currently in state init
2020-03-03 20:56:18,456033 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 20:56:18,469508 (Thread-1): finished collecting timing info
2020-03-03 20:56:18,469925 (Thread-1): Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  'ad' is undefined
Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 358, in render_template
    return template.render(ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 10, in top-level template code
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/sandbox.py", line 407, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'ad' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 218, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 155, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 322, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/compilation.py", line 234, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/compilation.py", line 136, in compile_node
    node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 371, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 363, in render_template
    dbt.exceptions.raise_compiler_error(str(e), node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  'ad' is undefined
2020-03-03 20:56:18,477509 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba4fd95-1587-47f3-ad1e-92c14d73c9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f9c630>]}
2020-03-03 20:56:18,607737 (Thread-1): 14:56:18 | 1 of 4 ERROR creating view model public.fact_daily_performance....... [ERROR in 0.02s]
2020-03-03 20:56:18,608039 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 20:56:18,608349 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 20:56:18,608899 (Thread-1): 14:56:18 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 20:56:18,609369 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:56:18,609518 (Thread-1): Opening a new connection, currently in state init
2020-03-03 20:56:18,609666 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 20:56:18,617549 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 20:56:18,620213 (Thread-1): finished collecting timing info
2020-03-03 20:56:18,638632 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:56:18,638772 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 20:56:18,644721 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-03-03 20:56:18,647271 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:56:18,647456 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 20:56:18,647843 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:56:18,663468 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:56:18,663781 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 20:56:18,664098 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:56:18,664202 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:56:18,664277 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 20:56:18,677533 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-03 20:56:18,679752 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 20:56:18,680456 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:56:18,680764 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
2020-03-03 20:56:18,682634 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 20:56:18,686323 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:56:18,686449 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 20:56:18,687061 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 20:56:18,689723 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:56:18,689839 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 20:56:18,690522 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 20:56:18,691926 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:56:18,692030 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 20:56:18,692763 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 20:56:18,693414 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 20:56:18,693508 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:56:18,693580 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 20:56:18,695835 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 20:56:18,697525 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:56:18,697700 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 20:56:18,699332 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:56:18,702661 (Thread-1): finished collecting timing info
2020-03-03 20:56:18,703476 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba4fd95-1587-47f3-ad1e-92c14d73c9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be4358>]}
2020-03-03 20:56:18,824543 (Thread-1): 14:56:18 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2020-03-03 20:56:18,824760 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 20:56:18,824963 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 20:56:18,825219 (Thread-1): 14:56:18 | 3 of 4 SKIP relation public.fact_monthly_performance................. [SKIP]
2020-03-03 20:56:18,825480 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 20:56:18,825712 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 20:56:18,825870 (Thread-1): 14:56:18 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 20:56:18,826210 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:56:18,826323 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 20:56:18,826422 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 20:56:18,835681 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 20:56:18,836235 (Thread-1): finished collecting timing info
2020-03-03 20:56:18,843992 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:56:18,844277 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 20:56:18,844639 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:56:18,846779 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:56:18,846901 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 20:56:18,847225 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:56:18,848635 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:56:18,848747 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 20:56:18,849075 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:56:18,849185 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:56:18,849262 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 20:56:18,852431 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 20:56:18,853830 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 20:56:18,854562 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:56:18,854753 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 20:56:18,856303 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 20:56:18,859938 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:56:18,860079 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 20:56:18,860550 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 20:56:18,863685 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:56:18,863868 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 20:56:18,864631 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 20:56:18,866107 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:56:18,866365 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 20:56:18,866813 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 20:56:18,867693 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 20:56:18,867807 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:56:18,867886 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 20:56:18,869334 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 20:56:18,870803 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:56:18,870897 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 20:56:18,872140 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:56:18,874375 (Thread-1): finished collecting timing info
2020-03-03 20:56:18,875217 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba4fd95-1587-47f3-ad1e-92c14d73c9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff77f0>]}
2020-03-03 20:56:18,998893 (Thread-1): 14:56:18 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.05s]
2020-03-03 20:56:18,999183 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 20:56:19,78376 (MainThread): Using postgres connection "master".
2020-03-03 20:56:19,78723 (MainThread): On master: BEGIN
2020-03-03 20:56:19,79116 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:56:19,79227 (MainThread): On master: COMMIT
2020-03-03 20:56:19,79307 (MainThread): Using postgres connection "master".
2020-03-03 20:56:19,79377 (MainThread): On master: COMMIT
2020-03-03 20:56:19,79595 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 20:56:19,79865 (MainThread): 14:56:19 | 
2020-03-03 20:56:19,79978 (MainThread): 14:56:19 | Finished running 2 view models, 2 table models in 0.83s.
2020-03-03 20:56:19,80071 (MainThread): Connection 'master' was left open.
2020-03-03 20:56:19,80156 (MainThread): On master: Close
2020-03-03 20:56:19,80294 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 20:56:19,80405 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 20:56:19,90795 (MainThread): 
2020-03-03 20:56:19,91038 (MainThread): Completed with 1 error and 0 warnings:
2020-03-03 20:56:19,91160 (MainThread): 
2020-03-03 20:56:19,91276 (MainThread): Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
2020-03-03 20:56:19,91377 (MainThread):   'ad' is undefined
2020-03-03 20:56:19,91477 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-03-03 20:56:19,91663 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108535f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc9438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be45c0>]}
2020-03-03 20:56:19,214688 (MainThread): Flushing usage events
2020-03-03 20:59:52,616782 (MainThread): Running with dbt=0.15.2
2020-03-03 20:59:52,708081 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 20:59:52,708930 (MainThread): Tracking: tracking
2020-03-03 20:59:52,720772 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfb5f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfb5c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfc90b8>]}
2020-03-03 20:59:52,972283 (MainThread): Partial parsing not enabled
2020-03-03 20:59:53,77267 (MainThread): Parsing macros/core.sql
2020-03-03 20:59:53,81238 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 20:59:53,86990 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 20:59:53,88809 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 20:59:53,101697 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 20:59:53,217284 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 20:59:53,235874 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 20:59:53,237750 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 20:59:53,243159 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 20:59:53,251451 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 20:59:53,306677 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 20:59:53,312181 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 20:59:53,317039 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 20:59:53,319622 (MainThread): Parsing macros/etc/query.sql
2020-03-03 20:59:53,323023 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 20:59:53,326236 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 20:59:53,328821 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 20:59:53,335982 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 20:59:53,337972 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 20:59:53,363730 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 20:59:53,366649 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 20:59:53,368213 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 20:59:53,370000 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 20:59:53,373182 (MainThread): Parsing macros/catalog.sql
2020-03-03 20:59:53,375175 (MainThread): Parsing macros/relations.sql
2020-03-03 20:59:53,376495 (MainThread): Parsing macros/adapters.sql
2020-03-03 20:59:53,385980 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 20:59:53,412992 (MainThread): Partial parsing not enabled
2020-03-03 20:59:53,413467 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-03 20:59:53,433062 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:59:53,433316 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:59:53,452761 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:59:53,452885 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:59:53,462178 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 20:59:53,462309 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:59:53,469281 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 20:59:53,469450 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:59:53,514711 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 20:59:53,514852 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:59:53,527634 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 20:59:53,527758 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:59:53,540399 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 20:59:53,540528 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:59:53,549324 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 20:59:53,549451 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:59:53,561694 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 20:59:53,561856 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:59:53,571516 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 20:59:53,571640 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:59:53,655466 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 20:59:53,662990 (MainThread): 
2020-03-03 20:59:53,663342 (MainThread): Acquiring new postgres connection "master".
2020-03-03 20:59:53,663434 (MainThread): Opening a new connection, currently in state init
2020-03-03 20:59:53,756399 (MainThread): Using postgres connection "master".
2020-03-03 20:59:53,756543 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 20:59:53,763240 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 20:59:53,805192 (MainThread): Using postgres connection "master".
2020-03-03 20:59:53,805322 (MainThread): On master: BEGIN
2020-03-03 20:59:53,806426 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:59:53,806599 (MainThread): Using postgres connection "master".
2020-03-03 20:59:53,806715 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 20:59:53,810512 (MainThread): SQL status: SELECT 7 in 0.00 seconds
2020-03-03 20:59:53,851829 (MainThread): Using postgres connection "master".
2020-03-03 20:59:53,851958 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 20:59:53,865997 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 20:59:53,869585 (MainThread): On master: ROLLBACK
2020-03-03 20:59:53,869961 (MainThread): Using postgres connection "master".
2020-03-03 20:59:53,870047 (MainThread): On master: BEGIN
2020-03-03 20:59:53,870413 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:59:53,870503 (MainThread): On master: COMMIT
2020-03-03 20:59:53,870579 (MainThread): Using postgres connection "master".
2020-03-03 20:59:53,870644 (MainThread): On master: COMMIT
2020-03-03 20:59:53,870854 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 20:59:53,871092 (MainThread): 14:59:53 | Concurrency: 1 threads (target='dev')
2020-03-03 20:59:53,871218 (MainThread): 14:59:53 | 
2020-03-03 20:59:53,873563 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 20:59:53,873743 (Thread-1): 14:59:53 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 20:59:53,874045 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 20:59:53,874152 (Thread-1): Opening a new connection, currently in state init
2020-03-03 20:59:53,874249 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 20:59:53,887781 (Thread-1): finished collecting timing info
2020-03-03 20:59:53,888189 (Thread-1): Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  'ad' is undefined
Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 358, in render_template
    return template.render(ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 10, in top-level template code
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/sandbox.py", line 407, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'ad' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 218, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 155, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 322, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/compilation.py", line 234, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/compilation.py", line 136, in compile_node
    node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 371, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 363, in render_template
    dbt.exceptions.raise_compiler_error(str(e), node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  'ad' is undefined
2020-03-03 20:59:53,895489 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3456d47-d5c6-4f20-bda7-1adec9de574b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e13a8d0>]}
2020-03-03 20:59:54,24243 (Thread-1): 14:59:54 | 1 of 4 ERROR creating view model public.fact_daily_performance....... [ERROR in 0.02s]
2020-03-03 20:59:54,24551 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 20:59:54,24876 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 20:59:54,25130 (Thread-1): 14:59:54 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 20:59:54,25648 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:59:54,26047 (Thread-1): Opening a new connection, currently in state init
2020-03-03 20:59:54,26393 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 20:59:54,34082 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 20:59:54,34771 (Thread-1): finished collecting timing info
2020-03-03 20:59:54,52688 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:59:54,52827 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 20:59:54,58362 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-03-03 20:59:54,60885 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:59:54,61022 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 20:59:54,61323 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:59:54,76065 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:59:54,76223 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 20:59:54,76637 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:59:54,76824 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:59:54,76962 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 20:59:54,82750 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-03 20:59:54,84121 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 20:59:54,84611 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:59:54,84917 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
2020-03-03 20:59:54,86629 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 20:59:54,90778 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:59:54,90908 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 20:59:54,91477 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 20:59:54,96012 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:59:54,96188 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 20:59:54,96971 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 20:59:54,98901 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:59:54,99058 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 20:59:54,99997 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 20:59:54,101032 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 20:59:54,101188 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:59:54,101294 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 20:59:54,103054 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 20:59:54,105435 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 20:59:54,105612 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 20:59:54,107025 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:59:54,110721 (Thread-1): finished collecting timing info
2020-03-03 20:59:54,111790 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3456d47-d5c6-4f20-bda7-1adec9de574b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1c2390>]}
2020-03-03 20:59:54,236054 (Thread-1): 14:59:54 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2020-03-03 20:59:54,236402 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 20:59:54,236683 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 20:59:54,236968 (Thread-1): 14:59:54 | 3 of 4 SKIP relation public.fact_monthly_performance................. [SKIP]
2020-03-03 20:59:54,237288 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 20:59:54,237454 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 20:59:54,237717 (Thread-1): 14:59:54 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 20:59:54,238112 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:59:54,238227 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 20:59:54,238338 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 20:59:54,248228 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 20:59:54,248793 (Thread-1): finished collecting timing info
2020-03-03 20:59:54,262027 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:59:54,262242 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 20:59:54,262647 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:59:54,265303 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:59:54,265531 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 20:59:54,265859 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:59:54,267444 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:59:54,267623 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 20:59:54,267877 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:59:54,267979 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:59:54,268054 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 20:59:54,271250 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 20:59:54,273365 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 20:59:54,274146 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:59:54,274368 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 20:59:54,277074 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 20:59:54,281437 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:59:54,281610 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 20:59:54,282142 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 20:59:54,284550 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:59:54,284687 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 20:59:54,285304 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 20:59:54,287326 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:59:54,287679 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 20:59:54,288295 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 20:59:54,289109 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 20:59:54,289239 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:59:54,289326 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 20:59:54,290808 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 20:59:54,294120 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 20:59:54,294291 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 20:59:54,295730 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 20:59:54,299651 (Thread-1): finished collecting timing info
2020-03-03 20:59:54,300731 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3456d47-d5c6-4f20-bda7-1adec9de574b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11261b630>]}
2020-03-03 20:59:54,420286 (Thread-1): 14:59:54 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.06s]
2020-03-03 20:59:54,420911 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 20:59:54,485090 (MainThread): Using postgres connection "master".
2020-03-03 20:59:54,485255 (MainThread): On master: BEGIN
2020-03-03 20:59:54,485550 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 20:59:54,485696 (MainThread): On master: COMMIT
2020-03-03 20:59:54,485912 (MainThread): Using postgres connection "master".
2020-03-03 20:59:54,486026 (MainThread): On master: COMMIT
2020-03-03 20:59:54,486240 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 20:59:54,486498 (MainThread): 14:59:54 | 
2020-03-03 20:59:54,486624 (MainThread): 14:59:54 | Finished running 2 view models, 2 table models in 0.82s.
2020-03-03 20:59:54,486737 (MainThread): Connection 'master' was left open.
2020-03-03 20:59:54,486817 (MainThread): On master: Close
2020-03-03 20:59:54,486985 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 20:59:54,487115 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 20:59:54,498176 (MainThread): 
2020-03-03 20:59:54,498894 (MainThread): Completed with 1 error and 0 warnings:
2020-03-03 20:59:54,499108 (MainThread): 
2020-03-03 20:59:54,499278 (MainThread): Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
2020-03-03 20:59:54,499433 (MainThread):   'ad' is undefined
2020-03-03 20:59:54,499578 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-03-03 20:59:54,500184 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1c2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1e8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1e8cf8>]}
2020-03-03 20:59:54,623777 (MainThread): Flushing usage events
2020-03-03 21:00:41,408726 (MainThread): Running with dbt=0.15.2
2020-03-03 21:00:41,521375 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', show=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2020-03-03 21:00:41,522604 (MainThread): Tracking: tracking
2020-03-03 21:00:41,535477 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd156d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd15208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a373c50>]}
2020-03-03 21:00:41,693838 (MainThread): Partial parsing not enabled
2020-03-03 21:00:41,695808 (MainThread): Parsing macros/core.sql
2020-03-03 21:00:41,700479 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 21:00:41,706971 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 21:00:41,708710 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 21:00:41,723969 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 21:00:41,744102 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 21:00:41,760440 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 21:00:41,762428 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 21:00:41,768607 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 21:00:41,775775 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 21:00:41,781369 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 21:00:41,786799 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 21:00:41,791649 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 21:00:41,793050 (MainThread): Parsing macros/etc/query.sql
2020-03-03 21:00:41,794349 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 21:00:41,796892 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 21:00:41,799193 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 21:00:41,807179 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 21:00:41,809403 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 21:00:41,835294 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 21:00:41,836627 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 21:00:41,837673 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 21:00:41,838788 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 21:00:41,841270 (MainThread): Parsing macros/catalog.sql
2020-03-03 21:00:41,843063 (MainThread): Parsing macros/relations.sql
2020-03-03 21:00:41,844350 (MainThread): Parsing macros/adapters.sql
2020-03-03 21:00:41,854561 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 21:00:41,874626 (MainThread): Partial parsing not enabled
2020-03-03 21:00:41,874970 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-03 21:00:41,889067 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:00:41,889192 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:41,904363 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:00:41,904488 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:41,910271 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:00:41,910385 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:41,916058 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:00:41,916164 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:41,952958 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:00:41,953092 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:41,964221 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:00:41,964414 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:41,975043 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:00:41,975171 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:41,983003 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:00:41,983151 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:41,993781 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:00:41,993901 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:42,1565 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:00:42,1741 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:42,70473 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 21:00:42,75852 (MainThread): 
2020-03-03 21:00:42,76213 (MainThread): Acquiring new postgres connection "master".
2020-03-03 21:00:42,76312 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:42,156935 (MainThread): Using postgres connection "master".
2020-03-03 21:00:42,157092 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 21:00:42,163060 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 21:00:42,205400 (MainThread): Using postgres connection "master".
2020-03-03 21:00:42,205532 (MainThread): On master: BEGIN
2020-03-03 21:00:42,205912 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:00:42,206008 (MainThread): Using postgres connection "master".
2020-03-03 21:00:42,206079 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 21:00:42,209338 (MainThread): SQL status: SELECT 7 in 0.00 seconds
2020-03-03 21:00:42,274361 (MainThread): Using postgres connection "master".
2020-03-03 21:00:42,274575 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 21:00:42,290785 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2020-03-03 21:00:42,297586 (MainThread): On master: ROLLBACK
2020-03-03 21:00:42,297958 (MainThread): Using postgres connection "master".
2020-03-03 21:00:42,298111 (MainThread): On master: BEGIN
2020-03-03 21:00:42,298516 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:00:42,298692 (MainThread): On master: COMMIT
2020-03-03 21:00:42,298816 (MainThread): Using postgres connection "master".
2020-03-03 21:00:42,299031 (MainThread): On master: COMMIT
2020-03-03 21:00:42,299294 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:00:42,299716 (MainThread): 15:00:42 | Concurrency: 1 threads (target='dev')
2020-03-03 21:00:42,299905 (MainThread): 15:00:42 | 
2020-03-03 21:00:42,301898 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-03 21:00:42,302186 (Thread-1): 15:00:42 | 1 of 2 START seed file public.ad_account_metrics..................... [RUN]
2020-03-03 21:00:42,302593 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 21:00:42,302742 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:00:42,302907 (Thread-1): finished collecting timing info
2020-03-03 21:00:42,376337 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 21:00:42,376501 (Thread-1): On seed.civis_platform.ad_account_metrics: BEGIN
2020-03-03 21:00:42,382442 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-03-03 21:00:42,382589 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 21:00:42,382666 (Thread-1): On seed.civis_platform.ad_account_metrics: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "seed.civis_platform.ad_account_metrics"} */
truncate table "dbryan"."public"."ad_account_metrics"
2020-03-03 21:00:42,383832 (Thread-1): SQL status: TRUNCATE TABLE in 0.00 seconds
2020-03-03 21:00:42,385199 (Thread-1): * Deprecation Warning: 
    The quote_columns parameter was not set for seeds, so the default value of
    False was chosen. The default will change to True in a future release.

    For more information, see:
    https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
    

2020-03-03 21:00:42,385773 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 21:00:42,385874 (Thread-1): On seed.civis_platform.ad_account_metrics: 
            insert into "dbryan"."public"."ad_account_metrics" (date, impressions, clicks, spend) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
        ...
2020-03-03 21:00:42,387175 (Thread-1): SQL status: INSERT 0 7 in 0.00 seconds
2020-03-03 21:00:42,387509 (Thread-1): Writing runtime SQL for node "seed.civis_platform.ad_account_metrics"
2020-03-03 21:00:42,389407 (Thread-1): On seed.civis_platform.ad_account_metrics: COMMIT
2020-03-03 21:00:42,389561 (Thread-1): Using postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 21:00:42,389647 (Thread-1): On seed.civis_platform.ad_account_metrics: COMMIT
2020-03-03 21:00:42,390980 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:00:42,394823 (Thread-1): finished collecting timing info
2020-03-03 21:00:42,395460 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5828965-d106-41b1-b487-22b2563b8202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4cbc50>]}
2020-03-03 21:00:42,519617 (Thread-1): 15:00:42 | 1 of 2 OK loaded seed file public.ad_account_metrics................. [INSERT 7 in 0.09s]
2020-03-03 21:00:42,519903 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-03 21:00:42,520209 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-03 21:00:42,520568 (Thread-1): 15:00:42 | 2 of 2 START seed file public.dim_date............................... [RUN]
2020-03-03 21:00:42,521033 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-03 21:00:42,521187 (Thread-1): Re-using an available connection from the pool (formerly seed.civis_platform.ad_account_metrics).
2020-03-03 21:00:42,521343 (Thread-1): finished collecting timing info
2020-03-03 21:00:42,531476 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-03 21:00:42,531634 (Thread-1): On seed.civis_platform.dim_date: BEGIN
2020-03-03 21:00:42,532135 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:00:42,532251 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-03 21:00:42,532334 (Thread-1): On seed.civis_platform.dim_date: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "seed.civis_platform.dim_date"} */
truncate table "dbryan"."public"."dim_date"
2020-03-03 21:00:42,532921 (Thread-1): SQL status: TRUNCATE TABLE in 0.00 seconds
2020-03-03 21:00:42,534337 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-03 21:00:42,534433 (Thread-1): On seed.civis_platform.dim_date: 
            insert into "dbryan"."public"."dim_date" (date_id, date, dow, business_day) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
        ...
2020-03-03 21:00:42,535200 (Thread-1): SQL status: INSERT 0 7 in 0.00 seconds
2020-03-03 21:00:42,535447 (Thread-1): Writing runtime SQL for node "seed.civis_platform.dim_date"
2020-03-03 21:00:42,538257 (Thread-1): On seed.civis_platform.dim_date: COMMIT
2020-03-03 21:00:42,538479 (Thread-1): Using postgres connection "seed.civis_platform.dim_date".
2020-03-03 21:00:42,538663 (Thread-1): On seed.civis_platform.dim_date: COMMIT
2020-03-03 21:00:42,539714 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:00:42,543130 (Thread-1): finished collecting timing info
2020-03-03 21:00:42,544054 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5828965-d106-41b1-b487-22b2563b8202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5700b8>]}
2020-03-03 21:00:42,659632 (Thread-1): 15:00:42 | 2 of 2 OK loaded seed file public.dim_date........................... [INSERT 7 in 0.02s]
2020-03-03 21:00:42,659826 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-03 21:00:42,705143 (MainThread): Using postgres connection "master".
2020-03-03 21:00:42,705292 (MainThread): On master: BEGIN
2020-03-03 21:00:42,705530 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:00:42,705627 (MainThread): On master: COMMIT
2020-03-03 21:00:42,705702 (MainThread): Using postgres connection "master".
2020-03-03 21:00:42,705779 (MainThread): On master: COMMIT
2020-03-03 21:00:42,706020 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:00:42,706263 (MainThread): 15:00:42 | 
2020-03-03 21:00:42,706380 (MainThread): 15:00:42 | Finished running 2 seeds in 0.63s.
2020-03-03 21:00:42,706545 (MainThread): Connection 'master' was left open.
2020-03-03 21:00:42,706659 (MainThread): On master: Close
2020-03-03 21:00:42,706772 (MainThread): Connection 'seed.civis_platform.dim_date' was left open.
2020-03-03 21:00:42,706878 (MainThread): On seed.civis_platform.dim_date: Close
2020-03-03 21:00:42,713819 (MainThread): 
2020-03-03 21:00:42,714139 (MainThread): Completed successfully
2020-03-03 21:00:42,714718 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-03-03 21:00:42,715164 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec36ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5248d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a587c50>]}
2020-03-03 21:00:42,840268 (MainThread): Flushing usage events
2020-03-03 21:00:49,813228 (MainThread): Running with dbt=0.15.2
2020-03-03 21:00:49,903870 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 21:00:49,904521 (MainThread): Tracking: tracking
2020-03-03 21:00:49,912432 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bce940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bf7ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bce470>]}
2020-03-03 21:00:50,68392 (MainThread): Partial parsing not enabled
2020-03-03 21:00:50,70389 (MainThread): Parsing macros/core.sql
2020-03-03 21:00:50,74803 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 21:00:50,80860 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 21:00:50,82541 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 21:00:50,98184 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 21:00:50,116559 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 21:00:50,131979 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 21:00:50,133583 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 21:00:50,138663 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 21:00:50,144190 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 21:00:50,149008 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 21:00:50,153477 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 21:00:50,157281 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 21:00:50,158115 (MainThread): Parsing macros/etc/query.sql
2020-03-03 21:00:50,159125 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 21:00:50,160480 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 21:00:50,162112 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 21:00:50,168236 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 21:00:50,169808 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 21:00:50,191337 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 21:00:50,192337 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 21:00:50,193130 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 21:00:50,194016 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 21:00:50,195953 (MainThread): Parsing macros/catalog.sql
2020-03-03 21:00:50,197284 (MainThread): Parsing macros/relations.sql
2020-03-03 21:00:50,198284 (MainThread): Parsing macros/adapters.sql
2020-03-03 21:00:50,206668 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 21:00:50,224393 (MainThread): Partial parsing not enabled
2020-03-03 21:00:50,224729 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-03 21:00:50,240681 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:00:50,240828 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:50,257549 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:00:50,257687 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:50,263708 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:00:50,263842 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:50,270674 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:00:50,270820 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:50,312027 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:00:50,312232 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:50,327929 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:00:50,328066 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:50,337997 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:00:50,338124 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:50,345817 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:00:50,345955 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:50,357050 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:00:50,357185 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:50,364963 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:00:50,365099 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:50,435499 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 21:00:50,440895 (MainThread): 
2020-03-03 21:00:50,441363 (MainThread): Acquiring new postgres connection "master".
2020-03-03 21:00:50,441519 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:00:50,522835 (MainThread): Using postgres connection "master".
2020-03-03 21:00:50,522996 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 21:00:50,529045 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 21:00:50,572454 (MainThread): Using postgres connection "master".
2020-03-03 21:00:50,572593 (MainThread): On master: BEGIN
2020-03-03 21:00:50,572984 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:00:50,573081 (MainThread): Using postgres connection "master".
2020-03-03 21:00:50,573154 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 21:00:50,576387 (MainThread): SQL status: SELECT 7 in 0.00 seconds
2020-03-03 21:00:50,616945 (MainThread): Using postgres connection "master".
2020-03-03 21:00:50,617076 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 21:00:50,630819 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 21:00:50,634248 (MainThread): On master: ROLLBACK
2020-03-03 21:00:50,634624 (MainThread): Using postgres connection "master".
2020-03-03 21:00:50,634709 (MainThread): On master: BEGIN
2020-03-03 21:00:50,635108 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:00:50,635209 (MainThread): On master: COMMIT
2020-03-03 21:00:50,635289 (MainThread): Using postgres connection "master".
2020-03-03 21:00:50,635358 (MainThread): On master: COMMIT
2020-03-03 21:00:50,635640 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:00:50,635919 (MainThread): 15:00:50 | Concurrency: 1 threads (target='dev')
2020-03-03 21:00:50,636044 (MainThread): 15:00:50 | 
2020-03-03 21:00:50,637803 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 21:00:50,637972 (Thread-1): 15:00:50 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 21:00:50,638275 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:00:50,638370 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:00:50,638464 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 21:00:50,666220 (Thread-1): finished collecting timing info
2020-03-03 21:00:50,667398 (Thread-1): Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  'ad' is undefined
Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 358, in render_template
    return template.render(ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 10, in top-level template code
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/sandbox.py", line 407, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'ad' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 218, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 155, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 322, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/compilation.py", line 234, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/compilation.py", line 136, in compile_node
    node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 371, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 363, in render_template
    dbt.exceptions.raise_compiler_error(str(e), node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  'ad' is undefined
2020-03-03 21:00:50,669814 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe8d7eb-7ed4-4be3-8726-aead3f2bb4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e46c160>]}
2020-03-03 21:00:50,793119 (Thread-1): 15:00:50 | 1 of 4 ERROR creating view model public.fact_daily_performance....... [ERROR in 0.03s]
2020-03-03 21:00:50,793956 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 21:00:50,794322 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 21:00:50,794759 (Thread-1): 15:00:50 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 21:00:50,795150 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:00:50,795261 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:00:50,795361 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 21:00:50,802334 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 21:00:50,803118 (Thread-1): finished collecting timing info
2020-03-03 21:00:50,826019 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:00:50,826162 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 21:00:50,832446 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-03-03 21:00:50,835198 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:00:50,835341 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 21:00:50,835605 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:00:50,854007 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:00:50,854173 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 21:00:50,854547 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:00:50,854653 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:00:50,854724 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 21:00:50,859830 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-03 21:00:50,861135 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 21:00:50,861605 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:00:50,861960 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
2020-03-03 21:00:50,863766 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 21:00:50,868391 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:00:50,869011 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 21:00:50,869611 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:00:50,872940 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:00:50,873070 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 21:00:50,873690 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:00:50,875223 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:00:50,875335 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 21:00:50,876053 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 21:00:50,876818 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 21:00:50,877577 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:00:50,877773 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 21:00:50,879318 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:00:50,881094 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:00:50,881213 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 21:00:50,882354 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:00:50,884746 (Thread-1): finished collecting timing info
2020-03-03 21:00:50,885417 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe8d7eb-7ed4-4be3-8726-aead3f2bb4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f8ee10>]}
2020-03-03 21:00:51,7052 (Thread-1): 15:00:51 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2020-03-03 21:00:51,7255 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 21:00:51,7480 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 21:00:51,7750 (Thread-1): 15:00:51 | 3 of 4 SKIP relation public.fact_monthly_performance................. [SKIP]
2020-03-03 21:00:51,8004 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 21:00:51,8180 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 21:00:51,8374 (Thread-1): 15:00:51 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 21:00:51,8673 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:00:51,8766 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 21:00:51,8852 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 21:00:51,18737 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 21:00:51,19236 (Thread-1): finished collecting timing info
2020-03-03 21:00:51,27636 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:00:51,27808 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 21:00:51,28252 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:00:51,30514 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:00:51,30737 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 21:00:51,31017 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:00:51,32595 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:00:51,32720 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 21:00:51,32909 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:00:51,32994 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:00:51,33063 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 21:00:51,36102 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 21:00:51,37608 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 21:00:51,38106 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:00:51,38420 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 21:00:51,40275 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 21:00:51,45960 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:00:51,46137 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 21:00:51,46791 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:00:51,51197 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:00:51,51365 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 21:00:51,52160 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:00:51,53715 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:00:51,54028 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 21:00:51,54485 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 21:00:51,55446 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 21:00:51,55556 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:00:51,55630 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 21:00:51,56889 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:00:51,58613 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:00:51,58732 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 21:00:51,60164 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:00:51,64203 (Thread-1): finished collecting timing info
2020-03-03 21:00:51,65347 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe8d7eb-7ed4-4be3-8726-aead3f2bb4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3dc780>]}
2020-03-03 21:00:51,186660 (Thread-1): 15:00:51 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.06s]
2020-03-03 21:00:51,186859 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 21:00:51,255562 (MainThread): Using postgres connection "master".
2020-03-03 21:00:51,255891 (MainThread): On master: BEGIN
2020-03-03 21:00:51,256311 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:00:51,256507 (MainThread): On master: COMMIT
2020-03-03 21:00:51,256646 (MainThread): Using postgres connection "master".
2020-03-03 21:00:51,256768 (MainThread): On master: COMMIT
2020-03-03 21:00:51,257237 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:00:51,257896 (MainThread): 15:00:51 | 
2020-03-03 21:00:51,258201 (MainThread): 15:00:51 | Finished running 2 view models, 2 table models in 0.82s.
2020-03-03 21:00:51,258484 (MainThread): Connection 'master' was left open.
2020-03-03 21:00:51,258708 (MainThread): On master: Close
2020-03-03 21:00:51,258965 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 21:00:51,259173 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 21:00:51,274794 (MainThread): 
2020-03-03 21:00:51,275238 (MainThread): Completed with 1 error and 0 warnings:
2020-03-03 21:00:51,275501 (MainThread): 
2020-03-03 21:00:51,275833 (MainThread): Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
2020-03-03 21:00:51,276029 (MainThread):   'ad' is undefined
2020-03-03 21:00:51,276216 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-03-03 21:00:51,276529 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128ea400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3f2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3f2748>]}
2020-03-03 21:00:51,404459 (MainThread): Flushing usage events
2020-03-03 21:03:14,943348 (MainThread): Running with dbt=0.15.2
2020-03-03 21:03:15,43245 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-03-03 21:03:15,43872 (MainThread): Tracking: tracking
2020-03-03 21:03:15,59426 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad220b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107359160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073597f0>]}
2020-03-03 21:03:15,260817 (MainThread): Partial parsing not enabled
2020-03-03 21:03:15,263142 (MainThread): Parsing macros/core.sql
2020-03-03 21:03:15,267312 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 21:03:15,272657 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 21:03:15,274147 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 21:03:15,286712 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 21:03:15,302728 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 21:03:15,316149 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 21:03:15,317978 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 21:03:15,323130 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 21:03:15,328793 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 21:03:15,334407 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 21:03:15,339172 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 21:03:15,343273 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 21:03:15,344335 (MainThread): Parsing macros/etc/query.sql
2020-03-03 21:03:15,345836 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 21:03:15,348070 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 21:03:15,349915 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 21:03:15,356616 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 21:03:15,358740 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 21:03:15,381381 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 21:03:15,382605 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 21:03:15,383577 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 21:03:15,384640 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 21:03:15,386700 (MainThread): Parsing macros/catalog.sql
2020-03-03 21:03:15,388230 (MainThread): Parsing macros/relations.sql
2020-03-03 21:03:15,389366 (MainThread): Parsing macros/adapters.sql
2020-03-03 21:03:15,397787 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 21:03:15,419665 (MainThread): Partial parsing not enabled
2020-03-03 21:03:15,420100 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-03 21:03:15,434589 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:03:15,434721 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:15,454503 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:03:15,454655 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:15,460779 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:03:15,460914 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:15,467320 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:03:15,467456 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:15,509293 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:03:15,509443 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:15,525739 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:03:15,525905 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:15,541197 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:03:15,541375 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:15,551701 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:03:15,551841 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:15,563558 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:03:15,563712 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:15,571787 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:03:15,571944 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:15,654648 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 21:03:15,664650 (MainThread): 
2020-03-03 21:03:15,664861 (MainThread): 15:03:15 | Concurrency: 1 threads (target='dev')
2020-03-03 21:03:15,665000 (MainThread): 15:03:15 | 
2020-03-03 21:03:15,666712 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-03 21:03:15,667116 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 21:03:15,667223 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:15,667336 (Thread-1): Compiling seed.civis_platform.ad_account_metrics
2020-03-03 21:03:15,680384 (Thread-1): finished collecting timing info
2020-03-03 21:03:15,680731 (Thread-1): finished collecting timing info
2020-03-03 21:03:15,681192 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-03 21:03:15,681333 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-03 21:03:15,681686 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-03 21:03:15,681791 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:15,681875 (Thread-1): Compiling seed.civis_platform.dim_date
2020-03-03 21:03:15,687095 (Thread-1): finished collecting timing info
2020-03-03 21:03:15,687383 (Thread-1): finished collecting timing info
2020-03-03 21:03:15,687781 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-03 21:03:15,687915 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 21:03:15,688316 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:03:15,688450 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:15,688738 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 21:03:15,709460 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 21:03:15,710483 (Thread-1): finished collecting timing info
2020-03-03 21:03:15,711261 (Thread-1): finished collecting timing info
2020-03-03 21:03:15,712160 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 21:03:15,712508 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 21:03:15,713657 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:03:15,713882 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:15,714008 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 21:03:15,725564 (Thread-1): finished collecting timing info
2020-03-03 21:03:15,726010 (Thread-1): Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  'ad' is undefined
Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 358, in render_template
    return template.render(ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 10, in top-level template code
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/sandbox.py", line 407, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'ad' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 218, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 155, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 322, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/compilation.py", line 234, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/compilation.py", line 136, in compile_node
    node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 371, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 363, in render_template
    dbt.exceptions.raise_compiler_error(str(e), node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  'ad' is undefined
2020-03-03 21:03:15,728549 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 21:03:15,728686 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 21:03:15,728924 (MainThread): Connection 'test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_' was properly closed.
2020-03-03 21:03:15,729196 (MainThread): Connection 'model.civis_platform.fact_daily_performance' was properly closed.
2020-03-03 21:03:15,729357 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074989b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107571cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753d160>]}
2020-03-03 21:03:15,729427 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:03:15,729799 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:15,730353 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 21:03:15,737254 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 21:03:15,738420 (Thread-1): finished collecting timing info
2020-03-03 21:03:15,739112 (Thread-1): finished collecting timing info
2020-03-03 21:03:15,739853 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 21:03:15,740107 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:03:15,740598 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:03:15,740735 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:15,740889 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:03:15,753773 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-03 21:03:15,755618 (Thread-1): finished collecting timing info
2020-03-03 21:03:15,756203 (Thread-1): finished collecting timing info
2020-03-03 21:03:15,756853 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:03:15,757085 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:03:15,757478 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:03:15,757588 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:15,757672 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:03:15,765604 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-03 21:03:15,766534 (Thread-1): finished collecting timing info
2020-03-03 21:03:15,767129 (Thread-1): finished collecting timing info
2020-03-03 21:03:15,767919 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:03:15,861478 (MainThread): Flushing usage events
2020-03-03 21:03:15,861785 (MainThread): Connection 'test.civis_platform.unique_my_first_dbt_model_id' was properly closed.
2020-03-03 21:03:15,861990 (MainThread): Encountered an error:
2020-03-03 21:03:15,862167 (MainThread): Runtime Error
  Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
    'ad' is undefined
2020-03-03 21:03:15,866913 (MainThread): Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/main.py", line 80, in main
    results, succeeded = handle_and_check(args)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/main.py", line 158, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/main.py", line 210, in run_from_args
    results = task.run()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/task/runnable.py", line 315, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/task/runnable.py", line 281, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/task/runnable.py", line 227, in execute_nodes
    self.run_queue(pool)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/task/runnable.py", line 178, in run_queue
    self._raise_set_error()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/task/runnable.py", line 164, in _raise_set_error
    raise dbt.exceptions.RuntimeException(self._raise_next_tick)
dbt.exceptions.RuntimeException: Runtime Error
  Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
    'ad' is undefined

2020-03-03 21:03:35,920588 (MainThread): Running with dbt=0.15.2
2020-03-03 21:03:35,997245 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-03-03 21:03:35,997761 (MainThread): Tracking: tracking
2020-03-03 21:03:36,5199 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073767f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107376780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107376748>]}
2020-03-03 21:03:36,166127 (MainThread): Partial parsing not enabled
2020-03-03 21:03:36,167973 (MainThread): Parsing macros/core.sql
2020-03-03 21:03:36,172302 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 21:03:36,177589 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 21:03:36,179002 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 21:03:36,192117 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 21:03:36,206326 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 21:03:36,219578 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 21:03:36,221304 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 21:03:36,226449 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 21:03:36,232330 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 21:03:36,237231 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 21:03:36,242165 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 21:03:36,246193 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 21:03:36,247224 (MainThread): Parsing macros/etc/query.sql
2020-03-03 21:03:36,248336 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 21:03:36,250001 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 21:03:36,251826 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 21:03:36,258395 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 21:03:36,260526 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 21:03:36,283332 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 21:03:36,284575 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 21:03:36,285561 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 21:03:36,286643 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 21:03:36,288782 (MainThread): Parsing macros/catalog.sql
2020-03-03 21:03:36,290343 (MainThread): Parsing macros/relations.sql
2020-03-03 21:03:36,291690 (MainThread): Parsing macros/adapters.sql
2020-03-03 21:03:36,301912 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 21:03:36,320061 (MainThread): Partial parsing not enabled
2020-03-03 21:03:36,320463 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-03 21:03:36,334761 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:03:36,334893 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:36,350550 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:03:36,350680 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:36,356732 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:03:36,356853 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:36,362920 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:03:36,363041 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:36,398991 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:03:36,399136 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:36,409944 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:03:36,410069 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:36,420047 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:03:36,420176 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:36,427628 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:03:36,427763 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:36,438585 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:03:36,438709 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:36,446212 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:03:36,446333 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:03:36,518968 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 21:03:36,526790 (MainThread): 
2020-03-03 21:03:36,527067 (MainThread): 15:03:36 | Concurrency: 1 threads (target='dev')
2020-03-03 21:03:36,527253 (MainThread): 15:03:36 | 
2020-03-03 21:03:36,529248 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-03 21:03:36,529589 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 21:03:36,529714 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:36,529805 (Thread-1): Compiling seed.civis_platform.ad_account_metrics
2020-03-03 21:03:36,543164 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,543626 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,544162 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-03 21:03:36,544377 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-03 21:03:36,544769 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-03 21:03:36,544860 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:36,545107 (Thread-1): Compiling seed.civis_platform.dim_date
2020-03-03 21:03:36,550130 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,550394 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,550740 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-03 21:03:36,550872 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 21:03:36,551273 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:03:36,551459 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:36,551580 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 21:03:36,566972 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 21:03:36,567483 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,568091 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,568683 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 21:03:36,568956 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 21:03:36,569635 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:03:36,569805 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:36,569918 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 21:03:36,580039 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 21:03:36,580785 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,581380 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,582446 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 21:03:36,582702 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 21:03:36,583402 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:03:36,583584 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:36,583700 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 21:03:36,591279 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 21:03:36,591821 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,592350 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,592919 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 21:03:36,593150 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:03:36,593647 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:03:36,593798 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:36,593893 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:03:36,607182 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-03 21:03:36,607669 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,608183 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,608765 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:03:36,609033 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:03:36,609451 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:03:36,609588 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:36,609677 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:03:36,620986 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-03 21:03:36,621712 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,622392 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,623204 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:03:36,623490 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 21:03:36,623883 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:03:36,623991 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:36,624075 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 21:03:36,630420 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 21:03:36,631723 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,632193 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,632749 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 21:03:36,632939 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:03:36,633313 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:03:36,633431 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:36,633514 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:03:36,642746 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-03 21:03:36,643921 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,645473 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,647088 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:03:36,647470 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:03:36,649789 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:03:36,650040 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:36,650216 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:03:36,660507 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-03 21:03:36,661194 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,661868 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,662577 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:03:36,662798 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:03:36,663258 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:03:36,663399 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:36,663489 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:03:36,671365 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-03 21:03:36,671855 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,672240 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,672876 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:03:36,673072 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:03:36,673547 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:03:36,673693 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:03:36,673790 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:03:36,681648 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-03 21:03:36,682453 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,683028 (Thread-1): finished collecting timing info
2020-03-03 21:03:36,683588 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:03:36,736615 (MainThread): Connection 'test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_' was properly closed.
2020-03-03 21:03:36,737003 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was properly closed.
2020-03-03 21:03:36,767967 (MainThread): 15:03:36 | Done.
2020-03-03 21:03:36,768241 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a8cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ff438>]}
2020-03-03 21:03:36,896496 (MainThread): Flushing usage events
2020-03-03 21:07:11,791186 (MainThread): Running with dbt=0.15.2
2020-03-03 21:07:11,884385 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-03-03 21:07:11,885184 (MainThread): Tracking: tracking
2020-03-03 21:07:11,893541 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083004e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108300860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108300dd8>]}
2020-03-03 21:07:12,172132 (MainThread): Partial parsing not enabled
2020-03-03 21:07:12,174213 (MainThread): Parsing macros/core.sql
2020-03-03 21:07:12,178352 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 21:07:12,184245 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 21:07:12,185919 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 21:07:12,199434 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 21:07:12,213751 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 21:07:12,227489 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 21:07:12,229292 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 21:07:12,234371 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 21:07:12,240749 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 21:07:12,245986 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 21:07:12,250787 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 21:07:12,255347 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 21:07:12,256355 (MainThread): Parsing macros/etc/query.sql
2020-03-03 21:07:12,257490 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 21:07:12,259056 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 21:07:12,261036 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 21:07:12,267748 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 21:07:12,269665 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 21:07:12,291624 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 21:07:12,292876 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 21:07:12,293893 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 21:07:12,295023 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 21:07:12,296976 (MainThread): Parsing macros/catalog.sql
2020-03-03 21:07:12,298573 (MainThread): Parsing macros/relations.sql
2020-03-03 21:07:12,299748 (MainThread): Parsing macros/adapters.sql
2020-03-03 21:07:12,309659 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 21:07:12,329694 (MainThread): Partial parsing not enabled
2020-03-03 21:07:12,330178 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-03 21:07:12,345515 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:07:12,345649 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:07:12,361519 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:07:12,361649 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:07:12,368338 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:07:12,368479 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:07:12,374725 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:07:12,374847 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:07:12,411455 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:07:12,411588 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:07:12,422874 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:07:12,423002 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:07:12,433349 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:07:12,433477 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:07:12,440379 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:07:12,440490 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:07:12,451409 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:07:12,451540 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:07:12,459949 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:07:12,460076 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:07:12,530221 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 21:07:12,536077 (MainThread): 
2020-03-03 21:07:12,536275 (MainThread): 15:07:12 | Concurrency: 1 threads (target='dev')
2020-03-03 21:07:12,536483 (MainThread): 15:07:12 | 
2020-03-03 21:07:12,538407 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-03 21:07:12,538726 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 21:07:12,538850 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:07:12,538944 (Thread-1): Compiling seed.civis_platform.ad_account_metrics
2020-03-03 21:07:12,550491 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,550821 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,551198 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-03 21:07:12,551449 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-03 21:07:12,551810 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-03 21:07:12,551920 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:07:12,552040 (Thread-1): Compiling seed.civis_platform.dim_date
2020-03-03 21:07:12,556353 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,556599 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,556924 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-03 21:07:12,557058 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 21:07:12,557360 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:07:12,557622 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:07:12,557722 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 21:07:12,570271 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 21:07:12,570865 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,571385 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,572000 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 21:07:12,572190 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 21:07:12,572586 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:07:12,572847 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:07:12,572944 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 21:07:12,584363 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 21:07:12,584934 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,585835 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,586723 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 21:07:12,587054 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 21:07:12,588204 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:07:12,588317 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:07:12,588400 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 21:07:12,595308 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 21:07:12,596234 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,596750 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,597276 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 21:07:12,597464 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:07:12,597936 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:07:12,598045 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:07:12,598128 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:07:12,611520 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-03 21:07:12,612285 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,612771 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,613336 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:07:12,613527 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:07:12,613874 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:07:12,613989 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:07:12,614076 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:07:12,622332 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-03 21:07:12,622942 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,623499 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,624101 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:07:12,624288 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 21:07:12,624653 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:07:12,624774 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:07:12,624860 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 21:07:12,631101 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 21:07:12,631642 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,632142 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,632705 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 21:07:12,632894 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:07:12,633254 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:07:12,633376 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:07:12,633465 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:07:12,642102 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-03 21:07:12,642921 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,643448 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,644033 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:07:12,644222 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:07:12,644624 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:07:12,644751 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:07:12,644840 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:07:12,653428 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-03 21:07:12,654152 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,654611 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,655156 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:07:12,655345 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:07:12,655714 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:07:12,655830 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:07:12,655913 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:07:12,663610 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-03 21:07:12,664417 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,664908 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,665480 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:07:12,665669 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:07:12,666037 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:07:12,666155 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:07:12,666240 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:07:12,673966 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-03 21:07:12,674568 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,675091 (Thread-1): finished collecting timing info
2020-03-03 21:07:12,675686 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:07:12,747517 (MainThread): Connection 'test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_' was properly closed.
2020-03-03 21:07:12,747978 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was properly closed.
2020-03-03 21:07:12,779577 (MainThread): 15:07:12 | Done.
2020-03-03 21:07:12,779917 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b7b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085aee48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085aef28>]}
2020-03-03 21:07:12,907021 (MainThread): Flushing usage events
2020-03-03 21:09:48,265620 (MainThread): Running with dbt=0.15.2
2020-03-03 21:09:48,369607 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-03-03 21:09:48,370815 (MainThread): Tracking: tracking
2020-03-03 21:09:48,385358 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11353bac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138e5c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138e5128>]}
2020-03-03 21:09:48,607584 (MainThread): Partial parsing not enabled
2020-03-03 21:09:48,611026 (MainThread): Parsing macros/core.sql
2020-03-03 21:09:48,615307 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 21:09:48,621262 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 21:09:48,622737 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 21:09:48,635645 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 21:09:48,650619 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 21:09:48,666560 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 21:09:48,668542 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 21:09:48,673911 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 21:09:48,679831 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 21:09:48,684700 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 21:09:48,689356 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 21:09:48,693366 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 21:09:48,694450 (MainThread): Parsing macros/etc/query.sql
2020-03-03 21:09:48,695652 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 21:09:48,697411 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 21:09:48,699458 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 21:09:48,706030 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 21:09:48,707830 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 21:09:48,735986 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 21:09:48,737574 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 21:09:48,738768 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 21:09:48,740203 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 21:09:48,742207 (MainThread): Parsing macros/catalog.sql
2020-03-03 21:09:48,743768 (MainThread): Parsing macros/relations.sql
2020-03-03 21:09:48,744905 (MainThread): Parsing macros/adapters.sql
2020-03-03 21:09:48,753130 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 21:09:48,774219 (MainThread): Partial parsing not enabled
2020-03-03 21:09:48,775046 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-03 21:09:48,791665 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:09:48,791956 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:09:48,807555 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:09:48,807677 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:09:48,813742 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:09:48,813867 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:09:48,820635 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:09:48,820763 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:09:48,859689 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:09:48,859824 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:09:48,873371 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:09:48,873503 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:09:48,883552 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:09:48,883674 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:09:48,891075 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:09:48,891200 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:09:48,902251 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:09:48,902375 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:09:48,909984 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:09:48,910141 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:09:48,980345 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 21:09:48,986747 (MainThread): 
2020-03-03 21:09:48,986945 (MainThread): 15:09:48 | Concurrency: 1 threads (target='dev')
2020-03-03 21:09:48,987122 (MainThread): 15:09:48 | 
2020-03-03 21:09:48,989160 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-03 21:09:48,989482 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 21:09:48,989571 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:09:48,989658 (Thread-1): Compiling seed.civis_platform.ad_account_metrics
2020-03-03 21:09:48,999728 (Thread-1): finished collecting timing info
2020-03-03 21:09:48,999996 (Thread-1): finished collecting timing info
2020-03-03 21:09:49,375 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-03 21:09:49,515 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-03 21:09:49,953 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-03 21:09:49,1069 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:09:49,1158 (Thread-1): Compiling seed.civis_platform.dim_date
2020-03-03 21:09:49,5914 (Thread-1): finished collecting timing info
2020-03-03 21:09:49,6159 (Thread-1): finished collecting timing info
2020-03-03 21:09:49,6483 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-03 21:09:49,6613 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 21:09:49,6907 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:09:49,7019 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:09:49,7125 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 21:09:49,20569 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 21:09:49,21211 (Thread-1): finished collecting timing info
2020-03-03 21:09:49,21824 (Thread-1): finished collecting timing info
2020-03-03 21:09:49,22410 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 21:09:49,22592 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 21:09:49,22975 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:09:49,23217 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:09:49,23328 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 21:09:49,30613 (Thread-1): finished collecting timing info
2020-03-03 21:09:49,31281 (Thread-1): Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  'a' is undefined
Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 358, in render_template
    return template.render(ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/jinja2/sandbox.py", line 407, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'a' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 218, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 155, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/node_runners.py", line 322, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/compilation.py", line 234, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/compilation.py", line 136, in compile_node
    node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 371, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/clients/jinja.py", line 363, in render_template
    dbt.exceptions.raise_compiler_error(str(e), node)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
  'a' is undefined
2020-03-03 21:09:49,34036 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 21:09:49,34354 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 21:09:49,34981 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:09:49,35196 (MainThread): Connection 'test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_' was properly closed.
2020-03-03 21:09:49,35314 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:09:49,35489 (MainThread): Connection 'model.civis_platform.fact_daily_performance' was properly closed.
2020-03-03 21:09:49,35670 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 21:09:49,35930 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc679e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd4bc88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdddf28>]}
2020-03-03 21:09:49,43095 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 21:09:49,45042 (Thread-1): finished collecting timing info
2020-03-03 21:09:49,46028 (Thread-1): finished collecting timing info
2020-03-03 21:09:49,46840 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 21:09:49,47355 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:09:49,48008 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:09:49,48183 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:09:49,48317 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:09:49,61823 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-03 21:09:49,62616 (Thread-1): finished collecting timing info
2020-03-03 21:09:49,63146 (Thread-1): finished collecting timing info
2020-03-03 21:09:49,63867 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:09:49,64304 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:09:49,64817 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:09:49,64921 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:09:49,65003 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:09:49,73001 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-03 21:09:49,73610 (Thread-1): finished collecting timing info
2020-03-03 21:09:49,74135 (Thread-1): finished collecting timing info
2020-03-03 21:09:49,74725 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:09:49,184021 (MainThread): Flushing usage events
2020-03-03 21:09:49,184286 (MainThread): Connection 'test.civis_platform.unique_my_first_dbt_model_id' was properly closed.
2020-03-03 21:09:49,184478 (MainThread): Encountered an error:
2020-03-03 21:09:49,184654 (MainThread): Runtime Error
  Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
    'a' is undefined
2020-03-03 21:09:49,189372 (MainThread): Traceback (most recent call last):
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/main.py", line 80, in main
    results, succeeded = handle_and_check(args)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/main.py", line 158, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/main.py", line 210, in run_from_args
    results = task.run()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/task/runnable.py", line 315, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/task/runnable.py", line 281, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/task/runnable.py", line 227, in execute_nodes
    self.run_queue(pool)
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/task/runnable.py", line 178, in run_queue
    self._raise_set_error()
  File "/Users/dbryan/civisanalytics/environments/dbt_example/lib/python3.7/site-packages/dbt/task/runnable.py", line 164, in _raise_set_error
    raise dbt.exceptions.RuntimeException(self._raise_next_tick)
dbt.exceptions.RuntimeException: Runtime Error
  Compilation Error in model fact_daily_performance (models/main/fact_daily_performance.sql)
    'a' is undefined

2020-03-03 21:10:09,184591 (MainThread): Running with dbt=0.15.2
2020-03-03 21:10:09,264038 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-03-03 21:10:09,264852 (MainThread): Tracking: tracking
2020-03-03 21:10:09,271595 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102454748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102454f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102454940>]}
2020-03-03 21:10:09,428802 (MainThread): Partial parsing not enabled
2020-03-03 21:10:09,430805 (MainThread): Parsing macros/core.sql
2020-03-03 21:10:09,434955 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 21:10:09,440415 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 21:10:09,441909 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 21:10:09,454804 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 21:10:09,471253 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 21:10:09,485300 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 21:10:09,487072 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 21:10:09,492205 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 21:10:09,497948 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 21:10:09,502797 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 21:10:09,507979 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 21:10:09,513920 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 21:10:09,515269 (MainThread): Parsing macros/etc/query.sql
2020-03-03 21:10:09,517020 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 21:10:09,519448 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 21:10:09,522519 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 21:10:09,529849 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 21:10:09,531722 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 21:10:09,553756 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 21:10:09,554960 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 21:10:09,555964 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 21:10:09,557111 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 21:10:09,559555 (MainThread): Parsing macros/catalog.sql
2020-03-03 21:10:09,561009 (MainThread): Parsing macros/relations.sql
2020-03-03 21:10:09,562122 (MainThread): Parsing macros/adapters.sql
2020-03-03 21:10:09,570930 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 21:10:09,590505 (MainThread): Partial parsing not enabled
2020-03-03 21:10:09,590968 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-03 21:10:09,605620 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:10:09,605756 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:09,622241 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:10:09,622379 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:09,628981 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:10:09,629115 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:09,635080 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:10:09,635202 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:09,677060 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:10:09,677212 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:09,688315 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:10:09,688443 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:09,698583 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:10:09,698711 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:09,706390 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:10:09,706521 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:09,720987 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:10:09,721134 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:09,728706 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:10:09,728830 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:09,799615 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 21:10:09,805731 (MainThread): 
2020-03-03 21:10:09,806035 (MainThread): 15:10:09 | Concurrency: 1 threads (target='dev')
2020-03-03 21:10:09,806189 (MainThread): 15:10:09 | 
2020-03-03 21:10:09,808547 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-03 21:10:09,809072 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 21:10:09,809273 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:09,809418 (Thread-1): Compiling seed.civis_platform.ad_account_metrics
2020-03-03 21:10:09,823922 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,824231 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,824592 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-03 21:10:09,824746 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-03 21:10:09,825110 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-03 21:10:09,825241 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:09,825347 (Thread-1): Compiling seed.civis_platform.dim_date
2020-03-03 21:10:09,829683 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,829929 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,830262 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-03 21:10:09,830396 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 21:10:09,830769 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:10:09,831011 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:09,831112 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 21:10:09,842997 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 21:10:09,843626 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,844214 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,844957 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 21:10:09,845158 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 21:10:09,845663 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:10:09,845766 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:09,845850 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 21:10:09,856430 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 21:10:09,857240 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,857799 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,858334 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 21:10:09,858570 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 21:10:09,859407 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:10:09,859619 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:09,859740 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 21:10:09,868780 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 21:10:09,869406 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,870034 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,870687 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 21:10:09,870882 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:10:09,871274 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:10:09,871502 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:09,871611 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:10:09,884392 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-03 21:10:09,884976 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,885627 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,886262 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:10:09,886451 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:10:09,886827 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:10:09,886956 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:09,887049 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:10:09,894643 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-03 21:10:09,895280 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,895820 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,896452 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:10:09,896647 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 21:10:09,897012 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:10:09,897137 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:09,897224 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 21:10:09,903571 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 21:10:09,904224 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,904760 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,905315 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 21:10:09,905533 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:10:09,905947 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:10:09,906069 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:09,906157 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:10:09,914604 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-03 21:10:09,915282 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,915912 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,916498 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:10:09,916688 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:10:09,917051 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:10:09,917153 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:09,917237 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:10:09,926149 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-03 21:10:09,926925 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,927413 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,928027 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:10:09,928257 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:10:09,928671 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:10:09,928790 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:09,928878 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:10:09,936589 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-03 21:10:09,937169 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,937681 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,938275 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:10:09,938467 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:10:09,938850 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:10:09,938968 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:09,939058 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:10:09,946899 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-03 21:10:09,947485 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,948282 (Thread-1): finished collecting timing info
2020-03-03 21:10:09,949128 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:10:10,20102 (MainThread): Connection 'test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_' was properly closed.
2020-03-03 21:10:10,20490 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was properly closed.
2020-03-03 21:10:10,53351 (MainThread): 15:10:10 | Done.
2020-03-03 21:10:10,53639 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10266ccf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026fd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026fd2b0>]}
2020-03-03 21:10:10,220622 (MainThread): Flushing usage events
2020-03-03 21:10:50,346809 (MainThread): Running with dbt=0.15.2
2020-03-03 21:10:50,430708 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-03-03 21:10:50,431276 (MainThread): Tracking: tracking
2020-03-03 21:10:50,437799 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e87f2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aebb5f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aebb630>]}
2020-03-03 21:10:50,599658 (MainThread): Partial parsing not enabled
2020-03-03 21:10:50,601396 (MainThread): Parsing macros/core.sql
2020-03-03 21:10:50,606188 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 21:10:50,613002 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 21:10:50,614714 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 21:10:50,627934 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 21:10:50,642162 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 21:10:50,656055 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 21:10:50,657832 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 21:10:50,662954 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 21:10:50,668825 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 21:10:50,674118 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 21:10:50,678916 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 21:10:50,682870 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 21:10:50,683831 (MainThread): Parsing macros/etc/query.sql
2020-03-03 21:10:50,684913 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 21:10:50,686477 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 21:10:50,688311 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 21:10:50,694758 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 21:10:50,696674 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 21:10:50,718166 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 21:10:50,719495 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 21:10:50,720564 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 21:10:50,721675 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 21:10:50,723612 (MainThread): Parsing macros/catalog.sql
2020-03-03 21:10:50,725090 (MainThread): Parsing macros/relations.sql
2020-03-03 21:10:50,726208 (MainThread): Parsing macros/adapters.sql
2020-03-03 21:10:50,734062 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 21:10:50,751550 (MainThread): Partial parsing not enabled
2020-03-03 21:10:50,752014 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-03 21:10:50,766542 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:10:50,766675 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:50,782489 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:10:50,782620 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:50,788746 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:10:50,788872 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:50,795036 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:10:50,795159 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:50,833842 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:10:50,833974 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:50,845257 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:10:50,845390 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:50,855345 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:10:50,855469 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:50,862832 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:10:50,862966 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:50,878264 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:10:50,878520 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:50,891339 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:10:50,891542 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:10:50,991447 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 21:10:50,997586 (MainThread): 
2020-03-03 21:10:50,997787 (MainThread): 15:10:50 | Concurrency: 1 threads (target='dev')
2020-03-03 21:10:50,997945 (MainThread): 15:10:50 | 
2020-03-03 21:10:50,999773 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-03 21:10:51,261 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 21:10:51,398 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:51,532 (Thread-1): Compiling seed.civis_platform.ad_account_metrics
2020-03-03 21:10:51,12920 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,13233 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,13597 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-03 21:10:51,13722 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-03 21:10:51,14008 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-03 21:10:51,14093 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:51,14171 (Thread-1): Compiling seed.civis_platform.dim_date
2020-03-03 21:10:51,19895 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,20305 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,20826 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-03 21:10:51,21008 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 21:10:51,21663 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:10:51,21783 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:51,21874 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 21:10:51,39525 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 21:10:51,40726 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,41293 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,42022 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 21:10:51,42312 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 21:10:51,42873 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:10:51,43006 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:51,43119 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 21:10:51,57536 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 21:10:51,58560 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,61570 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,62030 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 21:10:51,62199 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 21:10:51,62623 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:10:51,62867 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:51,62991 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 21:10:51,71320 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 21:10:51,72160 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,72581 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,73314 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 21:10:51,73608 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:10:51,75158 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:10:51,75297 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:51,75390 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:10:51,94149 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-03 21:10:51,95483 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,96367 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,97079 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:10:51,97300 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:10:51,97709 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:10:51,97831 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:51,98152 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:10:51,111354 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-03 21:10:51,112071 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,112671 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,113235 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:10:51,113431 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 21:10:51,113799 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:10:51,113922 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:51,114007 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 21:10:51,122361 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 21:10:51,123033 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,123505 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,124098 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 21:10:51,124287 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:10:51,124648 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:10:51,124769 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:51,124861 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:10:51,133452 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-03 21:10:51,134318 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,134830 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,135379 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:10:51,135578 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:10:51,135933 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:10:51,136026 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:51,136108 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:10:51,146490 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-03 21:10:51,147082 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,147615 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,148208 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:10:51,148413 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:10:51,148784 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:10:51,148896 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:51,148980 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:10:51,156932 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-03 21:10:51,157500 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,158068 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,158628 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:10:51,158815 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:10:51,159277 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:10:51,159412 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:10:51,159506 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:10:51,167225 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-03 21:10:51,167772 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,168371 (Thread-1): finished collecting timing info
2020-03-03 21:10:51,168954 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:10:51,212655 (MainThread): Connection 'test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_' was properly closed.
2020-03-03 21:10:51,212890 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was properly closed.
2020-03-03 21:10:51,241528 (MainThread): 15:10:51 | Done.
2020-03-03 21:10:51,241893 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b15bc88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b16d198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b16d400>]}
2020-03-03 21:10:51,375539 (MainThread): Flushing usage events
2020-03-03 21:11:09,520845 (MainThread): Running with dbt=0.15.2
2020-03-03 21:11:09,607620 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-03-03 21:11:09,609441 (MainThread): Tracking: tracking
2020-03-03 21:11:09,619350 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108b16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108b1eb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c56ac8>]}
2020-03-03 21:11:09,822048 (MainThread): Partial parsing not enabled
2020-03-03 21:11:09,823936 (MainThread): Parsing macros/core.sql
2020-03-03 21:11:09,828977 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 21:11:09,834410 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 21:11:09,835867 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 21:11:09,848815 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 21:11:09,863959 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 21:11:09,878405 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 21:11:09,880198 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 21:11:09,885381 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 21:11:09,891207 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 21:11:09,896127 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 21:11:09,901004 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 21:11:09,905036 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 21:11:09,906149 (MainThread): Parsing macros/etc/query.sql
2020-03-03 21:11:09,907276 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 21:11:09,908787 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 21:11:09,910575 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 21:11:09,917030 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 21:11:09,918838 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 21:11:09,941709 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 21:11:09,942928 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 21:11:09,943916 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 21:11:09,945001 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 21:11:09,947110 (MainThread): Parsing macros/catalog.sql
2020-03-03 21:11:09,948610 (MainThread): Parsing macros/relations.sql
2020-03-03 21:11:09,949726 (MainThread): Parsing macros/adapters.sql
2020-03-03 21:11:09,958790 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 21:11:09,976641 (MainThread): Partial parsing not enabled
2020-03-03 21:11:09,977096 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-03 21:11:09,991326 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:11:09,991459 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:10,8162 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:11:10,8301 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:10,15288 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:11:10,15428 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:10,21569 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:11:10,21696 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:10,61330 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:11:10,61475 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:10,72774 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:11:10,72904 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:10,82711 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:11:10,82833 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:10,90563 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:11:10,90713 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:10,103250 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:11:10,103380 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:10,111210 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:11:10,111340 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:10,179289 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 21:11:10,185456 (MainThread): 
2020-03-03 21:11:10,185664 (MainThread): 15:11:10 | Concurrency: 1 threads (target='dev')
2020-03-03 21:11:10,185835 (MainThread): 15:11:10 | 
2020-03-03 21:11:10,187611 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-03 21:11:10,187928 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-03 21:11:10,188068 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:11:10,188205 (Thread-1): Compiling seed.civis_platform.ad_account_metrics
2020-03-03 21:11:10,198199 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,198468 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,198798 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-03 21:11:10,198929 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-03 21:11:10,199294 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-03 21:11:10,199384 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:11:10,199462 (Thread-1): Compiling seed.civis_platform.dim_date
2020-03-03 21:11:10,203760 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,204004 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,204324 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-03 21:11:10,204454 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 21:11:10,204980 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:11:10,205072 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:11:10,205151 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 21:11:10,217169 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 21:11:10,217682 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,218862 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,219493 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 21:11:10,219683 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 21:11:10,220218 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:11:10,220336 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:11:10,220424 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 21:11:10,231057 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 21:11:10,231858 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,232393 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,233132 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 21:11:10,233378 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 21:11:10,233862 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:11:10,234242 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:11:10,234415 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 21:11:10,241471 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 21:11:10,242152 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,242654 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,243469 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 21:11:10,243669 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:11:10,244036 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:11:10,244247 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:11:10,244336 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:11:10,257486 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-03 21:11:10,258023 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,258542 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,259136 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-03 21:11:10,259317 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:11:10,259685 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:11:10,259807 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:11:10,259893 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:11:10,267442 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-03 21:11:10,267996 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,268579 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,269146 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-03 21:11:10,269334 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 21:11:10,269714 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:11:10,269835 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:11:10,269920 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 21:11:10,276341 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 21:11:10,276962 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,277506 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,278078 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 21:11:10,278268 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:11:10,278638 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:11:10,278751 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:11:10,278839 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:11:10,287162 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-03 21:11:10,287973 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,288423 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,289015 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-03 21:11:10,289204 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:11:10,289570 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:11:10,289683 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:11:10,289766 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:11:10,298473 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-03 21:11:10,299807 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,300360 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,300888 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-03 21:11:10,301073 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:11:10,301437 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:11:10,301551 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:11:10,301636 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:11:10,309303 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-03 21:11:10,309907 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,310434 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,311116 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-03 21:11:10,311324 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:11:10,311685 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:11:10,311792 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:11:10,311876 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:11:10,319512 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-03 21:11:10,320047 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,320588 (Thread-1): finished collecting timing info
2020-03-03 21:11:10,321216 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-03 21:11:10,395757 (MainThread): Connection 'test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_' was properly closed.
2020-03-03 21:11:10,395970 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was properly closed.
2020-03-03 21:11:10,422495 (MainThread): 15:11:10 | Done.
2020-03-03 21:11:10,422894 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d17fcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d17f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d14d4a8>]}
2020-03-03 21:11:10,552480 (MainThread): Flushing usage events
2020-03-03 21:11:49,920215 (MainThread): Running with dbt=0.15.2
2020-03-03 21:11:50,877 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 21:11:50,1601 (MainThread): Tracking: tracking
2020-03-03 21:11:50,9398 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae2438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae28d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae29b0>]}
2020-03-03 21:11:50,163375 (MainThread): Partial parsing not enabled
2020-03-03 21:11:50,165176 (MainThread): Parsing macros/core.sql
2020-03-03 21:11:50,168824 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 21:11:50,174233 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 21:11:50,175676 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 21:11:50,189018 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 21:11:50,203191 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 21:11:50,217021 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 21:11:50,218734 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 21:11:50,223954 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 21:11:50,229474 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 21:11:50,234482 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 21:11:50,239236 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 21:11:50,243440 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 21:11:50,244527 (MainThread): Parsing macros/etc/query.sql
2020-03-03 21:11:50,245665 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 21:11:50,247301 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 21:11:50,249194 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 21:11:50,255691 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 21:11:50,257531 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 21:11:50,279361 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 21:11:50,281000 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 21:11:50,281980 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 21:11:50,283042 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 21:11:50,285033 (MainThread): Parsing macros/catalog.sql
2020-03-03 21:11:50,286513 (MainThread): Parsing macros/relations.sql
2020-03-03 21:11:50,287615 (MainThread): Parsing macros/adapters.sql
2020-03-03 21:11:50,295552 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 21:11:50,313274 (MainThread): Partial parsing not enabled
2020-03-03 21:11:50,313767 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-03 21:11:50,328740 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:11:50,328875 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:50,344640 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:11:50,344768 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:50,351028 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:11:50,351150 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:50,358368 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:11:50,358497 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:50,398666 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:11:50,398802 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:50,410430 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:11:50,410558 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:50,422717 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:11:50,422843 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:50,430811 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:11:50,430934 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:50,441902 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:11:50,442028 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:50,450420 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:11:50,450540 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:50,519771 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 21:11:50,527232 (MainThread): 
2020-03-03 21:11:50,527609 (MainThread): Acquiring new postgres connection "master".
2020-03-03 21:11:50,527699 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:11:50,616553 (MainThread): Using postgres connection "master".
2020-03-03 21:11:50,616708 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 21:11:50,625718 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 21:11:50,676328 (MainThread): Using postgres connection "master".
2020-03-03 21:11:50,676473 (MainThread): On master: BEGIN
2020-03-03 21:11:50,677939 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:11:50,678115 (MainThread): Using postgres connection "master".
2020-03-03 21:11:50,678235 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 21:11:50,682358 (MainThread): SQL status: SELECT 7 in 0.00 seconds
2020-03-03 21:11:50,727248 (MainThread): Using postgres connection "master".
2020-03-03 21:11:50,727380 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 21:11:50,741782 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 21:11:50,745494 (MainThread): On master: ROLLBACK
2020-03-03 21:11:50,745881 (MainThread): Using postgres connection "master".
2020-03-03 21:11:50,745980 (MainThread): On master: BEGIN
2020-03-03 21:11:50,746386 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:11:50,746483 (MainThread): On master: COMMIT
2020-03-03 21:11:50,746559 (MainThread): Using postgres connection "master".
2020-03-03 21:11:50,746622 (MainThread): On master: COMMIT
2020-03-03 21:11:50,746793 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:11:50,747046 (MainThread): 15:11:50 | Concurrency: 1 threads (target='dev')
2020-03-03 21:11:50,747191 (MainThread): 15:11:50 | 
2020-03-03 21:11:50,748634 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 21:11:50,748808 (Thread-1): 15:11:50 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 21:11:50,749134 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:11:50,749227 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:11:50,749320 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 21:11:50,773186 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 21:11:50,773924 (Thread-1): finished collecting timing info
2020-03-03 21:11:50,804637 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:11:50,804816 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-03 21:11:50,813850 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-03-03 21:11:50,816629 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:11:50,816793 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 21:11:50,817090 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 21:11:50,818629 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:11:50,818749 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-03 21:11:50,819022 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:11:50,819125 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:11:50,819198 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 21:11:50,829537 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-03 21:11:50,831189 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 21:11:50,831765 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:11:50,831924 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    a.*,
    
case
    when clicks >= 100
        then 'high clicks'
    when (spend / clicks) <= 1.00 and impressions > 1000
        then 'well optimized'
    when (spend / clicks) > 3.00 and impressions > 100
        then 'unoptimized'
    else
        'normal'
    end as daily_performance_result_tag

from
    (
    select
        d.date,
        d.business_day,
        ad.impressions,
        ad.clicks,
        ad.spend::numeric(7,0) as spend,
        round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
        round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
        round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
    from 
        "dbryan"."public"."dim_date" d
        inner join "dbryan"."public"."ad_account_metrics" ad
            on ad.date = d.date
    where
        d.date >= '2020-03-03'
    ) a
order by 
    a.date
  );

2020-03-03 21:11:50,842480 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-03-03 21:11:50,846070 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:11:50,846192 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance" rename to "fact_daily_performance__dbt_backup"
2020-03-03 21:11:50,846770 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:11:50,848957 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:11:50,849071 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance__dbt_tmp" rename to "fact_daily_performance"
2020-03-03 21:11:50,850536 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:11:50,852551 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:11:50,852725 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 21:11:50,853539 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 21:11:50,854631 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 21:11:50,854820 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:11:50,854903 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 21:11:50,856623 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:11:50,859101 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:11:50,859313 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 21:11:50,861007 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 21:11:50,863280 (Thread-1): finished collecting timing info
2020-03-03 21:11:50,863895 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '573551f4-817b-4ca6-8354-76f82512c53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c5add8>]}
2020-03-03 21:11:51,49686 (Thread-1): 15:11:51 | 1 of 4 OK created view model public.fact_daily_performance........... [CREATE VIEW in 0.11s]
2020-03-03 21:11:51,49927 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 21:11:51,50134 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 21:11:51,50472 (Thread-1): 15:11:51 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 21:11:51,51070 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:11:51,51206 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-03 21:11:51,51304 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 21:11:51,59618 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 21:11:51,60359 (Thread-1): finished collecting timing info
2020-03-03 21:11:51,80364 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:11:51,80504 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 21:11:51,80906 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:11:51,82737 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:11:51,82827 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 21:11:51,83121 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:11:51,84517 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:11:51,84665 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 21:11:51,84950 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:11:51,85092 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:11:51,85169 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 21:11:51,88658 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 21:11:51,89911 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 21:11:51,90462 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:11:51,90620 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
2020-03-03 21:11:51,93249 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 21:11:51,96680 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:11:51,96881 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 21:11:51,97468 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:11:51,101040 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:11:51,101192 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 21:11:51,101876 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:11:51,103378 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:11:51,103514 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 21:11:51,103958 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 21:11:51,104919 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 21:11:51,105285 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:11:51,105379 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 21:11:51,107037 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:11:51,108784 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:11:51,108925 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 21:11:51,110558 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:11:51,112962 (Thread-1): finished collecting timing info
2020-03-03 21:11:51,113696 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '573551f4-817b-4ca6-8354-76f82512c53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd5588>]}
2020-03-03 21:11:51,239469 (Thread-1): 15:11:51 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.06s]
2020-03-03 21:11:51,239662 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 21:11:51,239831 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 21:11:51,240195 (Thread-1): 15:11:51 | 3 of 4 START view model public.fact_monthly_performance.............. [RUN]
2020-03-03 21:11:51,240481 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:11:51,240569 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 21:11:51,240655 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 21:11:51,248139 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 21:11:51,248743 (Thread-1): finished collecting timing info
2020-03-03 21:11:51,255191 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:11:51,255322 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_tmp" cascade
2020-03-03 21:11:51,255727 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 21:11:51,257590 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:11:51,257682 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 21:11:51,257982 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 21:11:51,259133 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:11:51,259219 (Thread-1): On model.civis_platform.fact_monthly_performance: BEGIN
2020-03-03 21:11:51,259479 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:11:51,259616 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:11:51,259696 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 21:11:51,262959 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 21:11:51,264545 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 21:11:51,265122 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:11:51,265281 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

  
  create view "dbryan"."public"."fact_monthly_performance__dbt_tmp" as (
    select
    date_trunc('month', f.date)::date as month,
    sum(impressions) as impressions,
    sum(clicks) as clicks,
    sum(spend) as spend,
    round(avg(spend)::numeric, 2) as average_daily_spend
from
    "dbryan"."public"."fact_daily_performance" f
group by 
    date_trunc('month', f.date)::date
order by
    date_trunc('month', f.date)::date
  );

2020-03-03 21:11:51,267893 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 21:11:51,270316 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:11:51,270518 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
alter table "dbryan"."public"."fact_monthly_performance__dbt_tmp" rename to "fact_monthly_performance"
2020-03-03 21:11:51,271156 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:11:51,273257 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:11:51,273427 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 21:11:51,273933 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 21:11:51,274744 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 21:11:51,274878 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:11:51,274952 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 21:11:51,276083 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:11:51,278020 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:11:51,278149 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 21:11:51,279602 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 21:11:51,281624 (Thread-1): finished collecting timing info
2020-03-03 21:11:51,282199 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '573551f4-817b-4ca6-8354-76f82512c53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a49cd30>]}
2020-03-03 21:11:51,409386 (Thread-1): 15:11:51 | 3 of 4 OK created view model public.fact_monthly_performance......... [CREATE VIEW in 0.04s]
2020-03-03 21:11:51,409663 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 21:11:51,409903 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 21:11:51,410122 (Thread-1): 15:11:51 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 21:11:51,410551 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:11:51,410690 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_monthly_performance).
2020-03-03 21:11:51,410826 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 21:11:51,423841 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 21:11:51,424717 (Thread-1): finished collecting timing info
2020-03-03 21:11:51,432429 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:11:51,432565 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 21:11:51,432891 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:11:51,434726 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:11:51,434814 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 21:11:51,435197 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:11:51,437455 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:11:51,437560 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 21:11:51,437780 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:11:51,437878 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:11:51,437942 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 21:11:51,441306 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 21:11:51,442399 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 21:11:51,442956 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:11:51,443094 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 21:11:51,445453 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 21:11:51,451215 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:11:51,451393 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 21:11:51,451955 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:11:51,455075 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:11:51,455239 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 21:11:51,456489 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:11:51,458057 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:11:51,458185 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 21:11:51,458755 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 21:11:51,459533 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 21:11:51,459665 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:11:51,459740 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 21:11:51,461411 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:11:51,463464 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:11:51,463675 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 21:11:51,465288 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:11:51,467688 (Thread-1): finished collecting timing info
2020-03-03 21:11:51,468332 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '573551f4-817b-4ca6-8354-76f82512c53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d041d0>]}
2020-03-03 21:11:51,610042 (Thread-1): 15:11:51 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.06s]
2020-03-03 21:11:51,610367 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 21:11:51,684259 (MainThread): Using postgres connection "master".
2020-03-03 21:11:51,684511 (MainThread): On master: BEGIN
2020-03-03 21:11:51,685007 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:11:51,685199 (MainThread): On master: COMMIT
2020-03-03 21:11:51,685340 (MainThread): Using postgres connection "master".
2020-03-03 21:11:51,685508 (MainThread): On master: COMMIT
2020-03-03 21:11:51,685970 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:11:51,686404 (MainThread): 15:11:51 | 
2020-03-03 21:11:51,686600 (MainThread): 15:11:51 | Finished running 2 view models, 2 table models in 1.16s.
2020-03-03 21:11:51,686774 (MainThread): Connection 'master' was left open.
2020-03-03 21:11:51,686917 (MainThread): On master: Close
2020-03-03 21:11:51,687146 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 21:11:51,687275 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 21:11:51,710164 (MainThread): 
2020-03-03 21:11:51,710424 (MainThread): Completed successfully
2020-03-03 21:11:51,710591 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-03-03 21:11:51,710868 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c23320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c49588>]}
2020-03-03 21:11:51,836215 (MainThread): Flushing usage events
2020-03-03 21:15:31,872766 (MainThread): Running with dbt=0.15.2
2020-03-03 21:15:31,962728 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{start_date: 2020-01-01}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-03 21:15:31,963485 (MainThread): Tracking: tracking
2020-03-03 21:15:31,982948 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad3ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0b470>]}
2020-03-03 21:15:32,204737 (MainThread): Partial parsing not enabled
2020-03-03 21:15:32,206456 (MainThread): Parsing macros/core.sql
2020-03-03 21:15:32,209792 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-03 21:15:32,215158 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-03 21:15:32,216877 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-03 21:15:32,231648 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-03 21:15:32,246043 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-03 21:15:32,259784 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-03 21:15:32,262297 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-03 21:15:32,268104 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-03 21:15:32,273773 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-03 21:15:32,279322 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-03 21:15:32,284147 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-03 21:15:32,288063 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-03 21:15:32,289045 (MainThread): Parsing macros/etc/query.sql
2020-03-03 21:15:32,290127 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-03 21:15:32,291685 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-03 21:15:32,293500 (MainThread): Parsing macros/etc/datetime.sql
2020-03-03 21:15:32,300134 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-03 21:15:32,302015 (MainThread): Parsing macros/adapters/common.sql
2020-03-03 21:15:32,324658 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-03 21:15:32,325873 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-03 21:15:32,326849 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-03 21:15:32,327934 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-03 21:15:32,329866 (MainThread): Parsing macros/catalog.sql
2020-03-03 21:15:32,331262 (MainThread): Parsing macros/relations.sql
2020-03-03 21:15:32,332390 (MainThread): Parsing macros/adapters.sql
2020-03-03 21:15:32,340139 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-03 21:15:32,357639 (MainThread): Partial parsing not enabled
2020-03-03 21:15:32,358097 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-03 21:15:32,372594 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:15:32,372732 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:15:32,387857 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:15:32,387981 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:15:32,393917 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:15:32,394039 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:15:32,400153 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:15:32,400279 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:15:32,438735 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-03 21:15:32,438865 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:15:32,449823 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-03 21:15:32,449952 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:15:32,459532 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-03 21:15:32,459643 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:15:32,466692 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-03 21:15:32,466804 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:15:32,477554 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-03 21:15:32,477681 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:15:32,485217 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-03 21:15:32,485356 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:15:32,557260 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-03 21:15:32,563450 (MainThread): 
2020-03-03 21:15:32,563828 (MainThread): Acquiring new postgres connection "master".
2020-03-03 21:15:32,563926 (MainThread): Opening a new connection, currently in state init
2020-03-03 21:15:32,644150 (MainThread): Using postgres connection "master".
2020-03-03 21:15:32,644311 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-03 21:15:32,651250 (MainThread): SQL status: SELECT 6 in 0.01 seconds
2020-03-03 21:15:32,693166 (MainThread): Using postgres connection "master".
2020-03-03 21:15:32,693297 (MainThread): On master: BEGIN
2020-03-03 21:15:32,693643 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:15:32,693739 (MainThread): Using postgres connection "master".
2020-03-03 21:15:32,693809 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-03 21:15:32,697739 (MainThread): SQL status: SELECT 7 in 0.00 seconds
2020-03-03 21:15:32,739956 (MainThread): Using postgres connection "master".
2020-03-03 21:15:32,740163 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-03 21:15:32,754529 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-03-03 21:15:32,758388 (MainThread): On master: ROLLBACK
2020-03-03 21:15:32,758828 (MainThread): Using postgres connection "master".
2020-03-03 21:15:32,758927 (MainThread): On master: BEGIN
2020-03-03 21:15:32,759320 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:15:32,759423 (MainThread): On master: COMMIT
2020-03-03 21:15:32,759503 (MainThread): Using postgres connection "master".
2020-03-03 21:15:32,759570 (MainThread): On master: COMMIT
2020-03-03 21:15:32,759768 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:15:32,760046 (MainThread): 15:15:32 | Concurrency: 1 threads (target='dev')
2020-03-03 21:15:32,760180 (MainThread): 15:15:32 | 
2020-03-03 21:15:32,762417 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-03 21:15:32,762654 (Thread-1): 15:15:32 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-03 21:15:32,763049 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:15:32,763191 (Thread-1): Opening a new connection, currently in state init
2020-03-03 21:15:32,763281 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-03 21:15:32,778987 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 21:15:32,779622 (Thread-1): finished collecting timing info
2020-03-03 21:15:32,808973 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:15:32,809116 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-03 21:15:32,815816 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-03-03 21:15:32,818156 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:15:32,818297 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 21:15:32,818732 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 21:15:32,820087 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:15:32,820206 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-03 21:15:32,820622 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:15:32,820780 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:15:32,820870 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 21:15:32,827348 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-03 21:15:32,828890 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-03 21:15:32,829427 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:15:32,829666 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    a.*,
    
case
    when clicks >= 100
        then 'high clicks'
    when (spend / clicks) <= 1.00 and impressions > 1000
        then 'well optimized'
    when (spend / clicks) > 3.00 and impressions > 100
        then 'unoptimized'
    else
        'normal'
    end as daily_performance_result_tag

from
    (
    select
        d.date,
        d.business_day,
        ad.impressions,
        ad.clicks,
        ad.spend::numeric(7,0) as spend,
        round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
        round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
        round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
    from 
        "dbryan"."public"."dim_date" d
        inner join "dbryan"."public"."ad_account_metrics" ad
            on ad.date = d.date
    where
        d.date >= '2020-01-01'
    ) a
order by 
    a.date
  );

2020-03-03 21:15:32,834180 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 21:15:32,837445 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:15:32,837552 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance" rename to "fact_daily_performance__dbt_backup"
2020-03-03 21:15:32,838323 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:15:32,840207 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:15:32,840301 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance__dbt_tmp" rename to "fact_daily_performance"
2020-03-03 21:15:32,841001 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:15:32,842275 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:15:32,842368 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 21:15:32,843058 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 21:15:32,843748 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 21:15:32,843878 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:15:32,843985 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-03 21:15:32,845842 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:15:32,848007 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-03 21:15:32,848124 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-03 21:15:32,849853 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 21:15:32,852043 (Thread-1): finished collecting timing info
2020-03-03 21:15:32,852697 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea4e920-0cda-4ccf-8cef-caa62b31ad0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c7aac8>]}
2020-03-03 21:15:32,981301 (Thread-1): 15:15:32 | 1 of 4 OK created view model public.fact_daily_performance........... [CREATE VIEW in 0.09s]
2020-03-03 21:15:32,981589 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-03 21:15:32,981834 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-03 21:15:32,982060 (Thread-1): 15:15:32 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-03 21:15:32,982486 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:15:32,982634 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-03 21:15:32,982779 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-03 21:15:32,990685 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 21:15:32,991664 (Thread-1): finished collecting timing info
2020-03-03 21:15:33,14438 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:15:33,14626 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-03 21:15:33,14974 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:15:33,18112 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:15:33,18282 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 21:15:33,18643 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:15:33,20716 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:15:33,20876 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-03 21:15:33,21134 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:15:33,21321 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:15:33,21442 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 21:15:33,24797 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 21:15:33,25928 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-03 21:15:33,26565 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:15:33,26804 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
2020-03-03 21:15:33,28302 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-03 21:15:33,32917 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:15:33,33125 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-03 21:15:33,33724 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:15:33,36048 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:15:33,36172 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-03 21:15:33,36974 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:15:33,38455 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:15:33,38575 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 21:15:33,39162 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 21:15:33,39917 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 21:15:33,40026 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:15:33,40105 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-03 21:15:33,41662 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:15:33,43232 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-03 21:15:33,43362 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-03 21:15:33,44752 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:15:33,47269 (Thread-1): finished collecting timing info
2020-03-03 21:15:33,47988 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea4e920-0cda-4ccf-8cef-caa62b31ad0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c61f98>]}
2020-03-03 21:15:33,176655 (Thread-1): 15:15:33 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.07s]
2020-03-03 21:15:33,176922 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-03 21:15:33,177169 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-03 21:15:33,177395 (Thread-1): 15:15:33 | 3 of 4 START view model public.fact_monthly_performance.............. [RUN]
2020-03-03 21:15:33,177814 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:15:33,177959 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-03 21:15:33,178104 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-03 21:15:33,186626 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 21:15:33,187209 (Thread-1): finished collecting timing info
2020-03-03 21:15:33,194276 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:15:33,194416 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_tmp" cascade
2020-03-03 21:15:33,194759 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 21:15:33,196821 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:15:33,196935 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 21:15:33,197265 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 21:15:33,199442 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:15:33,199627 (Thread-1): On model.civis_platform.fact_monthly_performance: BEGIN
2020-03-03 21:15:33,199887 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:15:33,199996 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:15:33,200072 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 21:15:33,203784 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 21:15:33,205135 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-03 21:15:33,205794 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:15:33,205997 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

  
  create view "dbryan"."public"."fact_monthly_performance__dbt_tmp" as (
    select
    date_trunc('month', f.date)::date as month,
    sum(impressions) as impressions,
    sum(clicks) as clicks,
    sum(spend) as spend,
    round(avg(spend)::numeric, 2) as average_daily_spend
from
    "dbryan"."public"."fact_daily_performance" f
group by 
    date_trunc('month', f.date)::date
order by
    date_trunc('month', f.date)::date
  );

2020-03-03 21:15:33,208041 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-03-03 21:15:33,210391 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:15:33,210516 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
alter table "dbryan"."public"."fact_monthly_performance__dbt_tmp" rename to "fact_monthly_performance"
2020-03-03 21:15:33,211113 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:15:33,212716 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:15:33,212894 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 21:15:33,213403 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 21:15:33,214527 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 21:15:33,214700 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:15:33,214831 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-03 21:15:33,216145 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:15:33,217993 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-03 21:15:33,218115 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-03 21:15:33,218594 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-03 21:15:33,220675 (Thread-1): finished collecting timing info
2020-03-03 21:15:33,221206 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea4e920-0cda-4ccf-8cef-caa62b31ad0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c89ef0>]}
2020-03-03 21:15:33,354116 (Thread-1): 15:15:33 | 3 of 4 OK created view model public.fact_monthly_performance......... [CREATE VIEW in 0.04s]
2020-03-03 21:15:33,354405 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-03 21:15:33,354712 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-03 21:15:33,355054 (Thread-1): 15:15:33 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-03 21:15:33,355521 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:15:33,355663 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_monthly_performance).
2020-03-03 21:15:33,355806 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-03 21:15:33,364321 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 21:15:33,364897 (Thread-1): finished collecting timing info
2020-03-03 21:15:33,371802 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:15:33,371935 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-03 21:15:33,372378 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:15:33,374230 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:15:33,374340 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 21:15:33,374641 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:15:33,377075 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:15:33,377188 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-03 21:15:33,377456 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:15:33,377548 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:15:33,377616 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-03 21:15:33,380999 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 21:15:33,382084 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-03 21:15:33,382660 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:15:33,382874 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-03 21:15:33,384391 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-03 21:15:33,387832 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:15:33,387951 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-03 21:15:33,388390 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:15:33,391443 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:15:33,391575 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-03 21:15:33,392211 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-03 21:15:33,393625 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:15:33,393737 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-03 21:15:33,394256 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-03 21:15:33,395377 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 21:15:33,395544 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:15:33,395668 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-03 21:15:33,397098 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:15:33,400354 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-03 21:15:33,400489 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-03 21:15:33,402489 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-03 21:15:33,405477 (Thread-1): finished collecting timing info
2020-03-03 21:15:33,406147 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea4e920-0cda-4ccf-8cef-caa62b31ad0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3c1080>]}
2020-03-03 21:15:33,538218 (Thread-1): 15:15:33 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.05s]
2020-03-03 21:15:33,538434 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-03 21:15:33,586862 (MainThread): Using postgres connection "master".
2020-03-03 21:15:33,587182 (MainThread): On master: BEGIN
2020-03-03 21:15:33,587917 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-03 21:15:33,588223 (MainThread): On master: COMMIT
2020-03-03 21:15:33,588500 (MainThread): Using postgres connection "master".
2020-03-03 21:15:33,588700 (MainThread): On master: COMMIT
2020-03-03 21:15:33,589295 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-03 21:15:33,589985 (MainThread): 15:15:33 | 
2020-03-03 21:15:33,590292 (MainThread): 15:15:33 | Finished running 2 view models, 2 table models in 1.03s.
2020-03-03 21:15:33,590731 (MainThread): Connection 'master' was left open.
2020-03-03 21:15:33,591080 (MainThread): On master: Close
2020-03-03 21:15:33,591421 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-03 21:15:33,591754 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-03 21:15:33,606938 (MainThread): 
2020-03-03 21:15:33,607320 (MainThread): Completed successfully
2020-03-03 21:15:33,607712 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-03-03 21:15:33,608101 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3a6860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3c3390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3c3e80>]}
2020-03-03 21:15:33,741960 (MainThread): Flushing usage events
2020-03-25 20:11:04,772720 (MainThread): Running with dbt=0.15.2
2020-03-25 20:11:04,896759 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-03-25 20:11:04,897687 (MainThread): Tracking: tracking
2020-03-25 20:11:04,911267 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440a198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440a1d0>]}
2020-03-25 20:11:06,96003 (MainThread): Partial parsing not enabled
2020-03-25 20:11:06,114478 (MainThread): Parsing macros/core.sql
2020-03-25 20:11:06,118341 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-25 20:11:06,124067 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-25 20:11:06,125858 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-25 20:11:06,140788 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-25 20:11:06,155806 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-25 20:11:06,169945 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-25 20:11:06,172095 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-25 20:11:06,177531 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-25 20:11:06,183559 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-25 20:11:06,188903 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-25 20:11:06,194592 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-25 20:11:06,198925 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-25 20:11:06,200213 (MainThread): Parsing macros/etc/query.sql
2020-03-25 20:11:06,201507 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-25 20:11:06,203263 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-25 20:11:06,205375 (MainThread): Parsing macros/etc/datetime.sql
2020-03-25 20:11:06,212617 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-25 20:11:06,214745 (MainThread): Parsing macros/adapters/common.sql
2020-03-25 20:11:06,237804 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-25 20:11:06,239310 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-25 20:11:06,240534 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-25 20:11:06,241899 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-25 20:11:06,244163 (MainThread): Parsing macros/catalog.sql
2020-03-25 20:11:06,246018 (MainThread): Parsing macros/relations.sql
2020-03-25 20:11:06,247389 (MainThread): Parsing macros/adapters.sql
2020-03-25 20:11:06,255816 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-25 20:11:06,274015 (MainThread): Partial parsing not enabled
2020-03-25 20:11:06,276342 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-25 20:11:06,306664 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-25 20:11:06,306845 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:11:06,323471 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-25 20:11:06,323610 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:11:06,331266 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-25 20:11:06,331412 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:11:06,339069 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-25 20:11:06,339225 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:11:06,378176 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-25 20:11:06,378345 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:11:06,390008 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-25 20:11:06,390157 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:11:06,400208 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-25 20:11:06,400367 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:11:06,407879 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-25 20:11:06,408032 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:11:06,421791 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-25 20:11:06,421949 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:11:06,430216 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-25 20:11:06,430411 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:11:06,504859 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-25 20:11:06,512081 (MainThread): 
2020-03-25 20:11:06,512370 (MainThread): 15:11:06 | Concurrency: 1 threads (target='dev')
2020-03-25 20:11:06,512561 (MainThread): 15:11:06 | 
2020-03-25 20:11:06,514791 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-25 20:11:06,515148 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-25 20:11:06,515238 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:11:06,515343 (Thread-1): Compiling seed.civis_platform.ad_account_metrics
2020-03-25 20:11:06,525877 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,526179 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,526538 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-25 20:11:06,526674 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-25 20:11:06,527048 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-25 20:11:06,527139 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:11:06,527218 (Thread-1): Compiling seed.civis_platform.dim_date
2020-03-25 20:11:06,531361 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,531590 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,531911 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-25 20:11:06,532041 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-25 20:11:06,532526 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-25 20:11:06,532617 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:11:06,532694 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-25 20:11:06,546128 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-25 20:11:06,546807 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,547411 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,547875 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-25 20:11:06,548091 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-25 20:11:06,548469 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-25 20:11:06,548678 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:11:06,548834 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-25 20:11:06,559073 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-25 20:11:06,560087 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,560563 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,561204 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-25 20:11:06,561455 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-25 20:11:06,562155 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-25 20:11:06,562303 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:11:06,562392 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-25 20:11:06,571874 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-25 20:11:06,572723 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,573365 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,574182 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-25 20:11:06,574433 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-25 20:11:06,575116 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-25 20:11:06,575287 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:11:06,575403 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-25 20:11:06,589869 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-25 20:11:06,591061 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,591562 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,592143 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-25 20:11:06,592336 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-25 20:11:06,592717 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-25 20:11:06,592838 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:11:06,592925 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-25 20:11:06,600825 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-25 20:11:06,601690 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,602148 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,602803 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-25 20:11:06,603031 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-25 20:11:06,603426 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-25 20:11:06,603555 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:11:06,603644 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-25 20:11:06,610263 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-25 20:11:06,611187 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,611669 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,612305 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-25 20:11:06,612529 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-25 20:11:06,612984 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-25 20:11:06,613167 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:11:06,613279 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-25 20:11:06,621834 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-25 20:11:06,622566 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,622971 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,623588 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-25 20:11:06,623791 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-25 20:11:06,624251 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-25 20:11:06,624386 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:11:06,624482 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-25 20:11:06,634681 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-25 20:11:06,635267 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,635778 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,636348 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-25 20:11:06,636568 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-25 20:11:06,637075 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-25 20:11:06,637253 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:11:06,637390 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-25 20:11:06,646425 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-25 20:11:06,646934 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,647520 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,648281 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-25 20:11:06,648542 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-25 20:11:06,649068 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-25 20:11:06,649217 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:11:06,649348 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-25 20:11:06,658196 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-25 20:11:06,658758 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,659329 (Thread-1): finished collecting timing info
2020-03-25 20:11:06,659847 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-25 20:11:06,724500 (MainThread): Connection 'test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_' was properly closed.
2020-03-25 20:11:06,724984 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was properly closed.
2020-03-25 20:11:06,762547 (MainThread): 15:11:06 | Done.
2020-03-25 20:11:06,777081 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-03-25 20:11:06,777436 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:11:06,777638 (MainThread): 15:11:06 | Building catalog
2020-03-25 20:11:06,896285 (MainThread): Using postgres connection "generate_catalog".
2020-03-25 20:11:06,896437 (MainThread): On generate_catalog: BEGIN
2020-03-25 20:11:06,914275 (MainThread): SQL status: BEGIN in 0.02 seconds
2020-03-25 20:11:06,914438 (MainThread): Using postgres connection "generate_catalog".
2020-03-25 20:11:06,914589 (MainThread): On generate_catalog: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "generate_catalog"} */

    
    

    select
        'dbryan' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where sch.nspname != 'information_schema'
      and sch.nspname not like 'pg\_%' -- avoid postgres system schemas, '_' is a wildcard so escape it
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-03-25 20:11:06,956813 (MainThread): SQL status: SELECT 26 in 0.04 seconds
2020-03-25 20:11:06,970462 (MainThread): On generate_catalog: ROLLBACK
2020-03-25 20:11:07,49690 (MainThread): 15:11:07 | Catalog written to /Users/dbryan/civisanalytics/dbt_example/target/catalog.json
2020-03-25 20:11:07,50257 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10810a198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10810a0b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10810ec50>]}
2020-03-25 20:11:07,719672 (MainThread): Flushing usage events
2020-03-25 20:11:07,719984 (MainThread): Connection 'generate_catalog' was left open.
2020-03-25 20:11:07,720142 (MainThread): On generate_catalog: Close
2020-03-25 20:24:53,161856 (MainThread): Running with dbt=0.15.2
2020-03-25 20:24:53,189051 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8080, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-03-25 20:24:53,190144 (MainThread): Tracking: tracking
2020-03-25 20:24:53,209155 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115feda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115fe898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115fea90>]}
2020-03-25 20:24:53,769034 (MainThread): Serving docs at 0.0.0.0:8080
2020-03-25 20:24:53,769753 (MainThread): To access from your browser, navigate to http://localhost:8080.
2020-03-25 20:24:53,770195 (MainThread): Press Ctrl+C to exit.


2020-03-25 20:31:04,721393 (MainThread): Flushing usage events
2020-03-25 20:31:04,724117 (MainThread): ctrl-c
2020-03-25 20:32:36,437783 (MainThread): Running with dbt=0.15.2
2020-03-25 20:32:36,608963 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-03-25 20:32:36,609637 (MainThread): Tracking: tracking
2020-03-25 20:32:36,619689 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112862da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c06f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c067b8>]}
2020-03-25 20:32:37,803140 (MainThread): Partial parsing not enabled
2020-03-25 20:32:37,806273 (MainThread): Parsing macros/core.sql
2020-03-25 20:32:37,810832 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-25 20:32:37,816558 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-25 20:32:37,818543 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-25 20:32:37,831955 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-25 20:32:37,847119 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-25 20:32:37,861075 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-25 20:32:37,863393 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-25 20:32:37,868805 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-25 20:32:37,875145 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-25 20:32:37,880577 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-25 20:32:37,885667 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-25 20:32:37,890211 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-25 20:32:37,891588 (MainThread): Parsing macros/etc/query.sql
2020-03-25 20:32:37,893021 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-25 20:32:37,894914 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-25 20:32:37,897092 (MainThread): Parsing macros/etc/datetime.sql
2020-03-25 20:32:37,904474 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-25 20:32:37,907075 (MainThread): Parsing macros/adapters/common.sql
2020-03-25 20:32:37,929354 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-25 20:32:37,930787 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-25 20:32:37,932011 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-25 20:32:37,933416 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-25 20:32:37,936221 (MainThread): Parsing macros/catalog.sql
2020-03-25 20:32:37,938116 (MainThread): Parsing macros/relations.sql
2020-03-25 20:32:37,939770 (MainThread): Parsing macros/adapters.sql
2020-03-25 20:32:37,948169 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-25 20:32:37,966469 (MainThread): Partial parsing not enabled
2020-03-25 20:32:37,968414 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-25 20:32:37,985327 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-25 20:32:37,985489 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:32:38,4535 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-25 20:32:38,4710 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:32:38,12272 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-25 20:32:38,12460 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:32:38,24191 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-25 20:32:38,24352 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:32:38,66064 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-25 20:32:38,66232 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:32:38,78016 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-25 20:32:38,78172 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:32:38,88338 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-25 20:32:38,88487 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:32:38,96125 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-25 20:32:38,96272 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:32:38,108943 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-25 20:32:38,109097 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:32:38,116819 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-25 20:32:38,117027 (MainThread): Opening a new connection, currently in state init
2020-03-25 20:32:38,206965 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-25 20:32:38,216984 (MainThread): 
2020-03-25 20:32:38,217214 (MainThread): 15:32:38 | Concurrency: 1 threads (target='dev')
2020-03-25 20:32:38,217425 (MainThread): 15:32:38 | 
2020-03-25 20:32:38,220007 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-25 20:32:38,220387 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-25 20:32:38,220477 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:32:38,220570 (Thread-1): Compiling seed.civis_platform.ad_account_metrics
2020-03-25 20:32:38,232033 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,232379 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,232816 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-25 20:32:38,232945 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-25 20:32:38,233156 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-25 20:32:38,233240 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:32:38,233321 (Thread-1): Compiling seed.civis_platform.dim_date
2020-03-25 20:32:38,237592 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,237964 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,238311 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-25 20:32:38,238441 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-25 20:32:38,238754 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-25 20:32:38,239039 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:32:38,239229 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-25 20:32:38,253296 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-25 20:32:38,253790 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,254300 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,254892 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-25 20:32:38,255101 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-25 20:32:38,255656 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-25 20:32:38,256219 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:32:38,256358 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-25 20:32:38,266760 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-25 20:32:38,267388 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,267877 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,268580 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-25 20:32:38,268802 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-25 20:32:38,269369 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-25 20:32:38,269524 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:32:38,269626 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-25 20:32:38,281403 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-25 20:32:38,282642 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,283873 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,284957 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-25 20:32:38,285326 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-25 20:32:38,286070 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-25 20:32:38,286242 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:32:38,286378 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-25 20:32:38,301780 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-25 20:32:38,302396 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,302687 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,303047 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-25 20:32:38,303169 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-25 20:32:38,303590 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-25 20:32:38,303738 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:32:38,303946 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-25 20:32:38,313775 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-25 20:32:38,314335 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,314814 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,315509 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-25 20:32:38,315770 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-25 20:32:38,316197 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-25 20:32:38,316338 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:32:38,316439 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-25 20:32:38,323198 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-25 20:32:38,324041 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,324671 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,325275 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-25 20:32:38,325466 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-25 20:32:38,325839 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-25 20:32:38,325966 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:32:38,326053 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-25 20:32:38,334966 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-25 20:32:38,335495 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,335976 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,336627 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-25 20:32:38,336830 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-25 20:32:38,337244 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-25 20:32:38,337382 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:32:38,337483 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-25 20:32:38,346503 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-25 20:32:38,347178 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,347709 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,348402 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-25 20:32:38,348703 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-25 20:32:38,349167 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-25 20:32:38,349295 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:32:38,349383 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-25 20:32:38,357431 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-25 20:32:38,357973 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,358583 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,359202 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-25 20:32:38,359393 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-25 20:32:38,359743 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-25 20:32:38,359862 (Thread-1): Opening a new connection, currently in state init
2020-03-25 20:32:38,359951 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-25 20:32:38,367720 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-25 20:32:38,368182 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,368764 (Thread-1): finished collecting timing info
2020-03-25 20:32:38,369359 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-25 20:32:38,429223 (MainThread): Connection 'test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_' was properly closed.
2020-03-25 20:32:38,429631 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was properly closed.
2020-03-25 20:32:38,462406 (MainThread): 15:32:38 | Done.
2020-03-25 20:32:38,462685 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0a0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f13ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f13aef0>]}
2020-03-25 20:32:39,425794 (MainThread): Flushing usage events
2020-03-25 20:38:54,31820 (MainThread): Running with dbt=0.15.2
2020-03-25 20:38:54,55733 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8080, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-03-25 20:38:54,56205 (MainThread): Tracking: tracking
2020-03-25 20:38:54,66430 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b1de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b468d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b46b00>]}
2020-03-25 20:38:55,520673 (MainThread): Serving docs at 0.0.0.0:8080
2020-03-25 20:38:55,521012 (MainThread): To access from your browser, navigate to http://localhost:8080.
2020-03-25 20:38:55,521218 (MainThread): Press Ctrl+C to exit.


2020-03-25 20:40:20,522336 (MainThread): Flushing usage events
2020-03-25 20:40:20,523481 (MainThread): ctrl-c
2020-03-26 15:36:45,45925 (MainThread): Running with dbt=0.15.2
2020-03-26 15:36:45,243904 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-03-26 15:36:45,244930 (MainThread): Tracking: tracking
2020-03-26 15:36:45,269964 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112da66d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11314c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11314c080>]}
2020-03-26 15:36:45,631125 (MainThread): Partial parsing not enabled
2020-03-26 15:36:45,634785 (MainThread): Parsing macros/core.sql
2020-03-26 15:36:45,638712 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-26 15:36:45,644535 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-26 15:36:45,646573 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-26 15:36:45,661440 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-26 15:36:45,676278 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-26 15:36:45,690572 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-26 15:36:45,692639 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-26 15:36:45,698261 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-26 15:36:45,704549 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-26 15:36:45,709997 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-26 15:36:45,715176 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-26 15:36:45,720007 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-26 15:36:45,721347 (MainThread): Parsing macros/etc/query.sql
2020-03-26 15:36:45,722774 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-26 15:36:45,724641 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-26 15:36:45,726866 (MainThread): Parsing macros/etc/datetime.sql
2020-03-26 15:36:45,733835 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-26 15:36:45,736068 (MainThread): Parsing macros/adapters/common.sql
2020-03-26 15:36:45,759622 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-26 15:36:45,761190 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-26 15:36:45,762625 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-26 15:36:45,764042 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-26 15:36:45,766464 (MainThread): Parsing macros/catalog.sql
2020-03-26 15:36:45,768305 (MainThread): Parsing macros/relations.sql
2020-03-26 15:36:45,769818 (MainThread): Parsing macros/adapters.sql
2020-03-26 15:36:45,778956 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-26 15:36:45,797708 (MainThread): Partial parsing not enabled
2020-03-26 15:36:45,799868 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-26 15:36:45,816834 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 15:36:45,817107 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:45,833779 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 15:36:45,833944 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:45,841063 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 15:36:45,841208 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:45,849651 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 15:36:45,849824 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:45,890255 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-26 15:36:45,890436 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:45,902198 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-26 15:36:45,902368 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:45,912722 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-26 15:36:45,912888 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:45,920199 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-26 15:36:45,920342 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:45,934084 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-26 15:36:45,934239 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:45,942001 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-26 15:36:45,942149 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:46,12283 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-26 15:36:46,20947 (MainThread): 
2020-03-26 15:36:46,21197 (MainThread): 10:36:46 | Concurrency: 1 threads (target='dev')
2020-03-26 15:36:46,21362 (MainThread): 10:36:46 | 
2020-03-26 15:36:46,23667 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-26 15:36:46,24068 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-26 15:36:46,24165 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:46,24257 (Thread-1): Compiling seed.civis_platform.ad_account_metrics
2020-03-26 15:36:46,35766 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,36074 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,36475 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-26 15:36:46,36611 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-26 15:36:46,37088 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-26 15:36:46,37199 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:46,37279 (Thread-1): Compiling seed.civis_platform.dim_date
2020-03-26 15:36:46,41495 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,41724 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,42049 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-26 15:36:46,42182 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-26 15:36:46,42436 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 15:36:46,42775 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:46,42871 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-26 15:36:46,56845 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-26 15:36:46,58805 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,59297 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,60224 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-26 15:36:46,60464 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-26 15:36:46,60938 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 15:36:46,61084 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:46,61374 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-26 15:36:46,73476 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-26 15:36:46,74706 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,75368 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,76189 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-26 15:36:46,76457 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-26 15:36:46,77170 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 15:36:46,77343 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:46,77461 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-26 15:36:46,85722 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-26 15:36:46,86381 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,87156 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,88113 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-26 15:36:46,88332 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-26 15:36:46,89110 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-26 15:36:46,89383 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:46,89538 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-26 15:36:46,106199 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-26 15:36:46,107668 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,108246 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,108892 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-26 15:36:46,109100 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-26 15:36:46,109491 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-26 15:36:46,109632 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:46,109726 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-26 15:36:46,117541 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-26 15:36:46,118061 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,118555 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,119212 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-26 15:36:46,119431 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-26 15:36:46,119844 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 15:36:46,119979 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:46,120074 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-26 15:36:46,126502 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-26 15:36:46,127151 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,127759 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,128492 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-26 15:36:46,128684 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-26 15:36:46,129075 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-26 15:36:46,129205 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:46,129302 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-26 15:36:46,137169 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-26 15:36:46,138074 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,138636 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,139354 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-26 15:36:46,139566 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-26 15:36:46,139982 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-26 15:36:46,140116 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:46,140213 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-26 15:36:46,150028 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-26 15:36:46,151066 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,151560 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,152157 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-26 15:36:46,152348 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-26 15:36:46,152719 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-26 15:36:46,152837 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:46,152923 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-26 15:36:46,160681 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-26 15:36:46,162091 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,162720 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,163217 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-26 15:36:46,163397 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-26 15:36:46,163735 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-26 15:36:46,163827 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:46,163909 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-26 15:36:46,171709 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-26 15:36:46,172310 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,172871 (Thread-1): finished collecting timing info
2020-03-26 15:36:46,173544 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-26 15:36:46,229857 (MainThread): Connection 'test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_' was properly closed.
2020-03-26 15:36:46,230247 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was properly closed.
2020-03-26 15:36:46,261094 (MainThread): 10:36:46 | Done.
2020-03-26 15:36:46,261435 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5b0128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f57c2e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f57c630>]}
2020-03-26 15:36:46,475947 (MainThread): Flushing usage events
2020-03-26 15:36:56,45588 (MainThread): Running with dbt=0.15.2
2020-03-26 15:36:56,155306 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-03-26 15:36:56,158737 (MainThread): Tracking: tracking
2020-03-26 15:36:56,173212 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8336d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c833940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c833908>]}
2020-03-26 15:36:56,434064 (MainThread): Partial parsing not enabled
2020-03-26 15:36:56,436402 (MainThread): Parsing macros/core.sql
2020-03-26 15:36:56,440327 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-26 15:36:56,446197 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-26 15:36:56,448881 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-26 15:36:56,464011 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-26 15:36:56,479752 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-26 15:36:56,494163 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-26 15:36:56,496225 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-26 15:36:56,503239 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-26 15:36:56,511210 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-26 15:36:56,521238 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-26 15:36:56,530002 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-26 15:36:56,535935 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-26 15:36:56,537193 (MainThread): Parsing macros/etc/query.sql
2020-03-26 15:36:56,538833 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-26 15:36:56,540924 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-26 15:36:56,543171 (MainThread): Parsing macros/etc/datetime.sql
2020-03-26 15:36:56,551299 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-26 15:36:56,553665 (MainThread): Parsing macros/adapters/common.sql
2020-03-26 15:36:56,579749 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-26 15:36:56,583663 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-26 15:36:56,585955 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-26 15:36:56,588226 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-26 15:36:56,591356 (MainThread): Parsing macros/catalog.sql
2020-03-26 15:36:56,593814 (MainThread): Parsing macros/relations.sql
2020-03-26 15:36:56,595535 (MainThread): Parsing macros/adapters.sql
2020-03-26 15:36:56,606372 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-26 15:36:56,625208 (MainThread): Partial parsing not enabled
2020-03-26 15:36:56,626062 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-26 15:36:56,641390 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 15:36:56,641552 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:56,659361 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 15:36:56,659507 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:56,666485 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 15:36:56,666633 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:56,673840 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 15:36:56,673984 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:56,716400 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-26 15:36:56,716657 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:56,728756 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-26 15:36:56,728928 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:56,740234 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-26 15:36:56,740386 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:56,748242 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-26 15:36:56,748415 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:56,760471 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-26 15:36:56,760646 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:56,768762 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-26 15:36:56,768904 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:56,842247 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-26 15:36:56,848099 (MainThread): 
2020-03-26 15:36:56,848319 (MainThread): 10:36:56 | Concurrency: 1 threads (target='dev')
2020-03-26 15:36:56,848487 (MainThread): 10:36:56 | 
2020-03-26 15:36:56,850711 (Thread-1): Began running node seed.civis_platform.ad_account_metrics
2020-03-26 15:36:56,851091 (Thread-1): Acquiring new postgres connection "seed.civis_platform.ad_account_metrics".
2020-03-26 15:36:56,851178 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:56,851267 (Thread-1): Compiling seed.civis_platform.ad_account_metrics
2020-03-26 15:36:56,862678 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,862976 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,863332 (Thread-1): Finished running node seed.civis_platform.ad_account_metrics
2020-03-26 15:36:56,863464 (Thread-1): Began running node seed.civis_platform.dim_date
2020-03-26 15:36:56,863710 (Thread-1): Acquiring new postgres connection "seed.civis_platform.dim_date".
2020-03-26 15:36:56,863821 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:56,863928 (Thread-1): Compiling seed.civis_platform.dim_date
2020-03-26 15:36:56,868360 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,868833 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,869325 (Thread-1): Finished running node seed.civis_platform.dim_date
2020-03-26 15:36:56,869476 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-26 15:36:56,869737 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 15:36:56,869850 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:56,869961 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-26 15:36:56,883759 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-26 15:36:56,884892 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,885451 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,886163 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-26 15:36:56,886449 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-26 15:36:56,887236 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 15:36:56,887397 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:56,887718 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-26 15:36:56,897159 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-26 15:36:56,897819 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,898360 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,899027 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-26 15:36:56,899279 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-26 15:36:56,899969 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 15:36:56,900150 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:56,900282 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-26 15:36:56,909505 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-26 15:36:56,910950 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,911601 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,912561 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-26 15:36:56,912912 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-26 15:36:56,913520 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-26 15:36:56,913645 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:56,913739 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-26 15:36:56,928399 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-26 15:36:56,929284 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,929720 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,930265 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-26 15:36:56,930462 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-26 15:36:56,930848 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-26 15:36:56,930969 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:56,931051 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-26 15:36:56,939616 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-26 15:36:56,940309 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,940802 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,941403 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-26 15:36:56,941582 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-26 15:36:56,941944 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 15:36:56,942063 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:56,942146 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-26 15:36:56,948614 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-26 15:36:56,949154 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,949665 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,950382 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-26 15:36:56,950719 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-26 15:36:56,951336 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-26 15:36:56,951492 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:56,951606 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-26 15:36:56,960107 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-26 15:36:56,960729 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,961205 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,961796 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-26 15:36:56,961972 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-26 15:36:56,962333 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-26 15:36:56,962462 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:56,962546 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-26 15:36:56,972298 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-26 15:36:56,972881 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,973426 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,973987 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-26 15:36:56,974168 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-26 15:36:56,974524 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-26 15:36:56,974641 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:56,974722 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-26 15:36:56,982353 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-26 15:36:56,983458 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,983937 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,984454 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-26 15:36:56,984616 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-26 15:36:56,984940 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-26 15:36:56,985034 (Thread-1): Opening a new connection, currently in state init
2020-03-26 15:36:56,985113 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-26 15:36:56,992834 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-26 15:36:56,993694 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,994118 (Thread-1): finished collecting timing info
2020-03-26 15:36:56,994636 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-26 15:36:57,55441 (MainThread): Connection 'test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_' was properly closed.
2020-03-26 15:36:57,55799 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was properly closed.
2020-03-26 15:36:57,88567 (MainThread): 10:36:57 | Done.
2020-03-26 15:36:57,97624 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-03-26 15:36:57,97850 (MainThread): Opening a new connection, currently in state init
2020-03-26 15:36:57,97966 (MainThread): 10:36:57 | Building catalog
2020-03-26 15:36:57,210356 (MainThread): Using postgres connection "generate_catalog".
2020-03-26 15:36:57,210503 (MainThread): On generate_catalog: BEGIN
2020-03-26 15:36:57,226385 (MainThread): SQL status: BEGIN in 0.02 seconds
2020-03-26 15:36:57,226564 (MainThread): Using postgres connection "generate_catalog".
2020-03-26 15:36:57,226686 (MainThread): On generate_catalog: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "generate_catalog"} */

    
    

    select
        'dbryan' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where sch.nspname != 'information_schema'
      and sch.nspname not like 'pg\_%' -- avoid postgres system schemas, '_' is a wildcard so escape it
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-03-26 15:36:57,239602 (MainThread): SQL status: SELECT 26 in 0.01 seconds
2020-03-26 15:36:57,250241 (MainThread): On generate_catalog: ROLLBACK
2020-03-26 15:36:57,319301 (MainThread): 10:36:57 | Catalog written to /Users/dbryan/civisanalytics/dbt_example/target/catalog.json
2020-03-26 15:36:57,320696 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d88208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d32748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1f0b8>]}
2020-03-26 15:36:57,541914 (MainThread): Flushing usage events
2020-03-26 15:36:57,542253 (MainThread): Connection 'generate_catalog' was left open.
2020-03-26 15:36:57,542408 (MainThread): On generate_catalog: Close
2020-03-26 17:40:55,725629 (MainThread): Running with dbt=0.15.2
2020-03-26 17:40:55,857174 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-03-26 17:40:55,873812 (MainThread): Tracking: tracking
2020-03-26 17:40:55,896122 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ac5f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ac080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ac208>]}
2020-03-26 17:40:56,290689 (MainThread): Partial parsing not enabled
2020-03-26 17:40:56,297191 (MainThread): Parsing macros/core.sql
2020-03-26 17:40:56,307210 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-26 17:40:56,316733 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-26 17:40:56,319139 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-26 17:40:56,334428 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-26 17:40:56,349345 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-26 17:40:56,367293 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-26 17:40:56,369435 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-26 17:40:56,374910 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-26 17:40:56,381025 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-26 17:40:56,386360 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-26 17:40:56,391355 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-26 17:40:56,395650 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-26 17:40:56,397367 (MainThread): Parsing macros/etc/query.sql
2020-03-26 17:40:56,398849 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-26 17:40:56,400709 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-26 17:40:56,402946 (MainThread): Parsing macros/etc/datetime.sql
2020-03-26 17:40:56,409960 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-26 17:40:56,412052 (MainThread): Parsing macros/adapters/common.sql
2020-03-26 17:40:56,434389 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-26 17:40:56,435822 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-26 17:40:56,437202 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-26 17:40:56,438600 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-26 17:40:56,441013 (MainThread): Parsing macros/catalog.sql
2020-03-26 17:40:56,442794 (MainThread): Parsing macros/relations.sql
2020-03-26 17:40:56,444288 (MainThread): Parsing macros/adapters.sql
2020-03-26 17:40:56,452863 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-26 17:40:56,472237 (MainThread): Partial parsing not enabled
2020-03-26 17:40:56,473621 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-26 17:40:56,489444 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 17:40:56,489605 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:40:56,507521 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 17:40:56,507666 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:40:56,514957 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 17:40:56,515110 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:40:56,521815 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 17:40:56,521967 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:40:56,561735 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-26 17:40:56,561939 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:40:56,574052 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-26 17:40:56,574264 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:40:56,584795 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-26 17:40:56,584971 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:40:56,592655 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-26 17:40:56,592800 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:40:56,605675 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-26 17:40:56,605839 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:40:56,613520 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-26 17:40:56,613702 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:40:56,686976 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-26 17:40:56,693473 (MainThread): 
2020-03-26 17:40:56,693864 (MainThread): Acquiring new postgres connection "master".
2020-03-26 17:40:56,693979 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:40:56,779459 (MainThread): Using postgres connection "master".
2020-03-26 17:40:56,779622 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */

    select distinct nspname from pg_namespace
  
2020-03-26 17:40:56,808663 (MainThread): SQL status: SELECT 6 in 0.03 seconds
2020-03-26 17:40:56,856851 (MainThread): Using postgres connection "master".
2020-03-26 17:40:56,857026 (MainThread): On master: BEGIN
2020-03-26 17:40:56,858624 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-26 17:40:56,858851 (MainThread): Using postgres connection "master".
2020-03-26 17:40:56,858997 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-26 17:40:56,883611 (MainThread): SQL status: SELECT 7 in 0.02 seconds
2020-03-26 17:40:56,926491 (MainThread): Using postgres connection "master".
2020-03-26 17:40:56,926660 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-26 17:40:56,985320 (MainThread): SQL status: SELECT 3 in 0.06 seconds
2020-03-26 17:40:56,989220 (MainThread): On master: ROLLBACK
2020-03-26 17:40:56,989552 (MainThread): Using postgres connection "master".
2020-03-26 17:40:56,989651 (MainThread): On master: BEGIN
2020-03-26 17:40:56,990037 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-26 17:40:56,990141 (MainThread): On master: COMMIT
2020-03-26 17:40:56,990224 (MainThread): Using postgres connection "master".
2020-03-26 17:40:56,990293 (MainThread): On master: COMMIT
2020-03-26 17:40:56,990505 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-26 17:40:56,990758 (MainThread): 12:40:56 | Concurrency: 1 threads (target='dev')
2020-03-26 17:40:56,990888 (MainThread): 12:40:56 | 
2020-03-26 17:40:56,993583 (Thread-1): Began running node model.civis_platform.fact_daily_performance
2020-03-26 17:40:56,993797 (Thread-1): 12:40:56 | 1 of 4 START view model public.fact_daily_performance................ [RUN]
2020-03-26 17:40:56,994106 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 17:40:56,994207 (Thread-1): Opening a new connection, currently in state init
2020-03-26 17:40:56,994296 (Thread-1): Compiling model.civis_platform.fact_daily_performance
2020-03-26 17:40:57,11095 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_daily_performance"
2020-03-26 17:40:57,13209 (Thread-1): finished collecting timing info
2020-03-26 17:40:57,51942 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 17:40:57,52344 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_tmp" cascade
2020-03-26 17:40:57,62747 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-03-26 17:40:57,66224 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 17:40:57,66393 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-26 17:40:57,66843 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-26 17:40:57,68312 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 17:40:57,68434 (Thread-1): On model.civis_platform.fact_daily_performance: BEGIN
2020-03-26 17:40:57,68868 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-26 17:40:57,68984 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 17:40:57,69066 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-26 17:40:57,99347 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2020-03-26 17:40:57,100799 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_daily_performance"
2020-03-26 17:40:57,102167 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 17:40:57,102439 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

  
  create view "dbryan"."public"."fact_daily_performance__dbt_tmp" as (
    select
    a.*,
    
case
    when clicks >= 100
        then 'high clicks'
    when (spend / clicks) <= 1.00 and impressions > 1000
        then 'well optimized'
    when (spend / clicks) > 3.00 and impressions > 100
        then 'unoptimized'
    else
        'normal'
    end as daily_performance_result_tag

from
    (
    select
        d.date,
        d.business_day,
        ad.impressions,
        ad.clicks,
        ad.spend::numeric(7,0) as spend,
        round(ad.spend::numeric / ad.impressions::numeric, 2) as cost_per_impression,
        round(ad.spend::numeric / ad.clicks::numeric, 2) as cost_per_click, 
        round(ad.clicks::numeric / ad.impressions::numeric, 4) as click_through_rate
    from 
        "dbryan"."public"."dim_date" d
        inner join "dbryan"."public"."ad_account_metrics" ad
            on ad.date = d.date
    where
        d.date >= '2020-03-03'
    ) a
order by 
    a.date
  );

2020-03-26 17:40:57,115808 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-03-26 17:40:57,119463 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 17:40:57,119595 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance" rename to "fact_daily_performance__dbt_backup"
2020-03-26 17:40:57,120321 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-26 17:40:57,122396 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 17:40:57,122501 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
alter table "dbryan"."public"."fact_daily_performance__dbt_tmp" rename to "fact_daily_performance"
2020-03-26 17:40:57,123142 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-26 17:40:57,124452 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 17:40:57,124550 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-26 17:40:57,125932 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-26 17:40:57,126643 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-26 17:40:57,126740 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 17:40:57,126815 (Thread-1): On model.civis_platform.fact_daily_performance: COMMIT
2020-03-26 17:40:57,132789 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-03-26 17:40:57,134464 (Thread-1): Using postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 17:40:57,134580 (Thread-1): On model.civis_platform.fact_daily_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_daily_performance"} */
drop view if exists "dbryan"."public"."fact_daily_performance__dbt_backup" cascade
2020-03-26 17:40:57,138237 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-26 17:40:57,140544 (Thread-1): finished collecting timing info
2020-03-26 17:40:57,141141 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '081adc8a-f33e-497c-b870-9e14332c2548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102799ac8>]}
2020-03-26 17:40:57,350103 (Thread-1): 12:40:57 | 1 of 4 OK created view model public.fact_daily_performance........... [CREATE VIEW in 0.15s]
2020-03-26 17:40:57,350422 (Thread-1): Finished running node model.civis_platform.fact_daily_performance
2020-03-26 17:40:57,350653 (Thread-1): Began running node model.civis_platform.my_first_dbt_model
2020-03-26 17:40:57,350866 (Thread-1): 12:40:57 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2020-03-26 17:40:57,351330 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 17:40:57,351492 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_daily_performance).
2020-03-26 17:40:57,351633 (Thread-1): Compiling model.civis_platform.my_first_dbt_model
2020-03-26 17:40:57,360990 (Thread-1): Writing injected SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-26 17:40:57,364463 (Thread-1): finished collecting timing info
2020-03-26 17:40:57,385652 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 17:40:57,385834 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_tmp" cascade
2020-03-26 17:40:57,386483 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-26 17:40:57,389820 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 17:40:57,389991 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-26 17:40:57,390361 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-26 17:40:57,392177 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 17:40:57,392335 (Thread-1): On model.civis_platform.my_first_dbt_model: BEGIN
2020-03-26 17:40:57,392630 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-26 17:40:57,392738 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 17:40:57,392817 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-26 17:40:57,397630 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-26 17:40:57,398983 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_first_dbt_model"
2020-03-26 17:40:57,399650 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 17:40:57,399844 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */


  create  table "dbryan"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
2020-03-26 17:40:57,401684 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2020-03-26 17:40:57,405802 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 17:40:57,406021 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2020-03-26 17:40:57,406503 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-26 17:40:57,409204 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 17:40:57,409370 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
alter table "dbryan"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2020-03-26 17:40:57,410311 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-26 17:40:57,412292 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 17:40:57,412839 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-26 17:40:57,413977 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-26 17:40:57,415188 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-26 17:40:57,415372 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 17:40:57,415467 (Thread-1): On model.civis_platform.my_first_dbt_model: COMMIT
2020-03-26 17:40:57,417757 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-26 17:40:57,422059 (Thread-1): Using postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 17:40:57,422746 (Thread-1): On model.civis_platform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_first_dbt_model"} */
drop table if exists "dbryan"."public"."my_first_dbt_model__dbt_backup" cascade
2020-03-26 17:40:57,425489 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-26 17:40:57,428851 (Thread-1): finished collecting timing info
2020-03-26 17:40:57,429967 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '081adc8a-f33e-497c-b870-9e14332c2548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10288d0f0>]}
2020-03-26 17:40:57,728739 (Thread-1): 12:40:57 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2020-03-26 17:40:57,729622 (Thread-1): Finished running node model.civis_platform.my_first_dbt_model
2020-03-26 17:40:57,729880 (Thread-1): Began running node model.civis_platform.fact_monthly_performance
2020-03-26 17:40:57,730301 (Thread-1): 12:40:57 | 3 of 4 START view model public.fact_monthly_performance.............. [RUN]
2020-03-26 17:40:57,730818 (Thread-1): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 17:40:57,730956 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.my_first_dbt_model).
2020-03-26 17:40:57,731072 (Thread-1): Compiling model.civis_platform.fact_monthly_performance
2020-03-26 17:40:57,739927 (Thread-1): Writing injected SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-26 17:40:57,747030 (Thread-1): finished collecting timing info
2020-03-26 17:40:57,756333 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 17:40:57,756508 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_tmp" cascade
2020-03-26 17:40:57,757016 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-26 17:40:57,760699 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 17:40:57,760874 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-26 17:40:57,761202 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-26 17:40:57,762770 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 17:40:57,762877 (Thread-1): On model.civis_platform.fact_monthly_performance: BEGIN
2020-03-26 17:40:57,763096 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-26 17:40:57,763192 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 17:40:57,763269 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-26 17:40:57,767146 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-26 17:40:57,769312 (Thread-1): Writing runtime SQL for node "model.civis_platform.fact_monthly_performance"
2020-03-26 17:40:57,769967 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 17:40:57,770130 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

  
  create view "dbryan"."public"."fact_monthly_performance__dbt_tmp" as (
    select
    date_trunc('month', f.date)::date as month,
    sum(impressions) as impressions,
    sum(clicks) as clicks,
    sum(spend) as spend,
    round(avg(spend)::numeric, 2) as average_daily_spend
from
    "dbryan"."public"."fact_daily_performance" f
group by 
    date_trunc('month', f.date)::date
order by
    date_trunc('month', f.date)::date
  );

2020-03-26 17:40:57,776177 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-03-26 17:40:57,781075 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 17:40:57,781478 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
alter table "dbryan"."public"."fact_monthly_performance__dbt_tmp" rename to "fact_monthly_performance"
2020-03-26 17:40:57,782395 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-26 17:40:57,785674 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 17:40:57,786072 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-26 17:40:57,787342 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-26 17:40:57,789605 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-26 17:40:57,790050 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 17:40:57,790213 (Thread-1): On model.civis_platform.fact_monthly_performance: COMMIT
2020-03-26 17:40:57,793064 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-26 17:40:57,796381 (Thread-1): Using postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 17:40:57,796536 (Thread-1): On model.civis_platform.fact_monthly_performance: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.fact_monthly_performance"} */
drop view if exists "dbryan"."public"."fact_monthly_performance__dbt_backup" cascade
2020-03-26 17:40:57,797893 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-03-26 17:40:57,800893 (Thread-1): finished collecting timing info
2020-03-26 17:40:57,801710 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '081adc8a-f33e-497c-b870-9e14332c2548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2d470>]}
2020-03-26 17:40:58,14575 (Thread-1): 12:40:58 | 3 of 4 OK created view model public.fact_monthly_performance......... [CREATE VIEW in 0.07s]
2020-03-26 17:40:58,15280 (Thread-1): Finished running node model.civis_platform.fact_monthly_performance
2020-03-26 17:40:58,15842 (Thread-1): Began running node model.civis_platform.my_second_dbt_model
2020-03-26 17:40:58,16279 (Thread-1): 12:40:58 | 4 of 4 START table model public.my_second_dbt_model.................. [RUN]
2020-03-26 17:40:58,16774 (Thread-1): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 17:40:58,16927 (Thread-1): Re-using an available connection from the pool (formerly model.civis_platform.fact_monthly_performance).
2020-03-26 17:40:58,17077 (Thread-1): Compiling model.civis_platform.my_second_dbt_model
2020-03-26 17:40:58,25447 (Thread-1): Writing injected SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-26 17:40:58,26074 (Thread-1): finished collecting timing info
2020-03-26 17:40:58,33721 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 17:40:58,33898 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_tmp" cascade
2020-03-26 17:40:58,34225 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-26 17:40:58,36466 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 17:40:58,36619 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-26 17:40:58,37099 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-26 17:40:58,41438 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 17:40:58,41614 (Thread-1): On model.civis_platform.my_second_dbt_model: BEGIN
2020-03-26 17:40:58,41847 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-26 17:40:58,41944 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 17:40:58,42021 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        drop table if exists last_run; select current_timestamp as last_run_start, null as last_run_finish into last_run;
      
2020-03-26 17:40:58,45943 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-26 17:40:58,47268 (Thread-1): Writing runtime SQL for node "model.civis_platform.my_second_dbt_model"
2020-03-26 17:40:58,48628 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 17:40:58,49390 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */


  create  table "dbryan"."public"."my_second_dbt_model__dbt_tmp"
  as (
    -- Use the `ref` function to select from other models

select *
from "dbryan"."public"."my_first_dbt_model"
where id = 1
  );
2020-03-26 17:40:58,53621 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-26 17:40:58,62008 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 17:40:58,62170 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
2020-03-26 17:40:58,62781 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-26 17:40:58,67284 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 17:40:58,67443 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
alter table "dbryan"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2020-03-26 17:40:58,68166 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-03-26 17:40:58,69523 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 17:40:58,69701 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */

        update last_run set last_run_finish = current_timestamp;
      
2020-03-26 17:40:58,70188 (Thread-1): SQL status: UPDATE 1 in 0.00 seconds
2020-03-26 17:40:58,70862 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-26 17:40:58,70954 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 17:40:58,71025 (Thread-1): On model.civis_platform.my_second_dbt_model: COMMIT
2020-03-26 17:40:58,72603 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-03-26 17:40:58,74290 (Thread-1): Using postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 17:40:58,74403 (Thread-1): On model.civis_platform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "model.civis_platform.my_second_dbt_model"} */
drop table if exists "dbryan"."public"."my_second_dbt_model__dbt_backup" cascade
2020-03-26 17:40:58,75919 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-03-26 17:40:58,78214 (Thread-1): finished collecting timing info
2020-03-26 17:40:58,78769 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '081adc8a-f33e-497c-b870-9e14332c2548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f20a90>]}
2020-03-26 17:40:58,287800 (Thread-1): 12:40:58 | 4 of 4 OK created table model public.my_second_dbt_model............. [SELECT 1 in 0.06s]
2020-03-26 17:40:58,288106 (Thread-1): Finished running node model.civis_platform.my_second_dbt_model
2020-03-26 17:40:58,361317 (MainThread): Using postgres connection "master".
2020-03-26 17:40:58,361776 (MainThread): On master: BEGIN
2020-03-26 17:40:58,369353 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-03-26 17:40:58,369708 (MainThread): On master: COMMIT
2020-03-26 17:40:58,369919 (MainThread): Using postgres connection "master".
2020-03-26 17:40:58,370077 (MainThread): On master: COMMIT
2020-03-26 17:40:58,372235 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-03-26 17:40:58,373031 (MainThread): 12:40:58 | 
2020-03-26 17:40:58,373322 (MainThread): 12:40:58 | Finished running 2 view models, 2 table models in 1.68s.
2020-03-26 17:40:58,373651 (MainThread): Connection 'master' was left open.
2020-03-26 17:40:58,373956 (MainThread): On master: Close
2020-03-26 17:40:58,374277 (MainThread): Connection 'model.civis_platform.my_second_dbt_model' was left open.
2020-03-26 17:40:58,374608 (MainThread): On model.civis_platform.my_second_dbt_model: Close
2020-03-26 17:40:58,393125 (MainThread): 
2020-03-26 17:40:58,393554 (MainThread): Completed successfully
2020-03-26 17:40:58,393809 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-03-26 17:40:58,394137 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f19a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102921240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102921c18>]}
2020-03-26 17:40:58,608356 (MainThread): Flushing usage events
2020-03-26 17:41:02,674700 (MainThread): Running with dbt=0.15.2
2020-03-26 17:41:02,773046 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/dbryan/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-03-26 17:41:02,773803 (MainThread): Tracking: tracking
2020-03-26 17:41:02,797566 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515fb38>]}
2020-03-26 17:41:03,47592 (MainThread): Partial parsing not enabled
2020-03-26 17:41:03,51295 (MainThread): Parsing macros/core.sql
2020-03-26 17:41:03,55565 (MainThread): Parsing macros/materializations/helpers.sql
2020-03-26 17:41:03,62681 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-03-26 17:41:03,64634 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-03-26 17:41:03,78659 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-03-26 17:41:03,93073 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-03-26 17:41:03,106973 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-03-26 17:41:03,109040 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-03-26 17:41:03,114479 (MainThread): Parsing macros/materializations/common/merge.sql
2020-03-26 17:41:03,120318 (MainThread): Parsing macros/materializations/table/table.sql
2020-03-26 17:41:03,125526 (MainThread): Parsing macros/materializations/view/view.sql
2020-03-26 17:41:03,140951 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-03-26 17:41:03,147449 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-03-26 17:41:03,151203 (MainThread): Parsing macros/etc/query.sql
2020-03-26 17:41:03,155437 (MainThread): Parsing macros/etc/is_incremental.sql
2020-03-26 17:41:03,159555 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-03-26 17:41:03,166886 (MainThread): Parsing macros/etc/datetime.sql
2020-03-26 17:41:03,179286 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-03-26 17:41:03,182935 (MainThread): Parsing macros/adapters/common.sql
2020-03-26 17:41:03,212133 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-03-26 17:41:03,213600 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-03-26 17:41:03,214694 (MainThread): Parsing macros/schema_tests/unique.sql
2020-03-26 17:41:03,215890 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-03-26 17:41:03,218145 (MainThread): Parsing macros/catalog.sql
2020-03-26 17:41:03,219969 (MainThread): Parsing macros/relations.sql
2020-03-26 17:41:03,221253 (MainThread): Parsing macros/adapters.sql
2020-03-26 17:41:03,229610 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-03-26 17:41:03,247526 (MainThread): Partial parsing not enabled
2020-03-26 17:41:03,248235 (MainThread): Parsing macros/daily_performance_result_tag.sql
2020-03-26 17:41:03,263133 (MainThread): Acquiring new postgres connection "model.civis_platform.my_first_dbt_model".
2020-03-26 17:41:03,263275 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:41:03,279742 (MainThread): Acquiring new postgres connection "model.civis_platform.my_second_dbt_model".
2020-03-26 17:41:03,279868 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:41:03,286215 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_monthly_performance".
2020-03-26 17:41:03,286338 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:41:03,294281 (MainThread): Acquiring new postgres connection "model.civis_platform.fact_daily_performance".
2020-03-26 17:41:03,294415 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:41:03,333496 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-26 17:41:03,333627 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:41:03,345316 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-26 17:41:03,345444 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:41:03,355511 (MainThread): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-26 17:41:03,355645 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:41:03,363375 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-26 17:41:03,363503 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:41:03,375392 (MainThread): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-26 17:41:03,375541 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:41:03,383586 (MainThread): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-26 17:41:03,391075 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:41:03,486077 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 126 macros, 0 operations, 2 seed files, 0 sources
2020-03-26 17:41:03,492889 (MainThread): 
2020-03-26 17:41:03,493348 (MainThread): Acquiring new postgres connection "master".
2020-03-26 17:41:03,493458 (MainThread): Opening a new connection, currently in state init
2020-03-26 17:41:03,615458 (MainThread): Using postgres connection "master".
2020-03-26 17:41:03,618544 (MainThread): On master: BEGIN
2020-03-26 17:41:03,625100 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-03-26 17:41:03,625270 (MainThread): Using postgres connection "master".
2020-03-26 17:41:03,625362 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select
      'dbryan' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbryan' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-03-26 17:41:03,630082 (MainThread): SQL status: SELECT 7 in 0.00 seconds
2020-03-26 17:41:03,679767 (MainThread): Using postgres connection "master".
2020-03-26 17:41:03,679911 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-03-26 17:41:03,695567 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2020-03-26 17:41:03,699400 (MainThread): On master: ROLLBACK
2020-03-26 17:41:03,699874 (MainThread): 12:41:03 | Concurrency: 1 threads (target='dev')
2020-03-26 17:41:03,700017 (MainThread): 12:41:03 | 
2020-03-26 17:41:03,703622 (Thread-1): Began running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-26 17:41:03,703826 (Thread-1): 12:41:03 | 1 of 6 START test not_null_fact_daily_performance_spend.............. [RUN]
2020-03-26 17:41:03,704187 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-26 17:41:03,704285 (Thread-1): Opening a new connection, currently in state init
2020-03-26 17:41:03,704384 (Thread-1): Compiling test.civis_platform.not_null_fact_daily_performance_spend
2020-03-26 17:41:03,719453 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_fact_daily_performance_spend"
2020-03-26 17:41:03,720400 (Thread-1): finished collecting timing info
2020-03-26 17:41:03,721021 (Thread-1): Using postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-26 17:41:03,721176 (Thread-1): On test.civis_platform.not_null_fact_daily_performance_spend: BEGIN
2020-03-26 17:41:03,726979 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-03-26 17:41:03,727121 (Thread-1): Using postgres connection "test.civis_platform.not_null_fact_daily_performance_spend".
2020-03-26 17:41:03,727198 (Thread-1): On test.civis_platform.not_null_fact_daily_performance_spend: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.not_null_fact_daily_performance_spend"} */




select count(*)
from "dbryan"."public"."fact_daily_performance"
where spend is null

2020-03-26 17:41:03,734518 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2020-03-26 17:41:03,735102 (Thread-1): finished collecting timing info
2020-03-26 17:41:03,735486 (Thread-1): On test.civis_platform.not_null_fact_daily_performance_spend: ROLLBACK
2020-03-26 17:41:03,736001 (Thread-1): 12:41:03 | 1 of 6 PASS not_null_fact_daily_performance_spend.................... [PASS in 0.03s]
2020-03-26 17:41:03,736175 (Thread-1): Finished running node test.civis_platform.not_null_fact_daily_performance_spend
2020-03-26 17:41:03,736318 (Thread-1): Began running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-26 17:41:03,736539 (Thread-1): 12:41:03 | 2 of 6 START test not_null_my_first_dbt_model_id..................... [RUN]
2020-03-26 17:41:03,736852 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-26 17:41:03,736968 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.not_null_fact_daily_performance_spend).
2020-03-26 17:41:03,737082 (Thread-1): Compiling test.civis_platform.not_null_my_first_dbt_model_id
2020-03-26 17:41:03,748614 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_first_dbt_model_id"
2020-03-26 17:41:03,749573 (Thread-1): finished collecting timing info
2020-03-26 17:41:03,750174 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-26 17:41:03,750316 (Thread-1): On test.civis_platform.not_null_my_first_dbt_model_id: BEGIN
2020-03-26 17:41:03,750749 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-26 17:41:03,750920 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_first_dbt_model_id".
2020-03-26 17:41:03,751055 (Thread-1): On test.civis_platform.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.not_null_my_first_dbt_model_id"} */




select count(*)
from "dbryan"."public"."my_first_dbt_model"
where id is null

2020-03-26 17:41:03,751818 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-26 17:41:03,752242 (Thread-1): finished collecting timing info
2020-03-26 17:41:03,752600 (Thread-1): On test.civis_platform.not_null_my_first_dbt_model_id: ROLLBACK
2020-03-26 17:41:03,753266 (Thread-1): 12:41:03 | 2 of 6 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 0.02s]
2020-03-26 17:41:03,753475 (Thread-1): Finished running node test.civis_platform.not_null_my_first_dbt_model_id
2020-03-26 17:41:03,753673 (Thread-1): Began running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-26 17:41:03,753885 (Thread-1): 12:41:03 | 3 of 6 START test not_null_my_second_dbt_model_id.................... [RUN]
2020-03-26 17:41:03,754183 (Thread-1): Acquiring new postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-26 17:41:03,754271 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.not_null_my_first_dbt_model_id).
2020-03-26 17:41:03,754356 (Thread-1): Compiling test.civis_platform.not_null_my_second_dbt_model_id
2020-03-26 17:41:03,765626 (Thread-1): Writing injected SQL for node "test.civis_platform.not_null_my_second_dbt_model_id"
2020-03-26 17:41:03,767848 (Thread-1): finished collecting timing info
2020-03-26 17:41:03,769656 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-26 17:41:03,770002 (Thread-1): On test.civis_platform.not_null_my_second_dbt_model_id: BEGIN
2020-03-26 17:41:03,770775 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-26 17:41:03,771217 (Thread-1): Using postgres connection "test.civis_platform.not_null_my_second_dbt_model_id".
2020-03-26 17:41:03,771566 (Thread-1): On test.civis_platform.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.not_null_my_second_dbt_model_id"} */




select count(*)
from "dbryan"."public"."my_second_dbt_model"
where id is null

2020-03-26 17:41:03,772941 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-26 17:41:03,773465 (Thread-1): finished collecting timing info
2020-03-26 17:41:03,774032 (Thread-1): On test.civis_platform.not_null_my_second_dbt_model_id: ROLLBACK
2020-03-26 17:41:03,774913 (Thread-1): 12:41:03 | 3 of 6 PASS not_null_my_second_dbt_model_id.......................... [PASS in 0.02s]
2020-03-26 17:41:03,775205 (Thread-1): Finished running node test.civis_platform.not_null_my_second_dbt_model_id
2020-03-26 17:41:03,775671 (Thread-1): Began running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-26 17:41:03,776083 (Thread-1): 12:41:03 | 4 of 6 START test relationships_fact_daily_performance_date__date__ref_dim_date_ [RUN]
2020-03-26 17:41:03,776543 (Thread-1): Acquiring new postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-26 17:41:03,776681 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.not_null_my_second_dbt_model_id).
2020-03-26 17:41:03,776900 (Thread-1): Compiling test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-26 17:41:03,790808 (Thread-1): Writing injected SQL for node "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"
2020-03-26 17:41:03,791436 (Thread-1): finished collecting timing info
2020-03-26 17:41:03,791803 (Thread-1): Using postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-26 17:41:03,791891 (Thread-1): On test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_: BEGIN
2020-03-26 17:41:03,792175 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-26 17:41:03,792294 (Thread-1): Using postgres connection "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_".
2020-03-26 17:41:03,792373 (Thread-1): On test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_"} */





select count(*)
from (
    select date as id from "dbryan"."public"."fact_daily_performance"
) as child
left join (
    select date as id from "dbryan"."public"."dim_date"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null

2020-03-26 17:41:03,793409 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-26 17:41:03,794070 (Thread-1): finished collecting timing info
2020-03-26 17:41:03,794766 (Thread-1): On test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_: ROLLBACK
2020-03-26 17:41:03,795704 (Thread-1): 12:41:03 | 4 of 6 PASS relationships_fact_daily_performance_date__date__ref_dim_date_ [PASS in 0.02s]
2020-03-26 17:41:03,796072 (Thread-1): Finished running node test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_
2020-03-26 17:41:03,796524 (Thread-1): Began running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-26 17:41:03,796884 (Thread-1): 12:41:03 | 5 of 6 START test unique_my_first_dbt_model_id....................... [RUN]
2020-03-26 17:41:03,797954 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-26 17:41:03,798293 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.relationships_fact_daily_performance_date__date__ref_dim_date_).
2020-03-26 17:41:03,798692 (Thread-1): Compiling test.civis_platform.unique_my_first_dbt_model_id
2020-03-26 17:41:03,812902 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_first_dbt_model_id"
2020-03-26 17:41:03,813901 (Thread-1): finished collecting timing info
2020-03-26 17:41:03,814638 (Thread-1): Using postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-26 17:41:03,814820 (Thread-1): On test.civis_platform.unique_my_first_dbt_model_id: BEGIN
2020-03-26 17:41:03,815310 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-26 17:41:03,815516 (Thread-1): Using postgres connection "test.civis_platform.unique_my_first_dbt_model_id".
2020-03-26 17:41:03,815710 (Thread-1): On test.civis_platform.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.unique_my_first_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "dbryan"."public"."my_first_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors

2020-03-26 17:41:03,816881 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-26 17:41:03,817542 (Thread-1): finished collecting timing info
2020-03-26 17:41:03,818147 (Thread-1): On test.civis_platform.unique_my_first_dbt_model_id: ROLLBACK
2020-03-26 17:41:03,818801 (Thread-1): 12:41:03 | 5 of 6 PASS unique_my_first_dbt_model_id............................. [PASS in 0.02s]
2020-03-26 17:41:03,819287 (Thread-1): Finished running node test.civis_platform.unique_my_first_dbt_model_id
2020-03-26 17:41:03,819643 (Thread-1): Began running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-26 17:41:03,820162 (Thread-1): 12:41:03 | 6 of 6 START test unique_my_second_dbt_model_id...................... [RUN]
2020-03-26 17:41:03,821207 (Thread-1): Acquiring new postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-26 17:41:03,821503 (Thread-1): Re-using an available connection from the pool (formerly test.civis_platform.unique_my_first_dbt_model_id).
2020-03-26 17:41:03,821775 (Thread-1): Compiling test.civis_platform.unique_my_second_dbt_model_id
2020-03-26 17:41:03,834736 (Thread-1): Writing injected SQL for node "test.civis_platform.unique_my_second_dbt_model_id"
2020-03-26 17:41:03,836221 (Thread-1): finished collecting timing info
2020-03-26 17:41:03,836717 (Thread-1): Using postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-26 17:41:03,836871 (Thread-1): On test.civis_platform.unique_my_second_dbt_model_id: BEGIN
2020-03-26 17:41:03,837430 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-03-26 17:41:03,837665 (Thread-1): Using postgres connection "test.civis_platform.unique_my_second_dbt_model_id".
2020-03-26 17:41:03,837823 (Thread-1): On test.civis_platform.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.15.2", "profile_name": "default", "target_name": "dev", "node_id": "test.civis_platform.unique_my_second_dbt_model_id"} */




select count(*)
from (

    select
        id

    from "dbryan"."public"."my_second_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors

2020-03-26 17:41:03,838384 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-03-26 17:41:03,838666 (Thread-1): finished collecting timing info
2020-03-26 17:41:03,839198 (Thread-1): On test.civis_platform.unique_my_second_dbt_model_id: ROLLBACK
2020-03-26 17:41:03,839672 (Thread-1): 12:41:03 | 6 of 6 PASS unique_my_second_dbt_model_id............................ [PASS in 0.02s]
2020-03-26 17:41:03,839851 (Thread-1): Finished running node test.civis_platform.unique_my_second_dbt_model_id
2020-03-26 17:41:03,918373 (MainThread): 12:41:03 | 
2020-03-26 17:41:03,918826 (MainThread): 12:41:03 | Finished running 6 tests in 0.42s.
2020-03-26 17:41:03,919445 (MainThread): Connection 'master' was left open.
2020-03-26 17:41:03,919755 (MainThread): On master: Close
2020-03-26 17:41:03,919982 (MainThread): Connection 'test.civis_platform.unique_my_second_dbt_model_id' was left open.
2020-03-26 17:41:03,920405 (MainThread): On test.civis_platform.unique_my_second_dbt_model_id: Close
2020-03-26 17:41:03,939164 (MainThread): 
2020-03-26 17:41:03,939505 (MainThread): Completed with 1 error and 0 warnings:
2020-03-26 17:41:03,939735 (MainThread): 
2020-03-26 17:41:03,939913 (MainThread): Failure in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2020-03-26 17:41:03,940065 (MainThread):   Got 1 result, expected 0.
2020-03-26 17:41:03,940184 (MainThread): 
2020-03-26 17:41:03,940303 (MainThread):   compiled SQL at target/compiled/civis_platform/schema_test/not_null_my_first_dbt_model_id.sql
2020-03-26 17:41:03,940430 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2020-03-26 17:41:03,940619 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b5630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d4f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d4ba8>]}
2020-03-26 17:41:04,151477 (MainThread): Flushing usage events
